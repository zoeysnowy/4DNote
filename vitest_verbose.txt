
[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90mC:/Users/Zoey/4DNote[39m

node.exe : [90mstderr[2m | src/services/eventTree/TreeEngine.test.ts[2m > [22m[
2mEventTree Engine - Core Functions[2m > [22m[2mbuildEventTree[2m > [22m[2m搴旇
妫€娴嬪惊鐜紩鐢?[22m[39m[TreeEngine] Cycle detected at node: a
所在位置 行:1 字符: 1
+ & "C:\Program Files\nodejs/node.exe" "C:\Program Files\nodejs/node_mo ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: ([90mstderr[2m...cted at node: a:Stri 
   ng) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
[TreeEngine] Cycle detected at node: b

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[StorageManager] Initializing storage services...

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts
[22m[39m[StorageManager] Initializing storage services...

 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mbuildEventTree[2m > [22m搴旇姝ｇ‘鏋勫缓绠€鍗曠殑鏍戠粨鏋?[32m 5[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mbuildEventTree[2m > [22m搴旇姝ｇ‘澶勭悊澶氬眰宓屽[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mbuildEventTree[2m > [22m搴旇妫€娴嬪惊鐜紩鐢?[32m 2[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mbuildEventTree[2m > [22m搴旇妫€娴嬪鍎胯妭鐐?[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mbuildEventTree[2m > [22m搴旇鎸?position 姝ｇ‘鎺掑簭鍏勫紵鑺傜偣[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mbuildEventTree[2m > [22mADR-001: 搴旇浠?parentEventId 浣滀负缁撴瀯鐪熺浉[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mbuildEventTree[2m > [22msibling order should fall back to createdAt/id when no position[32m 12[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mbuildEventTree[2m > [22m搴旇鍦ㄦ病鏈?position 鏃舵寜 createdAt 鎺掑簭[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mrecomputeSiblings[2m > [22m搴旇閲嶆柊璁＄畻鍏勫紵鑺傜偣鐨?position[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mrecomputeSiblings[2m > [22m搴旇澶勭悊椤跺眰鑺傜偣锛坧arentId = null锛?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mcomputeReparentEffect[2m > [22m搴旇璁＄畻閲嶆柊鐖跺寲鐨勫奖鍝嶈寖鍥?[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTree Engine - Core Functions[2m > [22mcomputeReparentEffect[2m > [22mADR-001: affectedSubtree 搴旇鍩轰簬 parentEventId 鏀堕泦[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTreeAPI - High-Level Interface[2m > [22mcalculateAllBulletLevels[2m > [22m搴旇鎵归噺璁＄畻鎵€鏈夎妭鐐圭殑 bulletLevel[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTreeAPI - High-Level Interface[2m > [22mgetRootEvents[2m > [22m搴旇杩斿洖鎵€鏈夐《灞備簨浠?[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTreeAPI - High-Level Interface[2m > [22mgetDirectChildren[2m > [22m搴旇杩斿洖鐩存帴瀛愯妭鐐?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTreeAPI - High-Level Interface[2m > [22mgetSubtree[2m > [22m搴旇杩斿洖瀹屾暣瀛愭爲锛堝寘鍚墍鏈夊悗浠ｏ級[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTreeAPI - High-Level Interface[2m > [22mtoDFSList[2m > [22m搴旇鐢熸垚 DFS 椤哄簭鐨勬墎骞冲垪琛?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTreeAPI - High-Level Interface[2m > [22mvalidateTree[2m > [22m搴旇妫€娴嬪苟鎶ュ憡鏍戠粨鏋勯敊璇?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/eventTree/TreeEngine.test.ts[2m > [22mEventTreeAPI - Performance[2m > [22m搴旇鍦?100ms 鍐呭鐞?1000 涓簨浠?[32m 86[2mms[22m[39m
[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[IndexedDBService] 棣冩敡 Opening database: 4DNoteDB version: [33m5[39m
[IndexedDBService] 棣冩敵 Open request created: FDBOpenDBRequest [IDBOpenDBRequest] {
  listeners: [],
  _result: [1mnull[22m,
  _error: [1mnull[22m,
  source: [1mnull[22m,
  transaction: [1mnull[22m,
  readyState: [32m'pending'[39m,
  onsuccess: [1mnull[22m,
  onerror: [1mnull[22m,
  onupgradeneeded: [1mnull[22m,
  onblocked: [1mnull[22m
}

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[IndexedDBService] 棣冩敡 Opening database: 4DNoteDB version: [33m5[39m
[IndexedDBService] 棣冩敵 Open request created: FDBOpenDBRequest [IDBOpenDBRequest] {
  listeners: [],
  _result: [1mnull[22m,
  _error: [1mnull[22m,
  source: [1mnull[22m,
  transaction: [1mnull[22m,
  readyState: [32m'pending'[39m,
  onsuccess: [1mnull[22m,
  onerror: [1mnull[22m,
  onupgradeneeded: [1mnull[22m,
  onblocked: [1mnull[22m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[IndexedDBService] 棣冩敡 onupgradeneeded triggered
[IndexedDBService] Upgrading database schema...
[IndexedDBService] Current object stores: []
[IndexedDBService] Created accounts store
[IndexedDBService] Created calendars store
[IndexedDBService] Created events store
[IndexedDBService] Created contacts store
[IndexedDBService] Created tags store
[IndexedDBService] Created attachments store
[IndexedDBService] Created syncQueue store
[IndexedDBService] Created metadata store
[IndexedDBService] Created event_history store
[IndexedDBService] Created event_tree store
[IndexedDBService] 閴?Schema upgrade complete

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[IndexedDBService] 棣冩敡 onupgradeneeded triggered
[IndexedDBService] Upgrading database schema...
[IndexedDBService] Current object stores: []
[IndexedDBService] Created accounts store
[IndexedDBService] Created calendars store
[IndexedDBService] Created events store
[IndexedDBService] Created contacts store
[IndexedDBService] Created tags store
[IndexedDBService] Created attachments store
[IndexedDBService] Created syncQueue store
[IndexedDBService] Created metadata store
[IndexedDBService] Created event_history store
[IndexedDBService] Created event_tree store
[IndexedDBService] 閴?Schema upgrade complete

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[IndexedDBService] 閴?Database opened successfully

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[IndexedDBService] 閴?Database opened successfully

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] 鉁?IndexedDB initialized
[StorageManager] 馃攳 Electron check: { hasWindow: [33mtrue[39m, hasElectronAPI: [33mfalse[39m, electronAPIKeys: [] }
[StorageManager] 鈩癸笍  SQLite skipped (not in Electron environment)
[StorageManager] 鉁?Initialization complete

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[StorageManager] 鉁?IndexedDB initialized
[StorageManager] 馃攳 Electron check: { hasWindow: [33mtrue[39m, hasElectronAPI: [33mfalse[39m, electronAPIKeys: [] }
[StorageManager] 鈩癸笍  SQLite skipped (not in Electron environment)
[StorageManager] 鉁?Initialization complete

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m0[39m contacts

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m0[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] Creating contact: contact_7e02b046-fe2d-47c8-a948-e438d35d58ee

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] Creating contact: contact_c429c3a3-bfaf-4477-8e30-b12ef9a63e99

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] Creating contact: contact_71b5b6df-e603-4c91-a54d-153aecfad41d

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m3[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[22m[39m[StorageManager] Creating contact: contact_79414c69-753c-432d-8fca-3b47c3228505

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[22m[39m[StorageManager] Creating contact: contact_f19a4c14-7f11-4439-a578-2fcb7ac22339

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[22m[39m[StorageManager] Creating contact: contact_046d1201-e2b2-46df-814e-cc43200c933c

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇璺宠繃涓嶅瓨鍦ㄧ殑 ID
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/sync-integration.test.ts[2m > [22m[2mSync integration (config smoke)[2m > [22m[2mhas a coherent sync config shape
[22m[39m=== 鍚屾鏈哄埗闆嗘垚娴嬭瘯 ===
1. 楠岃瘉 Plan 鍚屾閰嶇疆:
   妯″紡: bidirectional
   鐩爣鏃ュ巻: outlook-work
   绉佸瘑妯″紡: [33mfalse[39m
2. 楠岃瘉 Actual 鍚屾閰嶇疆:
   妯″紡: send-only
   鐩爣鏃ュ巻: google-personal
   绉佸瘑妯″紡: [33mtrue[39m
3. 绉佸瘑妯″紡鍙備笌鑰呭鐞?
   鍙備笌鑰呴偖绠? [ [32m'lisi@company.com'[39m, [32m'wangwu@partner.com'[39m ]
   >> 绉佸瘑妯″紡涓嬶紝鍙備笌鑰呭皢杞崲涓烘弿杩版枃鏈紝涓嶅彂閫侀個璇?4. 鍚屾鐘舵€侀獙璇?
   Plan 宸插悓姝ヤ簨浠? 鉁?   Actual 宸插悓姝ヤ簨浠? 鉁?=== 闆嗘垚娴嬭瘯瀹屾垚 ===

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇璺宠繃涓嶅瓨鍦ㄧ殑 ID
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m6[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇璺宠繃涓嶅瓨鍦ㄧ殑 ID
[22m[39m[StorageManager] Creating contact: contact_83967a75-b1ca-4acb-9152-5ff245195c74

 [32m鉁?[39m src/tests/sync-integration.test.ts[2m > [22mSync integration (config smoke)[2m > [22mhas a coherent sync config shape[32m 6[2mms[22m[39m
[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m搴旇璺宠繃涓嶅瓨鍦ㄧ殑 ID
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m7[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_426114a5-4bd4-4757-8aa4-66beeac588b3

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_75755792-0062-43ed-ade4-9da78016e827

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_3ecfb269-5757-48cd-bc90-d388cb2efa76

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_f55ca139-ce3e-4baa-bee9-cae87f2e22ba

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_d92408da-7313-4384-9399-be4be7b9caad

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_91b7f1a4-06cd-4b78-94e0-2eef5ba1465c

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_249140b6-4b60-4cac-9fa0-e3fb38fab0df

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_634deb66-49a0-49f5-8152-7d1036af516d

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_23f83c2c-1beb-4912-8032-bb6ad07caf36

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_63a76abd-4de0-4f17-a414-c65ad5b674b0

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_70010eeb-8819-4b2a-be1f-c6ff1f1cdcab

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_106a7761-8e81-4f39-8a32-8c2e2ce4dcbe

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_b6dc312a-385c-4b81-b27d-3d56868dd757

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_2734bbf8-127d-4fd5-8450-a1f0b60264d9

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_feef81b5-7d4e-4261-a275-3d88cdf0682a

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_5e658da3-22a0-44a0-a365-d1085b48b0cd

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_8517b405-e138-4689-8461-c1ef67c84d8f

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_896079f7-09a0-4c56-9fe0-be49a710b51f

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_ec55b5b0-63bb-41d4-a15b-b3a453265ef6

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_efb07f4a-edd8-41a3-9d57-87c006efed0a

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_6025992f-d997-47b9-ac75-5f8d710501a4

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_c0456f15-6eb6-4ff0-8be6-95cdbb9eccbc

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_1328e1f9-09a3-4545-ab0e-0502a5ec25ce

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_8c5d50ec-fd1d-43bb-93c2-fe42b6226c43

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_e37a8008-1be7-44f2-9884-01215adc2a0c

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_300a540b-50d3-40b7-bad5-d5863f5ba8ca

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCheckState[2m > [22m褰撴病鏈?checked/unchecked 鏃讹紝杩斿洖鏈畬鎴?[32m 3[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCheckState[2m > [22m褰撳彧鏈?checked 鏃讹紝杩斿洖瀹屾垚涓?lastChecked 姝ｇ‘[32m 1[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCheckState[2m > [22m褰撴渶鍚庝竴娆℃搷浣滄槸 unchecked 鏃讹紝杩斿洖鏈畬鎴?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCheckState[2m > [22m褰撴暟缁勬棤搴忔椂锛屼粛鑳芥纭彇鏈€鏂版搷浣?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveTaskAnchorTimestamp[2m > [22m榛樿锛氬凡瀹屾垚 task 浠?lastChecked 浣滀负钀戒綅閿氱偣锛堜紭鍏堜簬 createdAt锛?[32m 1[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveTaskAnchorTimestamp[2m > [22m榛樿锛氭湭瀹屾垚涓旇缃簡 endTime 鏃讹紝浼樺厛浣跨敤 endTime锛堣€屼笉鏄?createdAt锛?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveTaskAnchorTimestamp[2m > [22m褰?preferCompletionDayWhenChecked=false 鏃讹紝濮嬬粓浣跨敤 createdAt[32m 0[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveTaskAnchorTimestamp[2m > [22m褰撴病鏈変换浣曟椂闂存潵婧愪笖 fallbackToNow=false 鏃讹紝杩斿洖 undefined[32m 0[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCalendarDateRange[2m > [22m鏃犳椂闂?task锛堟湭瀹屾垚锛夛細浣跨敤 createdAt 鐨勬棩鏈熷苟 clamp 鍒?00:00[32m 1[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCalendarDateRange[2m > [22m鏃犳椂闂?task锛堝凡瀹屾垚锛夛細浣跨敤 lastChecked 鐨勬棩鏈熷苟 clamp 鍒?00:00[32m 0[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCalendarDateRange[2m > [22m鏃犳椂闂?task锛堢己澶?createdAt 绛夛級锛歠allbackToNow=true 鏃朵娇鐢ㄥ綋鍓嶆棩鏈燂紙00:00锛?[32m 3[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCalendarDateRange[2m > [22m浠?startTime 鐨?task锛氭寜 time-based 娓叉煋锛坋nd 鍥炲～涓?start锛?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/utils/TimeResolver.test.ts[2m > [22mTimeResolver[2m > [22mresolveCalendarDateRange[2m > [22m鏈夋槑纭椂闂存锛氫娇鐢?startTime/endTime锛坱ime-based锛?[32m 0[2mms[22m[39m
[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_5c4fc087-855b-4139-a3bf-ba00892bed65

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_6b4dfccc-6012-4fc7-983b-fba10123f6b6

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts
[22m[39m[StorageManager] Initializing storage services...

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_3e7add6c-d7e0-42e2-a8a4-75b5465bc97e

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_2b348a9a-4e17-4d32-b978-2b59f2f5ca39

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_0c889948-94ba-45b2-9afd-10f66032f945

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_58a4b3ae-94a8-4b57-8ff2-891de3ce6f43

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_d866f19d-ca2f-4212-a576-38bd56f2939b

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_dc210a56-08b8-4a8b-be21-d298af446835

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_d51a0821-57bf-4886-8547-c3f457496c85

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_6218be27-c731-4c8c-81e2-de7b4eafbefd

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_adbe9acc-1d23-44c5-ba8d-44c2736fcf02

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_699881d5-7659-469d-99fb-dfc25a5d49fd

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_007f8ce9-5b90-4fc3-8a4d-f7d8db3145d9

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_06d31e16-d0eb-4e79-a404-ab63844f3cfa

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_a3ff51ef-a3b5-4984-926e-fbe2fda24af6

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_b5cae06b-6c70-48af-bb50-a8942f3b1cbe

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_7cf4c54b-4b7e-488d-afe2-96e130d43046

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_6d2b84fa-c015-4a73-86bf-40fa7f07db6c

[90mstdout[2m | src/tests/contact-extraction.test.ts
[22m[39m[StorageManager] Initializing storage services...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts
[22m[39m[IndexedDBService] 棣冩敡 Opening database: 4DNoteDB version: [33m5[39m
[IndexedDBService] 棣冩敵 Open request created: FDBOpenDBRequest [IDBOpenDBRequest] {
  listeners: [],
  _result: [1mnull[22m,
  _error: [1mnull[22m,
  source: [1mnull[22m,
  transaction: [1mnull[22m,
  readyState: [32m'pending'[39m,
  onsuccess: [1mnull[22m,
  onerror: [1mnull[22m,
  onupgradeneeded: [1mnull[22m,
  onblocked: [1mnull[22m
}

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_7563262c-2592-4132-b6cb-d776f639976d

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts
[22m[39m[IndexedDBService] 棣冩敡 onupgradeneeded triggered
[IndexedDBService] Upgrading database schema...
[IndexedDBService] Current object stores: []
[IndexedDBService] Created accounts store
[IndexedDBService] Created calendars store
[IndexedDBService] Created events store
[IndexedDBService] Created contacts store
[IndexedDBService] Created tags store
[IndexedDBService] Created attachments store
[IndexedDBService] Created syncQueue store
[IndexedDBService] Created metadata store
[IndexedDBService] Created event_history store
[IndexedDBService] Created event_tree store
[IndexedDBService] 閴?Schema upgrade complete

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts
[22m[39m[IndexedDBService] 閴?Database opened successfully

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_01ed6e08-6016-45f9-ae47-06b43e2c8817

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts
[22m[39m[StorageManager] 鉁?IndexedDB initialized
[StorageManager] 馃攳 Electron check: { hasWindow: [33mtrue[39m, hasElectronAPI: [33mfalse[39m, electronAPIKeys: [] }
[StorageManager] 鈩癸笍  SQLite skipped (not in Electron environment)
[StorageManager] 鉁?Initialization complete

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_e60da7ea-9843-4d18-b99a-174e19a56b85

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m0[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_b8f17212-9b01-4769-94fc-ed06b8411d41

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_b8f212e0-caf4-42ea-8c44-5756964219d8

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_03ff1731-1195-4eb8-9304-b0068707629c

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_e0d5e3fd-dc49-440b-860e-d94e6ec581c1

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_ece1430c-c9f4-4d48-a7b1-5d128929a9ca

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_dfff6725-9540-43df-958c-8c84e74bb4e1

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_e14b858e-a243-4fd6-a0cb-c68345ba0bfe

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_2ded611e-25ac-4a75-9b02-48745178a36b

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_b0a80bfe-c86d-41d3-9508-d3593a2abca7

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_72d84abb-da0f-424c-94ed-cd13dcc78260

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_252191eb-cddd-4c43-8ed8-27f50194f41f

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_765e2574-889a-46d9-b63b-3f2ca8c3971e

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_06aabaa9-2bde-4a8d-9c42-ab4901f7fecd

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_ca748597-30b0-4872-b0ef-22a871bcf2c2

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contact-extraction.test.ts
[22m[39m[IndexedDBService] 棣冩敡 Opening database: 4DNoteDB version: [33m5[39m
[IndexedDBService] 棣冩敵 Open request created: FDBOpenDBRequest [IDBOpenDBRequest] {
  listeners: [],
  _result: [1mnull[22m,
  _error: [1mnull[22m,
  source: [1mnull[22m,
  transaction: [1mnull[22m,
  readyState: [32m'pending'[39m,
  onsuccess: [1mnull[22m,
  onerror: [1mnull[22m,
  onupgradeneeded: [1mnull[22m,
  onblocked: [1mnull[22m
}

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_54f994c1-6ddc-4f0e-a938-8c258eec1b28

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_4f59ae60-d4d1-45e2-a240-7ee16b2fc8b1

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_e5fc022f-c576-4879-b28d-4b61b9c294fb

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_ff2f257f-829c-4e47-865b-44e20652044d

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_0590e300-9011-4231-8caa-e21257f13dcd

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_39ebc782-c8cc-4e06-a909-3f9244852f65

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_d9747486-8483-464c-ac5c-49be292f2178

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contact-extraction.test.ts
[22m[39m[IndexedDBService] 棣冩敡 onupgradeneeded triggered
[IndexedDBService] Upgrading database schema...
[IndexedDBService] Current object stores: []
[IndexedDBService] Created accounts store
[IndexedDBService] Created calendars store
[IndexedDBService] Created events store
[IndexedDBService] Created contacts store
[IndexedDBService] Created tags store
[IndexedDBService] Created attachments store
[IndexedDBService] Created syncQueue store
[IndexedDBService] Created metadata store
[IndexedDBService] Created event_history store
[IndexedDBService] Created event_tree store
[IndexedDBService] 閴?Schema upgrade complete

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_a07ab5fc-78ce-4b25-81bc-efac457d1b7b

[90mstdout[2m | src/tests/contact-extraction.test.ts
[22m[39m[IndexedDBService] 閴?Database opened successfully

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contact-extraction.test.ts
[22m[39m[StorageManager] 鉁?IndexedDB initialized
[StorageManager] 馃攳 Electron check: { hasWindow: [33mtrue[39m, hasElectronAPI: [33mfalse[39m, electronAPIKeys: [] }
[StorageManager] 鈩癸笍  SQLite skipped (not in Electron environment)
[StorageManager] 鉁?Initialization complete

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_c2fb648e-1f71-4c14-bf39-4aed67b0d704

[90mstdout[2m | src/tests/contact-extraction.test.ts
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contact-extraction.test.ts
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m0[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_7ea1b4f7-e33c-4f20-acf7-d4a8622f498c

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_35984949-136f-44ca-92ca-b920dc5d9760

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_99b08e9f-8af1-42ae-a0c9-f83149594cc1

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_b8ccedf6-479a-494a-9a24-b86fda855a1f

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_5eea3ec9-b4f3-46e8-9b72-61c31a4b2dd0

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_4e608c96-10e9-493f-baae-34931d945197

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_921cb89e-646d-4e8f-b53f-8c0e2fbaa69d

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_e01de9ad-9350-4171-b734-6627ae8a84cd

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_2e3595b1-7ac0-4dca-8a8a-67d581213231

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_bb211fde-d7de-4037-b8a8-77773655588a

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_47996180-b834-4d51-8576-e4af09dd6180

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_5cb47453-c80a-4c64-9a97-c95c80ffc1fc

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts
[22m[39m[StorageManager] Initializing storage services...

[90mstdout[2m | src/services/__tests__/EventService.outlookImportMatrix.test.ts
[22m[39m[StorageManager] Initializing storage services...

[90mstdout[2m | src/services/__tests__/EventService.outlookPlainTextImport.test.ts
[22m[39m[StorageManager] Initializing storage services...

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_90cf15e7-8f8a-4d08-86b8-d5c663f0d70a

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_ac42e313-bb5a-4e9e-a958-60890c73fee3

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_17ce7ebe-f508-49a4-b958-18938c943602

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_62b88e19-b83f-422f-b045-9a7697616418

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_40673c38-86c7-4129-876c-ddccd5c5da6d

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_9857c3df-91d3-43d6-b5e8-e251178615dc

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_bdc9c2f0-1b17-4336-b604-13eeaaf0d212

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_6496f1a1-ae2e-4d73-8ef9-c3498165aeb0

[90mstdout[2m | src/services/__tests__/EventService.outlookImportMatrix.test.ts
[22m[39m[IndexedDBService] 棣冩敡 Opening database: 4DNoteDB version: [33m5[39m
[IndexedDBService] 棣冩敵 Open request created: FDBOpenDBRequest [IDBOpenDBRequest] {
  listeners: [],
  _result: [1mnull[22m,
  _error: [1mnull[22m,
  source: [1mnull[22m,
  transaction: [1mnull[22m,
  readyState: [32m'pending'[39m,
  onsuccess: [1mnull[22m,
  onerror: [1mnull[22m,
  onupgradeneeded: [1mnull[22m,
  onblocked: [1mnull[22m
}

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_fddfbfee-8651-4340-8792-776cd1ee8e3d

[90mstdout[2m | src/services/__tests__/EventService.outlookPlainTextImport.test.ts
[22m[39m[IndexedDBService] 棣冩敡 Opening database: 4DNoteDB version: [33m5[39m
[IndexedDBService] 棣冩敵 Open request created: FDBOpenDBRequest [IDBOpenDBRequest] {
  listeners: [],
  _result: [1mnull[22m,
  _error: [1mnull[22m,
  source: [1mnull[22m,
  transaction: [1mnull[22m,
  readyState: [32m'pending'[39m,
  onsuccess: [1mnull[22m,
  onerror: [1mnull[22m,
  onupgradeneeded: [1mnull[22m,
  onblocked: [1mnull[22m
}

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_c674600f-b5de-4fdb-9914-07fcdfc7e69b

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_b9c8c93c-fa10-411d-b028-ee66cbe538ca

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts
[22m[39m[IndexedDBService] 棣冩敡 Opening database: 4DNoteDB version: [33m5[39m
[IndexedDBService] 棣冩敵 Open request created: FDBOpenDBRequest [IDBOpenDBRequest] {
  listeners: [],
  _result: [1mnull[22m,
  _error: [1mnull[22m,
  source: [1mnull[22m,
  transaction: [1mnull[22m,
  readyState: [32m'pending'[39m,
  onsuccess: [1mnull[22m,
  onerror: [1mnull[22m,
  onupgradeneeded: [1mnull[22m,
  onblocked: [1mnull[22m
}

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_c1490ae9-39f1-4af0-99f6-993135ed2cee

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_61672182-3d58-4a62-82cc-6c14b62444d0

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_186f097d-3ec9-48b4-9e96-7b2fe64e67f7

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_ff4b4eb2-5c36-43d2-a9e2-8dd1a3835242

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_235c3c82-9ae0-4d81-989a-febbda692107

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_d83a2c51-b887-4598-935e-b7419673beb0

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] Creating contact: contact_52f5de09-efb8-4d62-abd9-216288fc2968

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m[2m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇
[22m[39m鎵归噺鑾峰彇: 0.06ms, 鍗曠嫭鑾峰彇: 0.33ms

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇鏍规嵁閭鍘婚噸
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇鏍规嵁閭鍘婚噸
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m107[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇鏍规嵁濮撳悕鍘婚噸锛堟棤閭鏃讹級
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇鏍规嵁濮撳悕鍘婚噸锛堟棤閭鏃讹級
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m107[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇鎸変紭鍏堢骇鎺掑簭锛氬钩鍙?> 鏈湴 > 鍘嗗彶
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇鎸変紭鍏堢骇鎺掑簭锛氬钩鍙?> 鏈湴 > 鍘嗗彶
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m107[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇鍚堝苟鐩稿悓浼樺厛绾х殑鑱旂郴浜烘暟鎹?[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇鍚堝苟鐩稿悓浼樺厛绾х殑鑱旂郴浜烘暟鎹?[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m107[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇璺宠繃鏃犳晥鑱旂郴浜猴紙鏃犻偖绠卞拰濮撳悕锛?[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m[2m搴旇璺宠繃鏃犳晥鑱旂郴浜猴紙鏃犻偖绠卞拰濮撳悕锛?[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m107[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇浠?notes 涓В鏋愯亴鍔?[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇浠?notes 涓В鏋愯亴鍔?[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m107[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇浠?notes 涓В鏋愯亴鍔?[22m[39m[StorageManager] Creating contact: contact_60fba9f0-6d6f-475a-adb3-11beee01caeb

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇浠?notes 涓В鏋愯亴鍔?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇浠?notes 涓В鏋愭爣绛?[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇浠?notes 涓В鏋愭爣绛?[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m108[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇浠?notes 涓В鏋愭爣绛?[22m[39m[StorageManager] Creating contact: contact_a1767251-bfc6-459e-8844-a6c7b88dfb89

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇浠?notes 涓В鏋愭爣绛?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇鍚屾椂瑙ｆ瀽鑱屽姟鍜屾爣绛?[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇鍚屾椂瑙ｆ瀽鑱屽姟鍜屾爣绛?[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m109[39m contacts

 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m搴旇鎵归噺鑾峰彇澶氫釜鑱旂郴浜?[32m 149[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m搴旇淇濇寔浼犲叆 ID 鐨勯『搴?[32m 3[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m搴旇璺宠繃涓嶅瓨鍦ㄧ殑 ID[32m 1[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵归噺鑾峰彇[2m > [22m鎵归噺鑾峰彇鎬ц兘搴旇浼樹簬澶氭鍗曠嫭鑾峰彇[32m 36[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m搴旇鏍规嵁閭鍘婚噸[32m 3[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m搴旇鏍规嵁濮撳悕鍘婚噸锛堟棤閭鏃讹級[32m 3[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m搴旇鎸変紭鍏堢骇鎺掑簭锛氬钩鍙?> 鏈湴 > 鍘嗗彶[32m 2[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m搴旇鍚堝苟鐩稿悓浼樺厛绾х殑鑱旂郴浜烘暟鎹?[32m 3[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 澶氭潵婧愬幓閲?[2m > [22m搴旇璺宠繃鏃犳晥鑱旂郴浜猴紙鏃犻偖绠卞拰濮撳悕锛?[32m 4[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m搴旇浠?notes 涓В鏋愯亴鍔?[32m 4[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m搴旇浠?notes 涓В鏋愭爣绛?[32m 4[2mms[22m[39m
[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇鍚屾椂瑙ｆ瀽鑱屽姟鍜屾爣绛?[22m[39m[StorageManager] Creating contact: contact_977f077d-a89f-4cd8-9fc5-83d50f74b926

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇鍚屾椂瑙ｆ瀽鑱屽姟鍜屾爣绛?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鏇存柊鏃跺簲璇ュ簭鍒楀寲鎵╁睍瀛楁鍒?notes
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鏇存柊鏃跺簲璇ュ簭鍒楀寲鎵╁睍瀛楁鍒?notes
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m110[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鏇存柊鏃跺簲璇ュ簭鍒楀寲鎵╁睍瀛楁鍒?notes
[22m[39m[StorageManager] Creating contact: contact_f4298a10-cff1-44b9-8992-3f3c79da218d

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鏇存柊鏃跺簲璇ュ簭鍒楀寲鎵╁睍瀛楁鍒?notes
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鏇存柊鏃跺簲璇ュ簭鍒楀寲鎵╁睍瀛楁鍒?notes
[22m[39m[StorageManager] Updating contact: contact_f4298a10-cff1-44b9-8992-3f3c79da218d

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鏇存柊鏃跺簲璇ュ簭鍒楀寲鎵╁睍瀛楁鍒?notes
[22m[39m[StorageManager] 鉁?Contact updated in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇淇濈暀 notes 涓殑鍏朵粬鍐呭
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇淇濈暀 notes 涓殑鍏朵粬鍐呭
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m111[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇淇濈暀 notes 涓殑鍏朵粬鍐呭
[22m[39m[StorageManager] Creating contact: contact_2a3c35ca-733e-4082-92b5-a5c5ea245d9a

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m搴旇淇濈暀 notes 涓殑鍏朵粬鍐呭
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2mgetAllContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2mgetAllContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m112[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2mgetAllContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] Creating contact: contact_d0a943f2-3c5f-46f2-ae83-ff67fae8637a

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2mgetAllContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鎼滅储鏂规硶搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鎼滅储鏂规硶搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m113[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鎼滅储鏂规硶搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] Creating contact: contact_8d5ae1dc-eee6-4039-9384-179bd47d92d9

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m[2m鎼滅储鏂规硶搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22m[2msearchPlatformContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22m[2msearchPlatformContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m114[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22m[2msearchPlatformContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] Creating contact: contact_f8730fa3-a667-41e1-9289-b324233c87c2

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22m[2msearchPlatformContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22m[2msearchLocalContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22m[2msearchLocalContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m115[39m contacts

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22m[2msearchLocalContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] Creating contact: contact_9ffa6359-7bbe-4819-9953-63bedfcb1807

[90mstdout[2m | src/tests/contactservice-phase1.5.test.ts[2m > [22m[2mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22m[2msearchLocalContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m搴旇鍚屾椂瑙ｆ瀽鑱屽姟鍜屾爣绛?[32m 3[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m鏇存柊鏃跺簲璇ュ簭鍒楀寲鎵╁睍瀛楁鍒?notes[32m 4[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m搴旇淇濈暀 notes 涓殑鍏朵粬鍐呭[32m 4[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22mgetAllContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁[32m 3[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎵╁睍瀛楁瑙ｆ瀽[2m > [22m鎼滅储鏂规硶搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁[32m 3[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22msearchPlatformContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁[32m 4[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-phase1.5.test.ts[2m > [22mContactService Phase 1.5 - 鎼滅储浼樺寲[2m > [22msearchLocalContacts 搴旇杩斿洖瑙ｆ瀽鍚庣殑鎵╁睍瀛楁[32m 4[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.outlookPlainTextImport.test.ts
[22m[39m[IndexedDBService] 棣冩敡 onupgradeneeded triggered
[IndexedDBService] Upgrading database schema...
[IndexedDBService] Current object stores: []
[IndexedDBService] Created accounts store
[IndexedDBService] Created calendars store
[IndexedDBService] Created events store
[IndexedDBService] Created contacts store
[IndexedDBService] Created tags store
[IndexedDBService] Created attachments store
[IndexedDBService] Created syncQueue store
[IndexedDBService] Created metadata store
[IndexedDBService] Created event_history store
[IndexedDBService] Created event_tree store
[IndexedDBService] 閴?Schema upgrade complete

[90mstdout[2m | src/services/__tests__/EventService.outlookImportMatrix.test.ts
[22m[39m[IndexedDBService] 棣冩敡 onupgradeneeded triggered
[IndexedDBService] Upgrading database schema...
[IndexedDBService] Current object stores: []
[IndexedDBService] Created accounts store
[IndexedDBService] Created calendars store
[IndexedDBService] Created events store
[IndexedDBService] Created contacts store
[IndexedDBService] Created tags store
[IndexedDBService] Created attachments store
[IndexedDBService] Created syncQueue store
[IndexedDBService] Created metadata store
[IndexedDBService] Created event_history store
[IndexedDBService] Created event_tree store
[IndexedDBService] 閴?Schema upgrade complete

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts
[22m[39m[IndexedDBService] 棣冩敡 onupgradeneeded triggered
[IndexedDBService] Upgrading database schema...
[IndexedDBService] Current object stores: []
[IndexedDBService] Created accounts store
[IndexedDBService] Created calendars store
[IndexedDBService] Created events store
[IndexedDBService] Created contacts store
[IndexedDBService] Created tags store
[IndexedDBService] Created attachments store
[IndexedDBService] Created syncQueue store
[IndexedDBService] Created metadata store
[IndexedDBService] Created event_history store
[IndexedDBService] Created event_tree store
[IndexedDBService] 閴?Schema upgrade complete

 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m娓叉煋娴嬭瘯[2m > [22mvisible=false 鏃朵笉搴旇娓叉煋[32m 15[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m娓叉煋娴嬭瘯[2m > [22mvisible=true 鏃跺簲璇ユ覆鏌?Modal[32m 31[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m娓叉煋娴嬭瘯[2m > [22mcreate 妯″紡搴旇鏄剧ず"鏂板缓鑱旂郴浜?鏍囬[32m 5[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m娓叉煋娴嬭瘯[2m > [22mview 妯″紡搴旇鏄剧ず"鑱旂郴浜轰俊鎭?鏍囬涓斾笉鍙紪杈?[32m 9[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m浜や簰娴嬭瘯[2m > [22m鐐瑰嚮鍏抽棴鎸夐挳搴旇璋冪敤 onClose[32m 7[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m浜や簰娴嬭瘯[2m > [22m鐐瑰嚮鑳屾櫙钂欏眰搴旇璋冪敤 onClose[32m 4[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m浜や簰娴嬭瘯[2m > [22m鎸?Escape 閿簲璇ュ叧闂?Modal[32m 5[2mms[22m[39m
[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts
[22m[39m[IndexedDBService] 閴?Database opened successfully

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts
[22m[39m[StorageManager] 鉁?IndexedDB initialized
[StorageManager] 馃攳 Electron check: { hasWindow: [33mtrue[39m, hasElectronAPI: [33mfalse[39m, electronAPIKeys: [] }
[StorageManager] 鈩癸笍  SQLite skipped (not in Electron environment)
[StorageManager] 鉁?Initialization complete

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/services/__tests__/EventService.outlookImportMatrix.test.ts
[22m[39m[IndexedDBService] 閴?Database opened successfully

[90mstdout[2m | src/services/__tests__/EventService.outlookImportMatrix.test.ts
[22m[39m[StorageManager] 鉁?IndexedDB initialized
[StorageManager] 馃攳 Electron check: { hasWindow: [33mtrue[39m, hasElectronAPI: [33mfalse[39m, electronAPIKeys: [] }
[StorageManager] 鈩癸笍  SQLite skipped (not in Electron environment)
[StorageManager] 鉁?Initialization complete

[90mstdout[2m | src/services/__tests__/EventService.outlookImportMatrix.test.ts
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m0[39m contacts

[90mstdout[2m | src/services/__tests__/EventService.outlookImportMatrix.test.ts
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m0[39m contacts

 [32m鉁?[39m src/__tests__/time/parsing.cn.week.test.ts[2m > [22mTimeParsingService - Chinese week windows[2m > [22mparses "涓嬪懆" as next week [Mon..Sun] window with label[32m 4[2mms[22m[39m
 [32m鉁?[39m src/__tests__/time/parsing.cn.week.test.ts[2m > [22mTimeParsingService - Chinese week windows[2m > [22mparses "鏈懆" as current week [Mon..Sun] window[32m 1[2mms[22m[39m
 [32m鉁?[39m src/__tests__/time/parsing.cn.week.test.ts[2m > [22mTimeParsingService - Chinese week windows[2m > [22mparses "涓婂懆" as previous week [Mon..Sun] window[32m 1[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.outlookPlainTextImport.test.ts
[22m[39m[IndexedDBService] 閴?Database opened successfully

[90mstdout[2m | src/services/__tests__/EventService.outlookPlainTextImport.test.ts
[22m[39m[StorageManager] 鉁?IndexedDB initialized
[StorageManager] 馃攳 Electron check: { hasWindow: [33mtrue[39m, hasElectronAPI: [33mfalse[39m, electronAPIKeys: [] }
[StorageManager] 鈩癸笍  SQLite skipped (not in Electron environment)
[StorageManager] 鉁?Initialization complete

[90mstdout[2m | src/services/__tests__/EventService.outlookPlainTextImport.test.ts
[22m[39m[StorageManager] Querying contacts: { limit: [33m10000[39m }

[90mstdout[2m | src/services/__tests__/EventService.outlookPlainTextImport.test.ts
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m0[39m contacts

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垱寤鸿仈绯讳汉鏃惰Е鍙?contact.created 浜嬩欢
[22m[39m[StorageManager] Creating contact: contact_fd6cc4a3-a9b3-4ce8-86e2-13e0f88e9d7c

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'b33c8a6b'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'b33c8a6b'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

 [32m鉁?[39m src/services/__tests__/EventService.eventTreeContext.test.ts[2m > [22mEventService.getEventTreeContext (stats-backed)[2m > [22mis available at runtime[32m 2[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.eventTreeContext.test.ts[2m > [22mEventService.getEventTreeContext (stats-backed)[2m > [22mreturns counts using stats indexes (root already known)[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.eventTreeContext.test.ts[2m > [22mEventService.getEventTreeContext (stats-backed)[2m > [22mcomputes and persists rootEventId when missing (path compression)[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.eventTreeContext.test.ts[2m > [22mEventService.updateSubtreeRootEventId (stats-index BFS)[2m > [22mupdates descendant stats rootEventId via BFS without full table scan[32m 1[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.eventTreeContext.test.ts[2m > [22mEventService.updateSubtreeRootEventId (stats-index BFS)[2m > [22mdoes not infinite-loop on cycles[32m 0[2mms[22m[39m
[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垱寤鸿仈绯讳汉鏃惰Е鍙?contact.created 浜嬩欢
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412303_ynej2p"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'b33c8a6b'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412303_ynej2p"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6546'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[StorageManager] Creating event: event_554618df-cc2f-420d-b152-5554b33c8a6b

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[StorageManager] 鉁?Event created: event_554618df-cc2f-420d-b152-5554b33c8a6b

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄦ洿鏂拌仈绯讳汉鏃惰Е鍙?contact.updated 浜嬩欢
[22m[39m[StorageManager] Creating contact: contact_cd464ca6-fffa-4f83-9aa3-bdd932ec1251

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m馃捑 [EventHub] 淇濆瓨浜嬩欢 { id: [32m'temp-test-event-1767727412303'[39m, title: [32m'浜у搧璇勫浼?[39m }
鉃?[EventHub] 鍒涘缓浜嬩欢 { id: [32m'temp-test-event-1767727412303'[39m, title: [32m'浜у搧璇勫浼?[39m }
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'f440f097'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'f440f097'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄦ洿鏂拌仈绯讳汉鏃惰Е鍙?contact.updated 浜嬩欢
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄦ洿鏂拌仈绯讳汉鏃惰Е鍙?contact.updated 浜嬩欢
[22m[39m[StorageManager] Updating contact: contact_cd464ca6-fffa-4f83-9aa3-bdd932ec1251

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412309_tfrfrg"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'f440f097'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412309_tfrfrg"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6603'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] Creating event: event_ec8eb366-fb71-49c1-94d5-6797f440f097

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄦ洿鏂拌仈绯讳汉鏃惰Е鍙?contact.updated 浜嬩欢
[22m[39m[StorageManager] 鉁?Contact updated in IndexedDB

 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m淇濆瓨鍔熻兘娴嬭瘯[2m > [22mcreate 妯″紡搴旇璋冪敤 ContactService.addContact[32m 88[2mms[22m[39m
[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] 鉁?Event created: event_ec8eb366-fb71-49c1-94d5-6797f440f097

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢
[22m[39m[StorageManager] Creating contact: contact_2437646a-9cec-4403-9ce2-32bfae8da5e1

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢
[22m[39m[StorageManager] Soft-deleting contact: contact_2437646a-9cec-4403-9ce2-32bfae8da5e1

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢
[22m[39m[StorageManager] Querying contacts: {
  filters: { contactIds: [ [32m'contact_2437646a-9cec-4403-9ce2-32bfae8da5e1'[39m ] },
  limit: [33m1[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢
[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m1[39m contacts

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢
[22m[39m[StorageManager] Updating contact: contact_2437646a-9cec-4403-9ce2-32bfae8da5e1

 [32m鉁?[39m src/services/__tests__/EventService.outlookPlainTextImport.test.ts[2m > [22mEventService - Outlook PlainText HTML import[2m > [22mhtmlToSlateJsonWithRecognition should keep all PlainText div lines[32m 18[2mms[22m[39m
[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢
[22m[39m[StorageManager] 鉁?Contact updated in IndexedDB

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢
[22m[39m[StorageManager] 鉁?Contact soft-deleted

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鏀寔绉婚櫎浜嬩欢鐩戝惉鍣?[22m[39m[StorageManager] Creating contact: contact_32631b74-3d36-4e42-8174-cec653ab81c8

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'28a0f23c'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'28a0f23c'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞
鍙屽悜閾炬帴
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 A" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:56:28
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:145:11
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:26
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:1243:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_80fe80fa-243a-49f2-b199-78a828a0f23c'[39m,
  title: { fullTitle: [32m'浜嬩欢 A'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:56:28\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:145:11\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:26\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///C:/Users/Zoey/4DNote/node_modules/@vitest/r
unner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1653:37'[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鏀寔绉婚櫎浜嬩欢鐩戝惉鍣?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鏀寔绉婚櫎浜嬩欢鐩戝惉鍣?[22m[39m[StorageManager] Creating contact: contact_88199fb4-7143-4f7a-bd45-53da180a44f0

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鏀寔绉婚櫎浜嬩欢鐩戝惉鍣?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鏀寔澶氫釜鐩戝惉鍣ㄨ闃呭悓涓€浜嬩欢
[22m[39m[StorageManager] Creating contact: contact_f4600304-6fb7-4ff4-bcc6-4d6f1253f586

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mContactService Event Mechanism (Phase 1)[2m > [22m[2m搴旇鏀寔澶氫釜鐩戝惉鍣ㄨ闃呭悓涓€浜嬩欢
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412318_s99b3x"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'28a0f23c'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412318_s99b3x"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6450'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[StorageManager] Creating event: event_80fe80fa-243a-49f2-b199-78a828a0f23c

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[StorageManager] Creating contact: contact_b086aa77-a838-4a14-a40d-113a7df890c0

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'b33c8a6b'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412303_ynej2p"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'54b33c8a6b'[39m,
  fullEventId: [32m'event_554618df-cc2f-420d-b152-5554b33c8a6b'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    simpleTitle: [32m'Test'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":"Test"}]}]'[39m,
    fullTitle: [32m'[{"type":"paragraph","children":[{"text":"Test"}]}]'[39m
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/__tests__/time/timehub.basic.test.ts:12:20'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[StorageManager] 鉁?Event created: event_80fe80fa-243a-49f2-b199-78a828a0f23c

[90mstdout[2m | src/services/__tests__/EventService.outlookImportMatrix.test.ts[2m > [22m[2mEventService - Outlook import matrix[2m > [22m[2msplits plain text with CRLF into multiple paragraphs
[22m[39m[EventService] 妫€娴嬪埌绾枃鏈紝鍏堟竻鐞嗙鍚嶅啀妫€鏌ユ椂闂存埑
[EventService] 馃Ч 娓呯悊绛惧悕: { [32m'鍘熷闀垮害'[39m: [33m7[39m, [32m'娓呯悊鍚庨暱搴?[39m: [33m7[39m, [32m'绉婚櫎瀛楃鏁?[39m: [33m0[39m }

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m1[39m, sqlite: [33m0[39m, cache: [33m1[39m }

 [32m鉁?[39m src/services/__tests__/EventService.outlookImportMatrix.test.ts[2m > [22mEventService - Outlook import matrix[2m > [22mkeeps all .PlainText div lines (multiple divs)[32m 15[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.outlookImportMatrix.test.ts[2m > [22mEventService - Outlook import matrix[2m > [22msplits encoded <br> into multiple paragraphs[32m 2[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.outlookImportMatrix.test.ts[2m > [22mEventService - Outlook import matrix[2m > [22mimports .MsoNormal paragraphs as multiple paragraphs[32m 5[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.outlookImportMatrix.test.ts[2m > [22mEventService - Outlook import matrix[2m > [22msplits plain text with CRLF into multiple paragraphs[32m 4[2mms[22m[39m
[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: {
  eventId: [32m'event_554618df-cc2f-420d-b152-5554b33c8a6b'[39m,
  title: [32m'Test'[39m
}
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'f440f097'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412309_tfrfrg"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'97f440f097'[39m,
  fullEventId: [32m'event_ec8eb366-fb71-49c1-94d5-6797f440f097'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    simpleTitle: [32m'浜у搧璇勫浼?[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":"浜у搧璇勫浼?}]}]'[39m,
    fullTitle: [32m'[{"type":"paragraph","children":[{"text":"浜у搧璇勫浼?}]}]'[39m
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at EventHubClass.createEvent (C:/Users/Zoey/4DNote/src/services/EventHub.ts:441:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'28a0f23c'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412318_s99b3x"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'a828a0f23c'[39m,
  fullEventId: [32m'event_80fe80fa-243a-49f2-b199-78a828a0f23c'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 A'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[TimeHub.normalize] 杈撳叆: 2025-10-21 09:30:00 string
[TimeHub.normalize] 杈撳嚭: 2025-10-21 09:30:00
[TimeHub.normalize] 杈撳叆: 2025-10-21 10:30:00 string
[TimeHub.normalize] 杈撳嚭: 2025-10-21 10:30:00
[TimeHub.setEventTime] 鈿?绔嬪嵆鏇存柊缂撳瓨 {
  eventId: [32m'event_554618df-cc2f-420d-b152-5554b33c8a6b'[39m,
  start: [32m'2025-10-21 09:30:00'[39m,
  end: [32m'2025-10-21 10:30:00'[39m
}

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] Creating contact: contact_54ccd8e1-1856-4230-a84c-6488b2df8124

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m1[39m, sqlite: [33m0[39m, cache: [33m1[39m }

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[TimeHub.setEventTime] 馃攳 鍑嗗鏇存柊瀛楁: {
  eventId: [32m'event_554618df-cc2f-420d-b152-5554b33c8a6b'[39m,
  [32m'timeSpec.start'[39m: [32m'2025-10-21 09:30:00'[39m,
  [32m'timeSpec.end'[39m: [32m'2025-10-21 10:30:00'[39m,
  [32m'updated.startTime'[39m: [32m'2025-10-21 09:30:00'[39m,
  [32m'updated.endTime'[39m: [32m'2025-10-21 10:30:00'[39m,
  [32m'endTime鏄惁涓簎ndefined'[39m: [33mfalse[39m,
  [32m'endTime绫诲瀷'[39m: [32m'string'[39m
}

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] Creating contact: contact_ed9b5bec-18d1-4dc3-a2b8-de33a3531f89

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] Creating contact: contact_c706fddb-03fd-45bd-be99-6848e9aa4e53

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_80fe80fa-243a-49f2-b199-78a828a0f23c'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m1[39m, sqlite: [33m0[39m, cache: [33m4[39m }

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'b33c8a6b'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'b33c8a6b'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞
鍙屽悜閾炬帴
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 B" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:57:28
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at processImmediate (node:internal/timers:473:9)[39m
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_a4bc6738-d1b0-4f18-bf0a-8bd2542d739f'[39m,
  title: { fullTitle: [32m'浜嬩欢 B'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:57:28\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:20'[39m
}

  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'b33c8a6b'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'542d739f'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'542d739f'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: {
  eventId: [32m'event_ec8eb366-fb71-49c1-94d5-6797f440f097'[39m,
  title: [32m'浜у搧璇勫浼?[39m
}
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contact-extraction.test.ts[2m > [22m[2mContact extraction (smoke)[2m > [22m[2mextracts organizer/attendees when saving an event
[22m[39m[EventService.createEvent] 鈴笍 璺宠繃鍚屾 (syncStatus=local-only): {
  eventId: [32m'event_ec8eb366-fb71-49c1-94d5-6797f440f097'[39m,
  title: [32m'浜у搧璇勫浼?[39m,
  calendarIds: [90mundefined[39m,
  tags: []
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412335_hfkxfw"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'542d739f'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412335_hfkxfw"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6605'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[StorageManager] Creating event: event_a4bc6738-d1b0-4f18-bf0a-8bd2542d739f

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[StorageManager] 鉁?Event created: event_a4bc6738-d1b0-4f18-bf0a-8bd2542d739f

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'542d739f'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412335_hfkxfw"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'd2542d739f'[39m,
  fullEventId: [32m'event_a4bc6738-d1b0-4f18-bf0a-8bd2542d739f'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 B'[39m,
[90mstderr[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventServic
e 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浼?, "浼氳" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:170:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[EventService] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?, "浼氳" is 
not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:170:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:170:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20

    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:57:22\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

 [32m鉁?[39m src/tests/contact-extraction.test.ts[2m > [22mContact extraction (smoke)[2m > [22mextracts organizer/attendees when saving an event[32m 35[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m2[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'79cfb6a1'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'79cfb6a1'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m2[39m, sqlite: [33m0[39m, cache: [33m2[39m }

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412341_feymqi"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'79cfb6a1'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412341_feymqi"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6599'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_a4bc6738-d1b0-4f18-bf0a-8bd2542d739f'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[StorageManager] Creating event: event_8970d30b-cb81-44e2-8010-2d0779cfb6a1

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'28a0f23c'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'28a0f23c'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'28a0f23c'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[StorageManager] 鉁?Event created: event_8970d30b-cb81-44e2-8010-2d0779cfb6a1

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'79cfb6a1'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
[90mstderr[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventServic
e 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[EventService] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?,
 "浼氳" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at processImmediate (node:internal/timers:473:9)[39m
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at processImmediate (node:internal/timers:473:9)[39m

  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412341_feymqi"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'0779cfb6a1'[39m,
  fullEventId: [32m'event_8970d30b-cb81-44e2-8010-2d0779cfb6a1'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浼氳'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:170:21\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m1[39m, sqlite: [33m0[39m, cache: [33m7[39m }

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_8970d30b-cb81-44e2-8010-2d0779cfb6a1'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[EventService.createEvent] 鉁?瑙﹀彂鍚屾: {
  eventId: [32m'event_8970d30b-cb81-44e2-8010-2d0779cfb6a1'[39m,
  title: [32m''[39m,
  syncStatus: [32m'pending'[39m,
  calendarIds: [90mundefined[39m,
  tags: []
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[StorageManager] Updating contact: contact_b086aa77-a838-4a14-a40d-113a7df890c0

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[StorageManager] 鉁?Contact updated in IndexedDB

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'79cfb6a1'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'79cfb6a1'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'79cfb6a1'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'79cfb6a1'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412341_feymqi"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'79cfb6a1'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'28a0f23c'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412318_s99b3x"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'28a0f23c'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'79cfb6a1'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'b33c8a6b'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412303_ynej2p"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'b33c8a6b'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'28a0f23c'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'b33c8a6b'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_8970d30b-cb81-44e2-8010-2d0779cfb6a1'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_80fe80fa-243a-49f2-b199-78a828a0f23c'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetEventTime updates event and notifies subscribers
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: {
  eventId: [32m'event_554618df-cc2f-420d-b152-5554b33c8a6b'[39m,
  title: [32m'Test'[39m
}
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'542d739f'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'542d739f'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'542d739f'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'542d739f'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412335_hfkxfw"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'542d739f'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'6ee9bb98'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'6ee9bb98'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'542d739f'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412376_g97i9s"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'6ee9bb98'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412376_g97i9s"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁
閾炬帴鑷繁
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 A" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:74:27
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:145:11
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:26
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:1243:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_c02bd2ef-90c7-42d7-bf1c-3bc7573cb5da'[39m,
  title: { fullTitle: [32m'浜嬩欢 A'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:74:27\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:145:11\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:26\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///C:/Users/Zoey/4DNote/node_modules/@vitest/r
unner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1653:37'[39m
}

[90mstderr[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventServic
e 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventSe
rvice] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳" is not
 valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:201:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[EventService] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?, "浼氳" is 
not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:201:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:201:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20

    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6448'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_a4bc6738-d1b0-4f18-bf0a-8bd2542d739f'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] Creating contact: contact_d350f945-387b-446d-a954-775704d59188

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[StorageManager] Creating event: event_ed4adad9-9eb3-4410-ad48-88956ee9bb98

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁閾炬帴鑷繁
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'573cb5da'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'573cb5da'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[StorageManager] 鉁?Event created: event_ed4adad9-9eb3-4410-ad48-88956ee9bb98

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'6ee9bb98'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412376_g97i9s"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'956ee9bb98'[39m,
  fullEventId: [32m'event_ed4adad9-9eb3-4410-ad48-88956ee9bb98'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    simpleTitle: [32m'Timer Event'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":"Timer Event"}]}]'[39m,
    fullTitle: [32m'[{"type":"paragraph","children":[{"text":"Timer Event"}]}]'[39m
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/__tests__/time/timehub.basic.test.ts:47:20'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁閾炬帴鑷繁
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412381_w815kt"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'573cb5da'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412381_w815kt"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6452'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m2[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'80a4a773'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'80a4a773'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁閾炬帴鑷繁
[22m[39m[StorageManager] Creating event: event_c02bd2ef-90c7-42d7-bf1c-3bc7573cb5da

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412382_8hq08n"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'80a4a773'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412382_8hq08n"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6440'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m2[39m, sqlite: [33m0[39m, cache: [33m2[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁閾炬帴鑷繁
[22m[39m[StorageManager] 鉁?Event created: event_c02bd2ef-90c7-42d7-bf1c-3bc7573cb5da

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] Creating event: event_921aa6d6-6fdf-4f4a-adf2-138780a4a773

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: {
  eventId: [32m'event_ed4adad9-9eb3-4410-ad48-88956ee9bb98'[39m,
  title: [32m'Timer Event'[39m
}
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁閾炬帴鑷繁
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'573cb5da'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412381_w815kt"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'c7573cb5da'[39m,
  fullEventId: [32m'event_c02bd2ef-90c7-42d7-bf1c-3bc7573cb5da'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 A'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:74:21\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] 鉁?Event created: event_921aa6d6-6fdf-4f4a-adf2-138780a4a773

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'6ee9bb98'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'6ee9bb98'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'6ee9bb98'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁閾炬帴鑷繁
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'80a4a773'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412382_8hq08n"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'8780a4a773'[39m,
  fullEventId: [32m'event_921aa6d6-6fdf-4f4a-adf2-138780a4a773'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浼氳'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:201:21'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'6ee9bb98'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412376_g97i9s"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'6ee9bb98'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁閾炬帴鑷繁
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m3[39m, sqlite: [33m0[39m, cache: [33m3[39m }

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'6ee9bb98'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘鑷繁閾炬帴鑷繁
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_c02bd2ef-90c7-42d7-bf1c-3bc7573cb5da'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m2[39m, sqlite: [33m0[39m, cache: [33m9[39m }

[90mstdout[2m | src/__tests__/time/timehub.basic.test.ts[2m > [22m[2mTimeHub basic set/get/subscribe[2m > [22m[2msetTimerWindow updates locally and marks isTimer
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: {
  eventId: [32m'event_ed4adad9-9eb3-4410-ad48-88956ee9bb98'[39m,
  title: [32m'Timer Event'[39m
}
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'975d920f'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'975d920f'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_921aa6d6-6fdf-4f4a-adf2-138780a4a773'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventService.createEvent] 鉁?瑙﹀彂鍚屾: {
  eventId: [32m'event_921aa6d6-6fdf-4f4a-adf2-138780a4a773'[39m,
  title: [32m''[39m,
  syncStatus: [32m'pending'[39m,
  calendarIds: [90mundefined[39m,
  tags: []
}

 [32m鉁?[39m src/__tests__/time/timehub.basic.test.ts[2m > [22mTimeHub basic set/get/subscribe[2m > [22msetEventTime updates event and notifies subscribers[32m 78[2mms[22m[39m
 [32m鉁?[39m src/__tests__/time/timehub.basic.test.ts[2m > [22mTimeHub basic set/get/subscribe[2m > [22msetTimerWindow updates locally and marks isTimer[32m 12[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412387_dnu13q"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'975d920f'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412387_dnu13q"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6498'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] Soft-deleting contact: contact_d350f945-387b-446d-a954-775704d59188

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m[StorageManager] Creating event: event_f5b3ee7a-70d6-4201-b48a-06de975d920f

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] Querying contacts: {
  filters: { contactIds: [ [32m'contact_d350f945-387b-446d-a954-775704d59188'[39m ] },
  limit: [33m1[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m[StorageManager] 鉁?Event created: event_f5b3ee7a-70d6-4201-b48a-06de975d920f

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] 鉁?Query complete (IndexedDB): [33m1[39m contacts

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'975d920f'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412387_dnu13q"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'de975d920f'[39m,
  fullEventId: [32m'event_f5b3ee7a-70d6-4201-b48a-06de975d920f'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 A'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] Updating contact: contact_d350f945-387b-446d-a954-775704d59188

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] 鉁?Contact updated in IndexedDB

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m4[39m, sqlite: [33m0[39m, cache: [33m4[39m }

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[StorageManager] 鉁?Contact soft-deleted

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_f5b3ee7a-70d6-4201-b48a-06de975d920f'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'80a4a773'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'80a4a773'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'80a4a773'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}
[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'80a4a773'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'80a4a773'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'80a4a773'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'6484fb83'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'6484fb83'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇闃绘閾炬帴
涓嶅瓨鍦ㄧ殑浜嬩欢
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 A" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:83:27
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:145:11
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:26
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:1243:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_f5b3ee7a-70d6-4201-b48a-06de975d920f'[39m,
  title: { fullTitle: [32m'浜嬩欢 A'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:83:27\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:145:11\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:26\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///C:/Users/Zoey/4DNote/node_modules/@vitest/r
unner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1653:37'[39m
}

[90mstderr[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventServic
e 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventSe
rvice] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?, "浼氳" is not vali
d JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[EventService] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?, "浼氳" is 
not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜
閾炬帴
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 A" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:92:28
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:145:11
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:26
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:1243:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_01061c26-43ee-445b-8e3f-45046484fb83'[39m,
  title: { fullTitle: [32m'浜嬩欢 A'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:92:28\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:145:11\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:26\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///C:/Users/Zoey/4DNote/node_modules/@vitest/r
unner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1653:37'[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'80a4a773'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412382_8hq08n"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'80a4a773'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'80a4a773'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412382_8hq08n"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'80a4a773'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}
馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'80a4a773'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}
馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'80a4a773'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412393_3k5lc4"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'6484fb83'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412393_3k5lc4"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6425'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_921aa6d6-6fdf-4f4a-adf2-138780a4a773'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] Creating event: event_01061c26-43ee-445b-8e3f-45046484fb83

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_921aa6d6-6fdf-4f4a-adf2-138780a4a773'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] 鉁?Event created: event_01061c26-43ee-445b-8e3f-45046484fb83

 [32m鉁?[39m src/tests/contactservice-events.test.ts[2m > [22mContactService Event Mechanism (Phase 1)[2m > [22m搴旇鍦ㄥ垱寤鸿仈绯讳汉鏃惰Е鍙?contact.created 浜嬩欢[32m 10[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-events.test.ts[2m > [22mContactService Event Mechanism (Phase 1)[2m > [22m搴旇鍦ㄦ洿鏂拌仈绯讳汉鏃惰Е鍙?contact.updated 浜嬩欢[32m 4[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-events.test.ts[2m > [22mContactService Event Mechanism (Phase 1)[2m > [22m搴旇鍦ㄥ垹闄よ仈绯讳汉鏃惰Е鍙?contact.deleted 浜嬩欢[32m 4[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-events.test.ts[2m > [22mContactService Event Mechanism (Phase 1)[2m > [22m搴旇鏀寔绉婚櫎浜嬩欢鐩戝惉鍣?[32m 2[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-events.test.ts[2m > [22mContactService Event Mechanism (Phase 1)[2m > [22m搴旇鏀寔澶氫釜鐩戝惉鍣ㄨ闃呭悓涓€浜嬩欢[32m 1[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-events.test.ts[2m > [22mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫弬浼氫汉[32m 60[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'6484fb83'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412393_3k5lc4"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'046484fb83'[39m,
  fullEventId: [32m'event_01061c26-43ee-445b-8e3f-45046484fb83'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 A'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[StorageManager] Creating contact: contact_b227de89-6bfc-4cad-9a94-84d2adc5102b

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[StorageManager] 鉁?Contact created in IndexedDB

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m5[39m, sqlite: [33m0[39m, cache: [33m5[39m }

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m2[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'20880289'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'20880289'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_01061c26-43ee-445b-8e3f-45046484fb83'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'960eef0d'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'960eef0d'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412411_y5pyv5"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'20880289'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412411_y5pyv5"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6524'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[StorageManager] Creating event: event_960284b1-3498-4848-af51-a42820880289

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412397_w7pwol"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'960eef0d'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412397_w7pwol"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6583'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[StorageManager] 鉁?Event created: event_960284b1-3498-4848-af51-a42820880289

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] Creating event: event_137c6987-8cfd-4ea5-82a9-c6ca960eef0d

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'20880289'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412411_y5pyv5"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'2820880289'[39m,
  fullEventId: [32m'event_960284b1-3498-4848-af51-a42820880289'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浼氳'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:232:21'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] 鉁?Event created: event_137c6987-8cfd-4ea5-82a9-c6ca960eef0d

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'960eef0d'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412397_w7pwol"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'ca960eef0d'[39m,
  fullEventId: [32m'event_137c6987-8cfd-4ea5-82a9-c6ca960eef0d'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 B'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m3[39m, sqlite: [33m0[39m, cache: [33m10[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_960284b1-3498-4848-af51-a42820880289'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m6[39m, sqlite: [33m0[39m, cache: [33m6[39m }

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[EventService.createEvent] 鉁?瑙﹀彂鍚屾: {
  eventId: [32m'event_960284b1-3498-4848-af51-a42820880289'[39m,
  title: [32m''[39m,
  syncStatus: [32m'pending'[39m,
  calendarIds: [90mundefined[39m,
  tags: []
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_137c6987-8cfd-4ea5-82a9-c6ca960eef0d'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[StorageManager] Updating contact: contact_b227de89-6bfc-4cad-9a94-84d2adc5102b

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'05f1fe69'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'05f1fe69'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[StorageManager] 鉁?Contact updated in IndexedDB

[90mstderr[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventServic
e 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浼?, "浼氳" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:232:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[EventService] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?, "浼氳" is 
not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:232:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at C:/Users/Zoey/4DNote/src/tests/contactservice-events.test.ts:232:40
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜
閾炬帴
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 B" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:93:28
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at processImmediate (node:internal/timers:473:9)[39m
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_137c6987-8cfd-4ea5-82a9-c6ca960eef0d'[39m,
  title: { fullTitle: [32m'浜嬩欢 B'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:93:28\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:20'[39m
}

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜
閾炬帴
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 C" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:94:28
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at processImmediate (node:internal/timers:473:9)[39m
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_f484e172-1640-4273-8b17-105705f1fe69'[39m,
  title: { fullTitle: [32m'浜嬩欢 C'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:94:28\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:20'[39m
}

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'20880289'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'20880289'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'20880289'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}
[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'20880289'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'20880289'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'20880289'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}
[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'20880289'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'20880289'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'20880289'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412400_cstls3"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'05f1fe69'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412400_cstls3"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6548'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] Creating event: event_f484e172-1640-4273-8b17-105705f1fe69

[90mstdout[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'20880289'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412411_y5pyv5"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'20880289'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'20880289'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
[90mstderr[2m | src/tests/contactservice-events.test.ts[2m > [22m[2mEventServic
e 璁㈤槄 ContactService 浜嬩欢[2m > [22m[2m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉
[22m[39m[EventService] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?,
 "浼氳" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[EventService] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?, "浼氳" is 
not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[EventService] syncTagsToFullTitle 澶辫触: SyntaxError: Unexpected token '浼?, "浼氳" is 
not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.syncTagsToFullTitle (C:/Users/Zoey/4DNote/src/services/EventServ
ice.ts:2549:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2525:31)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)
[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token '浼?, "浼氳
" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2527:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.updateEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:1
189:36)

  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412411_y5pyv5"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'20880289'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'20880289'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412411_y5pyv5"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'20880289'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}
馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'20880289'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}
馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'20880289'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}
馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'20880289'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] 鉁?Event created: event_f484e172-1640-4273-8b17-105705f1fe69

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'05f1fe69'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412400_cstls3"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'5705f1fe69'[39m,
  fullEventId: [32m'event_f484e172-1640-4273-8b17-105705f1fe69'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 C'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_960284b1-3498-4848-af51-a42820880289'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_960284b1-3498-4848-af51-a42820880289'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m7[39m, sqlite: [33m0[39m, cache: [33m7[39m }

[90mstdout[2m | src/tests/contactservice-events.test.ts
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_960284b1-3498-4848-af51-a42820880289'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_f484e172-1640-4273-8b17-105705f1fe69'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

 [32m鉁?[39m src/tests/contactservice-events.test.ts[2m > [22mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m鑱旂郴浜哄垹闄ゆ椂锛屽簲璇ヤ粠鐩稿叧浜嬩欢涓Щ闄?[32m 29[2mms[22m[39m
 [32m鉁?[39m src/tests/contactservice-events.test.ts[2m > [22mEventService 璁㈤槄 ContactService 浜嬩欢[2m > [22m鑱旂郴浜烘洿鏂版椂锛屽簲璇ュ悓姝ュ埌鐩稿叧浜嬩欢鐨勫彂璧蜂汉[32m 13[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'6484fb83'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'6484fb83'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'6484fb83'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'6484fb83'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412393_3k5lc4"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'6484fb83'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'6484fb83'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_01061c26-43ee-445b-8e3f-45046484fb83'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'960eef0d'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'960eef0d'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'960eef0d'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'960eef0d'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412397_w7pwol"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'960eef0d'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'960eef0d'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_137c6987-8cfd-4ea5-82a9-c6ca960eef0d'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'6484fb83'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'6484fb83'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'6484fb83'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'6484fb83'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412393_3k5lc4"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'6484fb83'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'6484fb83'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_01061c26-43ee-445b-8e3f-45046484fb83'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'05f1fe69'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'05f1fe69'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'05f1fe69'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'05f1fe69'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412400_cstls3"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'05f1fe69'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'05f1fe69'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2maddLink[2m > [22m[2m搴旇鏀寔澶氫釜閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_f484e172-1640-4273-8b17-105705f1fe69'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22maddLink[2m > [22m搴旇鎴愬姛娣诲姞鍙屽悜閾炬帴[32m 80[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22maddLink[2m > [22m搴旇闃绘鑷繁閾炬帴鑷繁[32m 7[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22maddLink[2m > [22m搴旇闃绘閾炬帴涓嶅瓨鍦ㄧ殑浜嬩欢[32m 6[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'6a2ca634'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'6a2ca634'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412421_tgb64i"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'6a2ca634'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412421_tgb64i"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6475'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[StorageManager] Creating event: event_80a1e8a0-41b1-4a30-b93a-0e846a2ca634

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[StorageManager] 鉁?Event created: event_80a1e8a0-41b1-4a30-b93a-0e846a2ca634

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'6a2ca634'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412421_tgb64i"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'846a2ca634'[39m,
  fullEventId: [32m'event_80a1e8a0-41b1-4a30-b93a-0e846a2ca634'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 A'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:109:22\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m8[39m, sqlite: [33m0[39m, cache: [33m8[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_80a1e8a0-41b1-4a30-b93a-0e846a2ca634'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'bd7e726f'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'bd7e726f'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412424_boe2ff"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'bd7e726f'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412424_boe2ff"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6514'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[StorageManager] Creating event: event_3eaf2d6c-64e3-4daa-9ad3-f665bd7e726f

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[StorageManager] 鉁?Event created: event_3eaf2d6c-64e3-4daa-9ad3-f665bd7e726f

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'bd7e726f'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412424_boe2ff"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'65bd7e726f'[39m,
  fullEventId: [32m'event_3eaf2d6c-64e3-4daa-9ad3-f665bd7e726f'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 B'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m9[39m, sqlite: [33m0[39m, cache: [33m9[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_3eaf2d6c-64e3-4daa-9ad3-f665bd7e726f'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'6a2ca634'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'6a2ca634'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'6a2ca634'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛
绉婚櫎閾炬帴
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 A" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:109:28
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:145:11
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:26
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:1243:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_80a1e8a0-41b1-4a30-b93a-0e846a2ca634'[39m,
  title: { fullTitle: [32m'浜嬩欢 A'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:109:28\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:145:11\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:26\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///C:/Users/Zoey/4DNote/node_modules/@vitest/r
unner/dist/index.js:1209:10)\n'[39m +
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'6a2ca634'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412421_tgb64i"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'6a2ca634'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'6a2ca634'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_80a1e8a0-41b1-4a30-b93a-0e846a2ca634'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'bd7e726f'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'bd7e726f'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1653:37'[39m
}
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'bd7e726f'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'bd7e726f'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412424_boe2ff"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'bd7e726f'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'bd7e726f'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_3eaf2d6c-64e3-4daa-9ad3-f665bd7e726f'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'6a2ca634'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'6a2ca634'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'6a2ca634'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'6a2ca634'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412421_tgb64i"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'6a2ca634'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'6a2ca634'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_80a1e8a0-41b1-4a30-b93a-0e846a2ca634'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstderr[2m | src/features/Contact/components/ContactModal/ContactModal.test.tsx
[2m > [22m[2mContactModal[2m > [22m[2mTippy 瀹氫綅娴嬭瘯[2m > [22m[2m鏈?triggerEle
ment 鏃跺簲璇ヤ娇鐢?Tippy 瀹氫綅
[22m[39mAccessing element.ref was removed in React 19. ref is now a regular prop. 
It will be removed from the JSX Element type in a future release.
Accessing element.ref was removed in React 19. ref is now a regular prop. It will be
 removed from the JSX Element type in a future release.

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛
绉婚櫎閾炬帴
[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpected token
 '浜?, "浜嬩欢 B" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:110:28
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at processImmediate (node:internal/timers:473:9)[39m
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_3eaf2d6c-64e3-4daa-9ad3-f665bd7e726f'[39m,
  title: { fullTitle: [32m'浜嬩欢 B'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:110:28\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:20'[39m
}


[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'bd7e726f'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'bd7e726f'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'bd7e726f'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'bd7e726f'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412424_boe2ff"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'bd7e726f'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'bd7e726f'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m淇濆瓨鍔熻兘娴嬭瘯[2m > [22medit 妯″紡搴旇璋冪敤 ContactService.updateContact[32m 78[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m鍒犻櫎鍔熻兘娴嬭瘯[2m > [22m搴旇鏄剧ず鍒犻櫎鎸夐挳锛坋dit 妯″紡锛?[32m 8[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m鍒犻櫎鍔熻兘娴嬭瘯[2m > [22mcreate 妯″紡涓嶅簲璇ユ樉绀哄垹闄ゆ寜閽?[32m 10[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22m鍒犻櫎鍔熻兘娴嬭瘯[2m > [22m鐐瑰嚮鍒犻櫎搴旇璋冪敤 ContactService.deleteContact[32m 6[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mremoveLink[2m > [22m[2m搴旇鎴愬姛绉婚櫎閾炬帴
[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_3eaf2d6c-64e3-4daa-9ad3-f665bd7e726f'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'4dd0544b'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'4dd0544b'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412437_pnrfdk"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'4dd0544b'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412437_pnrfdk"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6599'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] Creating event: event_6c420fe0-50c4-4003-bf81-388b4dd0544b

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] 鉁?Event created: event_6c420fe0-50c4-4003-bf81-388b4dd0544b

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'4dd0544b'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412437_pnrfdk"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'8b4dd0544b'[39m,
  fullEventId: [32m'event_6c420fe0-50c4-4003-bf81-388b4dd0544b'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 A'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:132:22\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] Collecting storage statistics...

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴
旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxErro
r: Unexpected token '浜?, "浜嬩欢 A" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:132:28
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:145:11
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:26
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:1243:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_6c420fe0-50c4-4003-bf81-388b4dd0544b'[39m,
  title: { fullTitle: [32m'浜嬩欢 A'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:132:28\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:145:11\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:26\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///C:/Users/Zoey/4DNote/node_modules/@vitest/r
unner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1653:37'[39m
}

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴
旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxErro
r: Unexpected token '浜?, "浜嬩欢 B" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:133:28
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at processImmediate (node:internal/timers:473:9)[39m
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_fba2a96b-e568-4544-bdc1-5dbde3fdf741'[39m,
  title: { fullTitle: [32m'浜嬩欢 B'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:133:28\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:20'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m10[39m, sqlite: [33m0[39m, cache: [33m10[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_6c420fe0-50c4-4003-bf81-388b4dd0544b'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'e3fdf741'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'e3fdf741'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412440_crkrdu"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'e3fdf741'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412440_crkrdu"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6599'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] Creating event: event_fba2a96b-e568-4544-bdc1-5dbde3fdf741

 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22mTippy 瀹氫綅娴嬭瘯[2m > [22m鏈?triggerElement 鏃跺簲璇ヤ娇鐢?Tippy 瀹氫綅[32m 178[2mms[22m[39m
 [32m鉁?[39m src/features/Contact/components/ContactModal/ContactModal.test.tsx[2m > [22mContactModal[2m > [22mTippy 瀹氫綅娴嬭瘯[2m > [22m鏃?triggerElement 鏃跺簲璇ュ眳涓樉绀?[32m 4[2mms[22m[39m
[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] 鉁?Event created: event_fba2a96b-e568-4544-bdc1-5dbde3fdf741

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'e3fdf741'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412440_crkrdu"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'bde3fdf741'[39m,
  fullEventId: [32m'event_fba2a96b-e568-4544-bdc1-5dbde3fdf741'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 B'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m11[39m, sqlite: [33m0[39m, cache: [33m11[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_fba2a96b-e568-4544-bdc1-5dbde3fdf741'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'9707ed36'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'9707ed36'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412443_kxmtf8"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'9707ed36'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412443_kxmtf8"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6561'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] Creating event: event_40a1e4a7-b0c8-4e66-9edd-46699707ed36

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] 鉁?Event created: event_40a1e4a7-b0c8-4e66-9edd-46699707ed36

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'9707ed36'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412443_kxmtf8"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'699707ed36'[39m,
  fullEventId: [32m'event_40a1e4a7-b0c8-4e66-9edd-46699707ed36'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 C'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m12[39m, sqlite: [33m0[39m, cache: [33m12[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_40a1e4a7-b0c8-4e66-9edd-46699707ed36'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'4dd0544b'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'4dd0544b'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'4dd0544b'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'4dd0544b'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412437_pnrfdk"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'4dd0544b'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'4dd0544b'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_6c420fe0-50c4-4003-bf81-388b4dd0544b'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'e3fdf741'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'e3fdf741'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴
旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxErro
r: Unexpected token '浜?, "浜嬩欢 C" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:134:28
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_40a1e4a7-b0c8-4e66-9edd-46699707ed36'[39m,
  title: { fullTitle: [32m'浜嬩欢 C'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:134:28\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:20'[39m
}

  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'e3fdf741'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'e3fdf741'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412440_crkrdu"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'e3fdf741'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'e3fdf741'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_fba2a96b-e568-4544-bdc1-5dbde3fdf741'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'9707ed36'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'9707ed36'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'9707ed36'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'9707ed36'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412443_kxmtf8"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'9707ed36'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'9707ed36'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_40a1e4a7-b0c8-4e66-9edd-46699707ed36'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'4dd0544b'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'4dd0544b'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'4dd0544b'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'4dd0544b'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412437_pnrfdk"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'4dd0544b'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'4dd0544b'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mgetLinkedEvents[2m > [22m[2m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_6c420fe0-50c4-4003-bf81-388b4dd0544b'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'22d388f7'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'22d388f7'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412460_kp55o0"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'22d388f7'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412460_kp55o0"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6434'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[StorageManager] Creating event: event_09c5f07e-65d4-4d51-b633-50a622d388f7

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[StorageManager] 鉁?Event created: event_09c5f07e-65d4-4d51-b633-50a622d388f7

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'22d388f7'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412460_kp55o0"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'a622d388f7'[39m,
  fullEventId: [32m'event_09c5f07e-65d4-4d51-b633-50a622d388f7'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 A'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:154:22\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m13[39m, sqlite: [33m0[39m, cache: [33m13[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_09c5f07e-65d4-4d51-b633-50a622d388f7'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m馃攳 [normalizeTitle] 鍦烘櫙1锛氬彧鏈?fullTitle锛岀敓鎴?colorTitle 鍜?simpleTitle
鉁?[normalizeTitle] 鐢熸垚缁撴灉: {
  fullTitle_length: [33m4[39m,
  colorTitle_length: [33m47[39m,
  simpleTitle: [32m''[39m,
  hasFormatMap: [33mfalse[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'afbfdb8e'[39m,
  descriptionPreview: [90mundefined[39m,
  createdAt: [90mundefined[39m,
  updatedAt: [90mundefined[39m,
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mtrue[39m
}
[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'afbfdb8e'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [90mundefined[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [90mundefined[39m,
  passedUpdatedAt: [90mundefined[39m,
  [32m'鍊欓€塩reatedAt'[39m: [],
  [32m'鍊欓€塽pdatedAt'[39m: [],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [90mundefined[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [90mundefined[39m,
  finalSource: [90mundefined[39m,
  preserveSignature: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventService] 馃敡 琛ュ叏浜嗙己澶辩殑 Block Timestamp 鍏冩暟鎹?[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412465_r4opuw"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
[createEvent] 馃攳 Saving storageEvent: {
  id: [32m'afbfdb8e'[39m,
  eventlogType: [32m'object'[39m,
  eventlogKeys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  eventlog: {
    slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412465_r4opuw"}]'[39m,
    html: [32m''[39m,
    plainText: [32m''[39m,
    attachments: [],
    versions: [],
    syncState: { status: [32m'pending'[39m, contentHash: [32m'81-6580'[39m },
    createdAt: [32m'2026-01-07 03:23:32'[39m,
    updatedAt: [32m'2026-01-07 03:23:32'[39m
  }
}

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴
嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpe
cted token '浜?, "浜嬩欢 A" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:154:28
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:145:11
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:26
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:1243:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_09c5f07e-65d4-4d51-b633-50a622d388f7'[39m,
  title: { fullTitle: [32m'浜嬩欢 A'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:154:28\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:145:11\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:26\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///C:/Users/Zoey/4DNote/node_modules/@vitest/r
unner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:1653:37'[39m
}

[90mstderr[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m
 > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴
嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventService] fullTitleToColorTitle 瑙ｆ瀽澶辫触: SyntaxError: Unexpe
cted token '浜?, "浜嬩欢 B" is not valid JSON
    at JSON.parse (<anonymous>)
    at EventService.fullTitleToColorTitle (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:2182:26)
    at EventService.normalizeTitle (C:/Users/Zoey/4DNote/src/services/EventService.t
s:2464:50)
    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/EventService.t
s:3097:34)
    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:6
37:36)
    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bid
irectionalLinks.test.ts:44:39)
    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.t
est.ts:155:28
[90m    at runNextTicks (node:internal/process/task_queues:65:5)[39m
[90m    at processImmediate (node:internal/timers:473:9)[39m
    at [90mfile:///C:/Users/Zoey/4DNote/[39mnode_modules/[4m@vitest/runner[24m/d
ist/index.js:915:20
[normalizeEvent] 馃毃 涓ラ噸閿欒锛氱己灏戝垱寤烘椂闂达紒杩欎笉搴旇鍙戠敓锛岃妫€鏌ヨ皟鐢ㄩ摼: {
  eventId: [32m'event_7d9338ff-c8c1-46ba-bf76-8741afbfdb8e'[39m,
  title: { fullTitle: [32m'浜嬩欢 B'[39m },
  source: [90mundefined[39m,
  fourDNoteSource: [90mundefined[39m,
  [32m'浣跨敤榛樿鍊?[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍫嗘爤'[39m: [32m'Error: \n'[39m +
    [32m'    at EventService.normalizeEvent (C:/Users/Zoey/4DNote/src/services/Even
tService.ts:3275:13)\n'[39m +
    [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventSe
rvice.ts:637:36)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventS
ervice.bidirectionalLinks.test.ts:44:39)\n'[39m +
    [32m'    at C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectio
nalLinks.test.ts:155:28\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at file:///C:/Users/Zoey/4DNote/node_modules/@vitest/runner/dist/index
.js:915:20'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[StorageManager] Creating event: event_7d9338ff-c8c1-46ba-bf76-8741afbfdb8e

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[StorageManager] 鉁?Event created: event_7d9338ff-c8c1-46ba-bf76-8741afbfdb8e

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[createEvent] 馃攳 Verified saved event: {
  id: [32m'afbfdb8e'[39m,
  eventlogType: [32m'object'[39m,
  keys: [
    [32m'slateJson'[39m,
    [32m'html'[39m,
    [32m'plainText'[39m,
    [32m'attachments'[39m,
    [32m'versions'[39m,
    [32m'syncState'[39m,
    [32m'createdAt'[39m,
    [32m'updatedAt'[39m
  ],
  hasHtml: [33mtrue[39m,
  htmlValue: [32m''[39m,
  hasPlainText: [33mtrue[39m,
  plainTextValue: [32m''[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412465_r4opuw"}]'[39m
}
[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[EventHistoryService] 馃攧 鍑嗗 logCreate: {
  eventId: [32m'41afbfdb8e'[39m,
  fullEventId: [32m'event_7d9338ff-c8c1-46ba-bf76-8741afbfdb8e'[39m,
  timestamp: [32m'2026-01-07 03:23:32'[39m,
  title: {
    fullTitle: [32m'浜嬩欢 B'[39m,
    colorTitle: [32m'[{"type":"paragraph","children":[{"text":""}]}]'[39m,
    simpleTitle: [32m''[39m,
    formatMap: []
  },
  source: [32m'user-edit'[39m,
  stack: [32m'    at EventService.createEvent (C:/Users/Zoey/4DNote/src/services/EventService.ts:737:48)\n'[39m +
    [32m'    at runNextTicks (node:internal/process/task_queues:65:5)\n'[39m +
    [32m'    at processImmediate (node:internal/timers:473:9)\n'[39m +
    [32m'    at createTestEvent (C:/Users/Zoey/4DNote/src/services/__tests__/EventService.bidirectionalLinks.test.ts:44:20)'[39m
}
[EventHistoryService] 鉁?logCreate 瀹屾垚

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[StorageManager] Collecting storage statistics...

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[StorageManager] 鉁?Statistics collected: { indexedDB: [33m14[39m, sqlite: [33m0[39m, cache: [33m14[39m }

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_7d9338ff-c8c1-46ba-bf76-8741afbfdb8e'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'22d388f7'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'22d388f7'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'22d388f7'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'22d388f7'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412460_kp55o0"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'22d388f7'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'22d388f7'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_09c5f07e-65d4-4d51-b633-50a622d388f7'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'afbfdb8e'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'afbfdb8e'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'afbfdb8e'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'afbfdb8e'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412465_r4opuw"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'afbfdb8e'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'afbfdb8e'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_7d9338ff-c8c1-46ba-bf76-8741afbfdb8e'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'22d388f7'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'22d388f7'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'22d388f7'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'22d388f7'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412460_kp55o0"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'22d388f7'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'22d388f7'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_09c5f07e-65d4-4d51-b633-50a622d388f7'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventService.updateEvent] eventlog 鍙樺寲妫€娴? {
  eventId: [32m'afbfdb8e'[39m,
  oldBlockCount: [33m0[39m,
  newBlockCount: [33m0[39m,
  changed: [33mfalse[39m,
  [32m'鍘熷洜'[39m: [32m'鏁伴噺鐩稿悓锛屼繚鐣欏師绛惧悕'[39m
}
[normalizeEvent] 馃摑 浠庣鍚嶆彁鍙栧厓淇℃伅: {
  eventId: [32m'afbfdb8e'[39m,
  descriptionPreview: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  createdAt: [32m'2026-01-07 03:23:32'[39m,
  updatedAt: [90mundefined[39m,
  source: [32m'local'[39m,
  fourDNoteSource: [33mtrue[39m,
  lastModifiedSource: [90mundefined[39m
}
[normalizeEvent] 馃晲 Block-Level Timestamp 鎻愬彇: { [32m'鑺傜偣鎬绘暟'[39m: [33m1[39m, [32m'Block-Level paragraph鏁伴噺'[39m: [33m0[39m, [32m'鏃堕棿鎴冲垪琛?[39m: [] }
[normalizeEvent] 鈩癸笍 鏈壘鍒?Block-Level paragraph 鑺傜偣锛屽皢浣跨敤绛惧悕鎴栦紶鍏ョ殑鏃堕棿
[normalizeEvent] 馃搳 鏃堕棿鎴抽€夋嫨绛栫暐: {
  [32m'鍊欓€?createdAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?createdAt (鏈€鏃?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€?updatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'鏈€缁?updatedAt (鏈€鏂?'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'浣跨敤榛樿鍊?[39m: [33mfalse[39m
}
[normalizeEvent] 馃敀 淇濈暀鍘熸湁绛惧悕锛坧reserveSignature=true锛?[normalizeEvent] 鏃堕棿鎴虫彁鍙栧畬鏁撮摼璺? {
  eventId: [32m'afbfdb8e'[39m,
  blockLevelCreatedAt: [90mundefined[39m,
  blockLevelUpdatedAt: [90mundefined[39m,
  signatureCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  signatureUpdatedAt: [90mundefined[39m,
  passedCreatedAt: [32m'2026-01-07 03:23:32'[39m,
  passedUpdatedAt: [32m'2026-01-07 03:23:32'[39m,
  [32m'鍊欓€塩reatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m, [32m'2026-01-07 03:23:32'[39m ],
  [32m'鍊欓€塽pdatedAt'[39m: [ [32m'2026-01-07 03:23:32'[39m ],
  [32m'馃弳 finalCreatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  [32m'馃弳 finalUpdatedAt'[39m: [32m'2026-01-07 03:23:32'[39m,
  extractedCreator: [32m'4DNote'[39m,
  extractedModifier: [90mundefined[39m,
  finalFourDNoteSource: [33mtrue[39m,
  finalSource: [32m'local'[39m,
  preserveSignature: [33mtrue[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventHistoryService] eventlog 姣旇緝: { oldBlockCount: [33m0[39m, newBlockCount: [33m0[39m, [32m'鏈夊彉鍖?[39m: [33mfalse[39m }
[extractChanges] 馃攳 description 妫€鏌?(UPDATE): {
  eventId: [32m'afbfdb8e'[39m,
  before_length: [33m39[39m,
  after_length: [33m39[39m,
  before_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  after_first_150: [32m'---\n鐢?馃敭 4DNote 鍒涘缓浜?2026-01-07 03:23:32'[39m,
  equal: [33mtrue[39m
}
[EventHistoryService] 馃毇 璺宠繃 description 瀛楁锛堝閮ㄥ悓姝ュ瓧娈碉紝涓嶈褰曞巻鍙诧級
[convertEventToStorageEvent] Input eventlog: {
  exists: [33mtrue[39m,
  type: [32m'object'[39m,
  slateJson: [32m'[{"type":"paragraph","children":[{"text":""}],"id":"block_1767727412465_r4opuw"}]'[39m,
  html: [32m''[39m,
  plainText: [32m''[39m
}
[convertEventToStorageEvent] Field check: { hasHtml: [33mtrue[39m, hasPlainText: [33mtrue[39m }
馃攳 [EventService] updateEvent 淇濆瓨鍓嶉獙璇? {
  eventId: [32m'afbfdb8e'[39m,
  [32m'鍘熷syncMode'[39m: [90mundefined[39m,
  [32m'鏇存柊syncMode'[39m: [90mundefined[39m,
  [32m'鏈€缁坰yncMode'[39m: [90mundefined[39m,
  [32m'storageEvent.syncMode'[39m: [90mundefined[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m馃攳 [StorageManager] updateEvent 鎺ユ敹鍒扮殑 updates: {
  eventId: [32m'afbfdb8e'[39m,
  [32m'updates.syncMode'[39m: [90mundefined[39m,
  [32m'updates.calendarIds'[39m: [90mundefined[39m,
  [32m'syncMode 绫诲瀷'[39m: [32m'undefined'[39m,
  [32m'calendarIds 绫诲瀷'[39m: [32m'undefined'[39m
}

[90mstdout[2m | src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22m[2mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22m[2mhasLink[2m > [22m[2m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[22m[39m[EventNodeService] 寮€濮嬪悓姝?Nodes: { eventId: [32m'event_7d9338ff-c8c1-46ba-bf76-8741afbfdb8e'[39m, title: [32m'鏃犳爣棰?[39m }
[EventNodeService] 娌℃湁鎵惧埌 paragraph 鑺傜偣

 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22maddLink[2m > [22m搴旇鏀寔澶氫釜閾炬帴[32m 23[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22mremoveLink[2m > [22m搴旇鎴愬姛绉婚櫎閾炬帴[32m 22[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22mgetLinkedEvents[2m > [22m搴旇姝ｇ‘鑾峰彇姝ｅ悜鍜屽弽鍚戦摼鎺?[32m 22[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22mhasLink[2m > [22m搴旇姝ｇ‘妫€娴嬮摼鎺ユ槸鍚﹀瓨鍦?[32m 18[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22mshouldShowInEventTree[2m > [22m搴旇鏄剧ず鐢ㄦ埛鍒涘缓鐨勪簨浠?[32m 0[2mms[22m[39m
 [32m鉁?[39m src/services/__tests__/EventService.bidirectionalLinks.test.ts[2m > [22mEventService - 鍙屽悜閾炬帴鍔熻兘[2m > [22mshouldShowInEventTree[2m > [22m搴旇闅愯棌绯荤粺浜嬩欢[32m 0[2mms[22m[39m

[2m Test Files [22m [1m[32m13 passed[39m[22m[90m (13)[39m
[2m      Tests [22m [1m[32m98 passed[39m[22m[90m (98)[39m
[2m   Start at [22m 03:23:28
[2m   Duration [22m 3.68s[2m (transform 2.56s, setup 3.66s, import 4.90s, tests 1.32s, environment 29.01s)[22m

