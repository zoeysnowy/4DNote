# Homepage ç»Ÿè®¡ Dashboard è®¾è®¡ PRD

> **ç‰ˆæœ¬**: v1.0  
> **åˆ›å»ºæ—¶é—´**: 2025-12-15  
> **æœ€åæ›´æ–°**: 2025-12-15  
> **çŠ¶æ€**: è®¾è®¡é˜¶æ®µ  
> **ä¾èµ–æ¨¡å—**: EventService, TagService, CalendarService, TimerCard, DailyStatsCard  
> **å…³è”æ–‡æ¡£**:
> - [TimeVisual_PRD.md](./TimeVisual_PRD.md)
> - [PLANMANAGER_MODULE_PRD.md](./PLANMANAGER_MODULE_PRD.md)

---

## ğŸ“‹ ç›®å½•

- [1. äº§å“æ¦‚è¿°](#1-äº§å“æ¦‚è¿°)
- [2. é¡µé¢å¸ƒå±€è®¾è®¡](#2-é¡µé¢å¸ƒå±€è®¾è®¡)
- [3. æ¨¡å—è¯¦ç»†è®¾è®¡](#3-æ¨¡å—è¯¦ç»†è®¾è®¡)
- [4. äº¤äº’è®¾è®¡](#4-äº¤äº’è®¾è®¡)
- [5. æŠ€æœ¯å®ç°](#5-æŠ€æœ¯å®ç°)
- [6. å®ç°è·¯çº¿å›¾](#6-å®ç°è·¯çº¿å›¾)

---

## 1. äº§å“æ¦‚è¿°

### 1.1 è®¾è®¡ç›®æ ‡

å°† Homepage æ‰“é€ ä¸ºç”¨æˆ·çš„**æ—¶é—´ç®¡ç†é©¾é©¶èˆ±**ï¼Œæä¾›ï¼š
- ğŸ¯ **å¿«é€Ÿè®¡æ—¶**ï¼šä¸€é”®å¼€å§‹ä¸“æ³¨å·¥ä½œ
- ğŸ“Š **å®æ—¶ç»Ÿè®¡**ï¼šå¯è§†åŒ–å±•ç¤ºæ—¶é—´ä½¿ç”¨æƒ…å†µ
- ğŸ“… **å³å°†åˆ°æ¥**ï¼šæé†’è¿‘æœŸé‡è¦äº‹ä»¶
- ğŸ” **å¤šç»´åˆ†æ**ï¼šæ”¯æŒæ ‡ç­¾ã€æ—¥å†ç­‰ç»´åº¦åˆ‡æ¢

### 1.2 è®¾è®¡åŸåˆ™

- **ä¿¡æ¯å±‚æ¬¡æ¸…æ™°**ï¼šä¸»æ¬¡åˆ†æ˜ï¼Œèšç„¦æ ¸å¿ƒåŠŸèƒ½
- **ä¸€å±å±•ç¤º**ï¼šå…³é”®ä¿¡æ¯æ— éœ€æ»šåŠ¨å³å¯æŸ¥çœ‹
- **å¿«é€Ÿæ“ä½œ**ï¼šå‡å°‘ç‚¹å‡»æ¬¡æ•°ï¼Œæå‡æ•ˆç‡
- **çµæ´»åˆ‡æ¢**ï¼šæ”¯æŒç»´åº¦å’Œæ—¶é—´èŒƒå›´çš„å¿«é€Ÿåˆ‡æ¢

---

## 2. é¡µé¢å¸ƒå±€è®¾è®¡

### 2.1 æ•´ä½“å¸ƒå±€ï¼ˆGrid ç³»ç»Ÿï¼‰

**æ ¸å¿ƒæ€è·¯**ï¼šå·¦åˆ—ä¸ºæ“ä½œåŒºï¼ˆTimer + Upcomingï¼‰ï¼Œå³åˆ—ä¸ºæ•°æ®åŒºï¼ˆStatsï¼‰ï¼ŒåŠŸèƒ½åˆ†åŒºæ¸…æ™°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         é¦–é¡µ - æ—¶é—´ç®¡ç†é©¾é©¶èˆ±                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â‘  å¿«é€Ÿè®¡æ—¶å¡ç‰‡       â”‚  â‘¢ ç»Ÿè®¡ Dashboard (StatsPanel)           â”‚
â”‚  (TimerCard)         â”‚                                          â”‚
â”‚  320px x 400px       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                      â”‚  â”‚ æ§åˆ¶æ : [æ ‡ç­¾â–¼] [æ—¥å†â–¼]            â”‚  â”‚
â”‚  [é€‰æ‹©æ ‡ç­¾]           â”‚  â”‚ [ä»Šå¤©] [æœ¬å‘¨] [æœ¬æœˆ] [è‡ªå®šä¹‰]       â”‚  â”‚
â”‚  [è¾“å…¥äº‹ä»¶æ ‡é¢˜]       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  [00:00:00]          â”‚                                          â”‚
â”‚  [å¼€å§‹è®¡æ—¶]           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                      â”‚  â”‚  ä¸»è§†å›¾åŒº                           â”‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”                          â”‚  â”‚
â”‚  â‘¡ å³å°†åˆ°æ¥äº‹ä»¶åˆ—è¡¨   â”‚  â”‚  â”‚é¥¼å›¾  â”‚  åˆ—è¡¨                    â”‚  â”‚
â”‚  (UpcomingEventsPanel)â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â— å·¥ä½œ 8.5h           â”‚  â”‚
â”‚  320px x auto        â”‚  â”‚            â— å­¦ä¹  4.2h           â”‚  â”‚
â”‚                      â”‚  â”‚            â— å¨±ä¹ 2.0h           â”‚  â”‚
â”‚  [ğŸ“… å³å°†åˆ°æ¥çš„äº‹ä»¶]  â”‚  â”‚                                    â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚
â”‚  â”‚ ğŸ“Œ ä¼šè®®å‡†å¤‡     â”‚  â”‚  â”‚  è¶‹åŠ¿å›¾/åƒç´ å›¾/å¯¹æ¯”å›¾              â”‚  â”‚
â”‚  â”‚ ğŸ“… 14:00       â”‚  â”‚  â”‚                                    â”‚  â”‚
â”‚  â”‚ ğŸ·ï¸ å·¥ä½œ         â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  Full Width x Full Height                â”‚
â”‚  â”‚ ğŸ“Œ é¡¹ç›®è¯„å®¡     â”‚  â”‚  (å æ»¡å³ä¾§æ‰€æœ‰ç©ºé—´)                      â”‚
â”‚  â”‚ ...            â”‚  â”‚                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 CSS Grid å¸ƒå±€ä»£ç 

```css
.homepage-container {
  display: grid;
  grid-template-columns: 320px 1fr;  /* å·¦åˆ—å›ºå®š320pxï¼Œå³åˆ—è‡ªé€‚åº” */
  grid-template-rows: auto 1fr;      /* ç¬¬1è¡Œautoï¼Œç¬¬2è¡Œè‡ªé€‚åº” */
  gap: 20px;
  padding: 20px;
  height: 100vh;
  box-sizing: border-box;
  overflow: hidden;
}

/* å·¦åˆ—ï¼šæ“ä½œåŒº */
.timer-card { 
  grid-area: 1 / 1 / 2 / 2;  /* ç¬¬1è¡Œç¬¬1åˆ— */
}

.upcoming-events { 
  grid-area: 2 / 1 / 3 / 2;  /* ç¬¬2è¡Œç¬¬1åˆ— */
  overflow-y: auto;
}

/* å³åˆ—ï¼šæ•°æ®åŒºï¼ˆè·¨2è¡Œï¼Œå æ»¡æ•´ä¸ªå³ä¾§ï¼‰ */
.stats-panel { 
  grid-area: 1 / 2 / 3 / 3;  /* è·¨ç¬¬1-2è¡Œï¼Œç¬¬2åˆ— */
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}

/* å“åº”å¼æ–­ç‚¹ */
@media (max-width: 1200px) {
  /* ä¸­ç­‰å±å¹•ï¼šæ”¹ä¸ºå•åˆ—ï¼Œçºµå‘æ’åˆ— */
  .homepage-container {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto 1fr;
  }
  
  .timer-card { 
    grid-area: 1 / 1 / 2 / 2;
    max-width: 600px;
    justify-self: center;
  }
  
  .upcoming-events { 
    grid-area: 2 / 1 / 3 / 2;
    max-width: 600px;
    justify-self: center;
    max-height: 400px;
  }
  
  .stats-panel { 
    grid-area: 3 / 1 / 4 / 2;
  }
}

@media (max-width: 768px) {
  /* å°å±å¹•ï¼šå‡å°è¾¹è·å’Œé—´è· */
  .homepage-container {
    padding: 12px;
    gap: 12px;
  }
}
```

---

## 3. æ¨¡å—è¯¦ç»†è®¾è®¡

### 3.1 å¿«é€Ÿè®¡æ—¶å¡ç‰‡ (TimerCard) âœ… å·²å®ç°

**ä½ç½®**ï¼šå·¦åˆ—ç¬¬1è¡Œï¼Œå›ºå®šå®½åº¦ 320px

**å½“å‰åŠŸèƒ½**ï¼š
- æ˜¾ç¤ºå½“å‰è®¡æ—¶çŠ¶æ€
- æ ‡ç­¾é€‰æ‹©ä¸æ ‡é¢˜è¾“å…¥
- å¼€å§‹/æš‚åœ/åœæ­¢/å–æ¶ˆæ“ä½œ
- å¼€å§‹æ—¶é—´ç¼–è¾‘

**ä¿æŒä¸å˜**ï¼šç°æœ‰åŠŸèƒ½å®Œæ•´ä¿ç•™ï¼Œå®½åº¦è°ƒæ•´ä¸º320pxä»¥åŒ¹é…UpcomingEventsPanel

---

### 3.2 å³å°†åˆ°æ¥äº‹ä»¶åˆ—è¡¨ (UpcomingEventsPanel) âœ… å·²å®ç°

**ä½ç½®**ï¼šå·¦åˆ—ç¬¬2è¡Œï¼Œå›ºå®šå®½åº¦ 320pxï¼ˆä¸TimerCardå¯¹é½ï¼‰

**è®¾è®¡æ€è·¯**ï¼šç›´æ¥å¤ç”¨ `UpcomingEventsPanel` ç»„ä»¶

#### 3.2.1 ç»„ä»¶å¤ç”¨æ–¹æ¡ˆ

**æ–¹æ¡ˆ**ï¼šç›´æ¥å¤ç”¨ `<UpcomingEventsPanel />` ç»„ä»¶ï¼Œæ— éœ€ä¿®æ”¹

```tsx
// HomePage.tsx
import { TimerCard } from '../components/TimerCard';
import { UpcomingEventsPanel } from '../components/UpcomingEventsPanel';
import { StatsPanel } from './StatsPanel';

function HomePage() {
  return (
    <div className="homepage-container">
      {/* å·¦åˆ—ï¼šæ“ä½œåŒº */}
      <div className="timer-card">
        <TimerCard />
      </div>
      
      <div className="upcoming-events">
        <UpcomingEventsPanel />
      </div>
      
      {/* å³åˆ—ï¼šæ•°æ®åŒºï¼ˆè·¨2è¡Œï¼‰ */}
      <div className="stats-panel">
        <StatsPanel />
      </div>
    </div>
  );
}
```

#### 3.2.2 å¸ƒå±€ä¼˜åŠ¿

- **åŠŸèƒ½åˆ†åŒº**ï¼šå·¦ä¾§æ“ä½œï¼ˆè®¡æ—¶+äº‹ä»¶ï¼‰ï¼Œå³ä¾§åˆ†æï¼ˆç»Ÿè®¡ï¼‰
- **ç©ºé—´åˆ©ç”¨**ï¼šStats Panelè·å¾—å®Œæ•´å³ä¾§å‚ç›´ç©ºé—´ï¼Œå¯å±•ç¤ºæ›´å¤šæ•°æ®
- **è§†è§‰å’Œè°**ï¼šTimerCardå’ŒUpcomingEventsPanelå®½åº¦æ¥è¿‘ï¼Œå‚ç›´å¯¹é½ç¾è§‚
- **æ•°æ®ä¼˜å…ˆ**ï¼šç»Ÿè®¡é¢æ¿å æ®æœ€å¤§é¢ç§¯ï¼Œçªå‡ºæ•°æ®å¯è§†åŒ–

#### 3.2.3 æ ·å¼è°ƒæ•´

```css
/* å°†TimerCardå’ŒUpcomingEventsPanelç»Ÿä¸€ä¸º320pxå®½ */
.homepage-container .timer-card {
  width: 320px;
}

.homepage-container .upcoming-events {
  width: 320px;
}

---

### 3.3 ç»Ÿè®¡ Dashboard (StatsPanel) ğŸ†• æ ¸å¿ƒæ¨¡å—

**ä½ç½®**ï¼šåº•éƒ¨ï¼Œå…¨å®½ x 500px

#### 3.å³åˆ—ï¼Œè·¨2è¡Œå æ»¡æ•´ä¸ªå³ä¾§ï¼ˆæœ€å¤§åŒ–æ•°æ®å±•ç¤ºç©ºé—´ï¼‰

```tsx
<div className="stats-control-bar">
  {/* å·¦ä¾§ï¼šç»´åº¦é€‰æ‹© */}
  <div className="dimension-selector">
    <span className="label">ç»Ÿè®¡ç»´åº¦:</span>
    <div className="btn-group">
      <button 
        className={`dimension-btn ${dimension === 'tags' ? 'active' : ''}`}
        onClick={() => setDimension('tags')}
      >
        ğŸ·ï¸ æ ‡ç­¾
      </button>
      <button 
        className={`dimension-btn ${dimension === 'calendars' ? 'active' : ''}`}
        onClick={() => setDimension('calendars')}
      >
        ğŸ“… æ—¥å†
      </button>
      <button 
        className={`dimension-btn ${dimension === 'projects' ? 'active' : ''}`}
        onClick={() => setDimension('projects')}
        disabled
      >
        ğŸ“ é¡¹ç›® <span className="badge">å³å°†æ¨å‡º</span>
      </button>
    </div>
  </div>
  
  {/* å³ä¾§ï¼šæ—¶é—´èŒƒå›´é€‰æ‹© */}
  <div className="timerange-selector">
    <span className="label">æ—¶é—´èŒƒå›´:</span>
    <div className="btn-group">
      <button 
        className={`timerange-btn ${timeRange === 'today' ? 'active' : ''}`}
        onClick={() => setTimeRange('today')}
      >
        ä»Šå¤©
      </button>
      <button 
        className={`timerange-btn ${timeRange === 'week' ? 'active' : ''}`}
        onClick={() => setTimeRange('week')}
      >
        æœ¬å‘¨
      </button>
      <button 
        className={`timerange-btn ${timeRange === 'month' ? 'active' : ''}`}
        onClick={() => setTimeRange('month')}
      >
        æœ¬æœˆ
      </button>
      <button 
        className={`timerange-btn ${timeRange === 'custom' ? 'active' : ''}`}
        onClick={() => setTimeRange('custom')}
      >
        è‡ªå®šä¹‰
      </button>
    </div>
    
    {/* è‡ªå®šä¹‰æ—¥æœŸé€‰æ‹©å™¨ï¼ˆä»…åœ¨é€‰æ‹©"è‡ªå®šä¹‰"æ—¶æ˜¾ç¤ºï¼‰ */}
    {timeRange === 'custom' && (
      <div className="date-picker-wrapper">
        <input type="date" value={startDate} onChange={e => setStartDate(e.target.value)} />
        <span>è‡³</span>
        <input type="date" value={endDate} onChange={e => setEndDate(e.target.value)} />
      </div>
    )}
  </div>
</div>
```

**æ ·å¼è§„èŒƒ**ï¼š
```css
.stats-control-bar {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: 20px 24px;
  background: white;
  border-radius: 20px 20px 0 0;
  border-bottom: 1px solid #e5e7eb;
}

.dimension-selector,
.timerange-selector {
  display: flex;
  align-items: center;
  gap: 12px;
}

.label {
  font-size: 14px;
  font-weight: 500;
  color: #6b7280;
}

.btn-group {
  display: flex;
  gap: 8px;
}

.dimension-btn,
.timerange-btn {
  padding: 8px 16px;
  border: 1px solid #e5e7eb;
  border-radius: 10px;
  background: white;
  color: #374151;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 6px;
}

.dimension-btn:hover,
.timerange-btn:hover {
  border-color: #667eea;
  color: #667eea;
  background: #f5f7ff;
}

.dimension-btn.active,
.timerange-btn.active {
  border-color: #667eea;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

.dimension-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.badge {
  font-size: 10px;
  padding: 2px 6px;
  background: rgba(255, 255, 255, 0.3);
  border-radius: 4px;
}

.date-picker-wrapper {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-left: 12px;
}

.date-picker-wrapper input[type="date"] {
  padding: 6px 12px;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  font-size: 13px;
}
```

---

#### 3.3.2 ä¸»è§†å›¾åŒºè®¾è®¡

**å¸ƒå±€æ–¹æ¡ˆ**ï¼šæ ¹æ®ç»´åº¦å’Œæ—¶é—´èŒƒå›´åŠ¨æ€åˆ‡æ¢è§†å›¾

##### æ–¹æ¡ˆ Aï¼šæ ‡ç­¾/æ—¥å†ç»Ÿè®¡è§†å›¾ (dimension = 'tags' | 'calendars')

```tsx
<div className="stats-main-view">
  {/* å·¦ä¾§ï¼šé¥¼å›¾ + æ€»è§ˆ */}
  <div className="chart-section">
    {/* æ€»è§ˆæ•°æ® */}
    <div className="stats-summary">
      <div className="summary-item">
        <div className="summary-value">{totalDuration}</div>
        <div className="summary-label">æ€»æ—¶é•¿</div>
      </div>
      <div className="summary-item">
        <div className="summary-value">{totalEvents}</div>
        <div className="summary-label">äº‹ä»¶æ•°</div>
      </div>
      <div className="summary-item">
        <div className="summary-value">{categoryCount}</div>
        <div className="summary-label">{dimension === 'tags' ? 'æ ‡ç­¾æ•°' : 'æ—¥å†æ•°'}</div>
      </div>
    </div>
    
    {/* é¥¼å›¾ */}
    <div className="pie-chart-container">
      <svg width="240" height="240" id="statsChart"></svg>
    </div>
  </div>
  
  {/* å³ä¾§ï¼šè¯¦ç»†åˆ—è¡¨ */}
  <div className="list-section">
    <div className="list-header">
      <span>æ’å</span>
      <span>{dimension === 'tags' ? 'æ ‡ç­¾' : 'æ—¥å†'}</span>
      <span>æ—¶é•¿</span>
      <span>äº‹ä»¶æ•°</span>
      <span>å æ¯”</span>
    </div>
    
    <div className="list-items">
      {statsData.map((item, index) => (
        <div key={item.id} className="list-item">
          <span className="rank">#{index + 1}</span>
          <div className="item-name">
            <span className="color-dot" style={{ background: item.color }}></span>
            {item.emoji && <span className="emoji">{item.emoji}</span>}
            <span>{item.name}</span>
          </div>
          <span className="duration">{formatDuration(item.duration)}</span>
          <span className="count">{item.count}</span>
          <div className="percentage-bar">
            <div 
              className="percentage-fill" 
              style={{ width: `${item.percentage}%` }}
            ></div>
            <span className="percentage-text">{item.percentage.toFixed(1)}%</span>
          </div>
        </div>
      ))}
    </div>
  </div>
</div>
```

**æ ·å¼**ï¼š
```css
.stats-main-view {
  display: grid;
  grid-template-columns: 400px 1fr;
  gap: 24px;
  padding: 24px;
  background: white;
  border-radius: 0 0 20px 20px;
  min-height: 400px;
}

.chart-section {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

.stats-summary {
  display: flex;
  gap: 16px;
  width: 100%;
}

.summary-item {
  flex: 1;
  text-align: center;
  padding: 16px;
  background: #f9fafb;
  border-radius: 12px;
}

.summary-value {
  font-size: 24px;
  font-weight: 700;
  color: #1f2937;
  margin-bottom: 4px;
}

.summary-label {
  font-size: 12px;
  color: #6b7280;
}

.pie-chart-container {
  position: relative;
  width: 240px;
  height: 240px;
}

.list-section {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.list-header {
  display: grid;
  grid-template-columns: 50px 1fr 100px 80px 150px;
  gap: 12px;
  padding: 12px 16px;
  background: #f9fafb;
  border-radius: 10px;
  font-size: 13px;
  font-weight: 600;
  color: #6b7280;
}

.list-items {
  display: flex;
  flex-direction: column;
  gap: 8px;
  max-height: 320px;
  overflow-y: auto;
  padding-right: 8px;
}

.list-item {
  display: grid;
  grid-template-columns: 50px 1fr 100px 80px 150px;
  gap: 12px;
  padding: 12px 16px;
  background: #fafbfc;
  border-radius: 10px;
  align-items: center;
  transition: all 0.2s;
}

.list-item:hover {
  background: #f3f4f6;
  transform: translateX(4px);
}

.rank {
  font-size: 14px;
  font-weight: 600;
  color: #9ca3af;
}

.item-name {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: #1f2937;
}

.color-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
}

.emoji {
  font-size: 16px;
}

.duration,
.count {
  font-size: 14px;
  font-weight: 600;
  color: #667eea;
}

.percentage-bar {
  position: relative;
  width: 100%;
  height: 24px;
  background: #e5e7eb;
  border-radius: 6px;
  overflow: hidden;
}

.percentage-fill {
  height: 100%;
  background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
  transition: width 0.6s ease;
}

.percentage-text {
  position: absolute;
  top: 50%;
  right: 8px;
  transform: translateY(-50%);
  font-size: 11px;
  font-weight: 600;
  color: #374151;
}
```

---

##### æ–¹æ¡ˆ Bï¼šè¶‹åŠ¿è§†å›¾ (timeRange = 'week' | 'month')

å½“æ—¶é—´èŒƒå›´é€‰æ‹©"æœ¬å‘¨"æˆ–"æœ¬æœˆ"æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°è¶‹åŠ¿è§†å›¾ï¼š

```tsx
<div className="stats-main-view trend-view">
  {/* é¡¶éƒ¨ï¼šè§†å›¾åˆ‡æ¢å™¨ */}
  <div className="view-switcher">
    <button 
      className={`view-btn ${viewType === 'line' ? 'active' : ''}`}
      onClick={() => setViewType('line')}
    >
      ğŸ“ˆ æŠ˜çº¿å›¾
    </button>
    <button 
      className={`view-btn ${viewType === 'bar' ? 'active' : ''}`}
      onClick={() => setViewType('bar')}
    >
      ğŸ“Š æŸ±çŠ¶å›¾
    </button>
    <button 
      className={`view-btn ${viewType === 'pixels' ? 'active' : ''}`}
      onClick={() => setViewType('pixels')}
    >
      ğŸ¨ åƒç´ å—
    </button>
  </div>
  
  {/* å›¾è¡¨åŒºåŸŸ */}
  <div className="trend-chart-container">
    {viewType === 'line' && <LineChart data={trendData} />}
    {viewType === 'bar' && <BarChart data={trendData} />}
    {viewType === 'pixels' && <PixelView data={trendData} />}
  </div>
  
  {/* åº•éƒ¨ï¼šç»Ÿè®¡æ‘˜è¦ */}
  <div className="trend-summary">
    <div className="summary-stat">
      <span className="stat-label">å¹³å‡æ¯å¤©:</span>
      <span className="stat-value">{avgDuration}</span>
    </div>
    <div className="summary-stat">
      <span className="stat-label">æœ€é«˜å³°:</span>
      <span className="stat-value">{peakDuration} ({peakDate})</span>
    </div>
    <div className="summary-stat">
      <span className="stat-label">æ€»è®¡:</span>
      <span className="stat-value">{totalDuration}</span>
    </div>
  </div>
</div>
```

---

##### æ–¹æ¡ˆ Cï¼šå¤šç»´åº¦åŒæ—¶å±•ç¤º (é«˜çº§æ¨¡å¼) ğŸ”® æœªæ¥åŠŸèƒ½

æ”¯æŒåŒæ—¶é€‰æ‹©å¤šä¸ªç»´åº¦ï¼ˆå¦‚"æ ‡ç­¾ + æ—¥å†"ï¼‰ï¼Œå¹¶æ’å±•ç¤ºï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ ‡ç­¾ç»Ÿè®¡       â”‚  æ—¥å†ç»Ÿè®¡       â”‚
â”‚  [é¥¼å›¾+åˆ—è¡¨]    â”‚  [é¥¼å›¾+åˆ—è¡¨]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. äº¤äº’è®¾è®¡

### 4.1 ç»´åº¦åˆ‡æ¢äº¤äº’

**è§¦å‘æ–¹å¼**ï¼šç‚¹å‡»"ç»´åº¦é€‰æ‹©"æŒ‰é’®

**äº¤äº’æµç¨‹**ï¼š
1. ç”¨æˆ·ç‚¹å‡»"ğŸ·ï¸ æ ‡ç­¾"æˆ–"ğŸ“… æ—¥å†"
2. æŒ‰é’®çŠ¶æ€åˆ‡æ¢ï¼ˆactive æ ·å¼ï¼‰
3. ä¸»è§†å›¾åŒºæ·¡å‡ºï¼ˆ300ms fade-outï¼‰
4. åŠ è½½æ–°æ•°æ®
5. ä¸»è§†å›¾åŒºæ·¡å…¥ï¼ˆ300ms fade-inï¼‰
6. æ›´æ–°é¥¼å›¾å’Œåˆ—è¡¨

**çŠ¶æ€ç®¡ç†**ï¼š
```tsx
const [dimension, setDimension] = useState<'tags' | 'calendars' | 'projects'>('tags');
const [isLoading, setIsLoading] = useState(false);

const handleDimensionChange = async (newDimension) => {
  setIsLoading(true);
  setDimension(newDimension);
  
  // åŠ è½½æ–°æ•°æ®
  const data = await loadStatsData(newDimension, timeRange);
  setStatsData(data);
  
  setIsLoading(false);
};
```

---

### 4.2 æ—¶é—´èŒƒå›´åˆ‡æ¢äº¤äº’

**è§¦å‘æ–¹å¼**ï¼šç‚¹å‡»æ—¶é—´èŒƒå›´æŒ‰é’®æˆ–é€‰æ‹©è‡ªå®šä¹‰æ—¥æœŸ

**äº¤äº’æµç¨‹**ï¼š
1. ç”¨æˆ·ç‚¹å‡»"ä»Šå¤©"/"æœ¬å‘¨"/"æœ¬æœˆ"/"è‡ªå®šä¹‰"
2. æŒ‰é’®çŠ¶æ€åˆ‡æ¢
3. å¦‚æœé€‰æ‹©"è‡ªå®šä¹‰"ï¼Œæ˜¾ç¤ºæ—¥æœŸé€‰æ‹©å™¨
4. é‡æ–°åŠ è½½æ•°æ®
5. æ›´æ–°å›¾è¡¨

**æ™ºèƒ½è§†å›¾åˆ‡æ¢**ï¼š
- **ä»Šå¤©**ï¼šé»˜è®¤æ˜¾ç¤ºé¥¼å›¾ + åˆ—è¡¨
- **æœ¬å‘¨/æœ¬æœˆ**ï¼šè‡ªåŠ¨åˆ‡æ¢åˆ°è¶‹åŠ¿è§†å›¾ï¼ˆæŠ˜çº¿å›¾ï¼‰
- **è‡ªå®šä¹‰**ï¼šæ ¹æ®æ—¥æœŸè·¨åº¦å†³å®šï¼ˆâ‰¤7å¤©æ˜¾ç¤ºé¥¼å›¾ï¼Œ>7å¤©æ˜¾ç¤ºè¶‹åŠ¿å›¾ï¼‰

---

### 4.3 æ‚¬åœäº¤äº’

#### é¥¼å›¾æ‚¬åœ
- é«˜äº®å½“å‰æ‰‡åŒºï¼ˆopacity: 1ï¼‰
- å…¶ä»–æ‰‡åŒºå˜æš—ï¼ˆopacity: 0.6ï¼‰
- æ˜¾ç¤º Tooltipï¼ˆåç§°ã€æ—¶é•¿ã€ç™¾åˆ†æ¯”ï¼‰

#### åˆ—è¡¨é¡¹æ‚¬åœ
- èƒŒæ™¯è‰²å˜åŒ–
- è½»å¾®å³ç§»ï¼ˆtranslateX: 4pxï¼‰
- æ˜¾ç¤ºå¿«é€Ÿæ“ä½œæŒ‰é’®ï¼ˆæŸ¥çœ‹è¯¦æƒ…ã€ç­›é€‰ç­‰ï¼‰

---

### 4.4 ç‚¹å‡»æ“ä½œ

#### åˆ—è¡¨é¡¹ç‚¹å‡»
- **åŠŸèƒ½**ï¼šæ‰“å¼€è¯¥æ ‡ç­¾/æ—¥å†çš„è¯¦ç»†ç»Ÿè®¡é¡µé¢
- **å®ç°**ï¼šè·³è½¬åˆ°ç‹¬ç«‹çš„è¯¦æƒ… Modal æˆ–ä¾§è¾¹é¢æ¿

#### é¥¼å›¾æ‰‡åŒºç‚¹å‡»
- **åŠŸèƒ½**ï¼šèšç„¦è¯¥åˆ†ç±»ï¼Œåªæ˜¾ç¤ºè¯¥åˆ†ç±»çš„äº‹ä»¶
- **å®ç°**ï¼š
  1. é«˜äº®é€‰ä¸­æ‰‡åŒº
  2. åˆ—è¡¨è¿‡æ»¤åªæ˜¾ç¤ºè¯¥åˆ†ç±»
  3. åº•éƒ¨æ˜¾ç¤º"æ¸…é™¤ç­›é€‰"æŒ‰é’®

---

## 5. æŠ€æœ¯å®ç°

### 5.1 ç»„ä»¶ç»“æ„

```
HomePage
â”œâ”€â”€ TimerCard (å·²å®ç°)
â”œâ”€â”€ UpcomingEventsPanel (ç®€åŒ–ç‰ˆ)
â”‚   â”œâ”€â”€ EventCard (ç´§å‡‘æ¨¡å¼)
â”‚   â””â”€â”€ ViewMoreButton
â””â”€â”€ StatsPanel (æ–°å¢)
    â”œâ”€â”€ StatsControlBar
    â”‚   â”œâ”€â”€ DimensionSelector
    â”‚   â””â”€â”€ TimeRangeSelector
    â””â”€â”€ StatsMainView
        â”œâ”€â”€ ChartSection
        â”‚   â”œâ”€â”€ StatsSummary
        â”‚   â””â”€â”€ PieChart / LineChart / PixelView
        â””â”€â”€ ListSection
            â”œâ”€â”€ ListHeader
            â””â”€â”€ ListItems
```

### 5.2 æ•°æ®æµ

```typescript
// 1. æ•°æ®åŠ è½½
const loadStatsData = async (dimension: string, timeRange: TimeRange) => {
  // è·å–äº‹ä»¶æ•°æ®
  const events = await EventService.getTimelineEvents({
    startDate: getStartDate(timeRange),
    endDate: getEndDate(timeRange),
  });
  
  // æ ¹æ®ç»´åº¦ç»Ÿè®¡
  if (dimension === 'tags') {
    return calculateTagStats(events);
  } else if (dimension === 'calendars') {
    return calculateCalendarStats(events);
  }
};

// 2. æ ‡ç­¾ç»Ÿè®¡ï¼ˆå¤ç”¨ test-stats-full.html çš„é€»è¾‘ï¼‰
const calculateTagStats = (events: Event[]): TagStats[] => {
  const tagStatsMap = new Map();
  
  events.forEach(event => {
    const duration = getEventDuration(event);
    
    if (event.tags && event.tags.length > 0) {
      event.tags.forEach(tagId => {
        if (!tagStatsMap.has(tagId)) {
          tagStatsMap.set(tagId, {
            duration: 0,
            count: 0,
            events: []
          });
        }
        const stats = tagStatsMap.get(tagId);
        stats.duration += duration;
        stats.count += 1;
        stats.events.push(event.id);
      });
    }
  });
  
  // è½¬æ¢ä¸ºæ•°ç»„å¹¶æ’åº
  return Array.from(tagStatsMap.entries())
    .map(([tagId, stats]) => {
      const tag = TagService.getTagById(tagId);
      return {
        id: tagId,
        name: tag?.name || tagId,
        emoji: tag?.emoji,
        color: tag?.color || '#999',
        duration: stats.duration,
        count: stats.count,
        percentage: 0 // åç»­è®¡ç®—
      };
    })
    .sort((a, b) => b.duration - a.duration);
};

// 3. æ—¥å†ç»Ÿè®¡ï¼ˆå¤ç”¨ test-stats-full.html çš„é€»è¾‘ï¼‰
const calculateCalendarStats = (events: Event[]): CalendarStats[] => {
  // ç±»ä¼¼æ ‡ç­¾ç»Ÿè®¡ï¼Œä½†åŸºäº calendarIds
  // ...
};

// 4. è¶‹åŠ¿æ•°æ®ï¼ˆæŒ‰å¤©åˆ†ç»„ï¼‰
const calculateTrendData = (events: Event[]): DailyStats[] => {
  const dailyMap = new Map();
  
  events.forEach(event => {
    const dateKey = event.startTime?.substring(0, 10); // YYYY-MM-DD
    if (!dateKey) return;
    
    if (!dailyMap.has(dateKey)) {
      dailyMap.set(dateKey, {
        date: dateKey,
        duration: 0,
        count: 0
      });
    }
    
    const dayStats = dailyMap.get(dateKey);
    dayStats.duration += getEventDuration(event);
    dayStats.count += 1;
  });
  
  return Array.from(dailyMap.values())
    .sort((a, b) => a.date.localeCompare(b.date));
};
```

### 5.3 çŠ¶æ€ç®¡ç†

```typescript
interface StatsState {
  dimension: 'tags' | 'calendars' | 'projects';
  timeRange: 'today' | 'week' | 'month' | 'custom';
  startDate?: string; // è‡ªå®šä¹‰å¼€å§‹æ—¥æœŸ
  endDate?: string;   // è‡ªå®šä¹‰ç»“æŸæ—¥æœŸ
  viewType: 'line' | 'bar' | 'pixels'; // è¶‹åŠ¿è§†å›¾ç±»å‹
  statsData: TagStats[] | CalendarStats[];
  trendData: DailyStats[];
  isLoading: boolean;
}

const [state, setState] = useState<StatsState>({
  dimension: 'tags',
  timeRange: 'today',
  viewType: 'line',
  statsData: [],
  trendData: [],
  isLoading: false,
});
```

### 5.4 å›¾è¡¨å¤ç”¨

**ç›´æ¥å¤ç”¨ test-stats-full.html çš„å®ç°**ï¼š
- `renderPieChart()` - é¥¼å›¾æ¸²æŸ“ï¼ˆå¸¦åœ†è§’é—´éš™ï¼‰
- `createRoundedArcPath()` - SVG è·¯å¾„ç”Ÿæˆ
- `renderLineChart()` - æŠ˜çº¿å›¾
- `renderPixelView()` - åƒç´ å—è§†å›¾

**è¿ç§»æ­¥éª¤**ï¼š
1. æå–å›¾è¡¨å‡½æ•°åˆ°ç‹¬ç«‹å·¥å…·æ–‡ä»¶ `src/utils/chartUtils.ts`
2. è½¬æ¢ä¸º React ç»„ä»¶
3. æ·»åŠ  TypeScript ç±»å‹å®šä¹‰

---

## 6. å®ç°è·¯çº¿å›¾

### Phase 1: åŸºç¡€å¸ƒå±€ä¸é™æ€æ•°æ® (Week 1)

**ä»»åŠ¡**ï¼š
- [ ] åˆ›å»º `HomePage.tsx` ç»„ä»¶ç»“æ„
- [ ] å®ç° Grid å¸ƒå±€ç³»ç»Ÿ
- [ ] å¤ç”¨å¹¶è°ƒæ•´ `UpcomingEventsPanel` ä¸ºç´§å‡‘æ¨¡å¼
- [ ] åˆ›å»º `StatsPanel` éª¨æ¶ç»„ä»¶
- [ ] ä½¿ç”¨é™æ€æ•°æ®æµ‹è¯•å¸ƒå±€

**éªŒæ”¶æ ‡å‡†**ï¼š
- ä¸‰ä¸ªæ¨¡å—æ­£ç¡®å¸ƒå±€
- å“åº”å¼æ–­ç‚¹ç”Ÿæ•ˆ
- TimerCard ä¸ UpcomingEvents æ­£å¸¸æ˜¾ç¤º

---

### Phase 2: æ§åˆ¶æ ä¸ç»´åº¦åˆ‡æ¢ (Week 2)

**ä»»åŠ¡**ï¼š
- [ ] å®ç° `StatsControlBar` ç»„ä»¶
- [ ] ç»´åº¦é€‰æ‹©å™¨ï¼ˆæ ‡ç­¾/æ—¥å†ï¼‰
- [ ] æ—¶é—´èŒƒå›´é€‰æ‹©å™¨ï¼ˆä»Šå¤©/æœ¬å‘¨/æœ¬æœˆ/è‡ªå®šä¹‰ï¼‰
- [ ] çŠ¶æ€ç®¡ç†ä¸æ•°æ®åŠ è½½é€»è¾‘
- [ ] åˆ‡æ¢åŠ¨ç”»æ•ˆæœ

**éªŒæ”¶æ ‡å‡†**ï¼š
- ç‚¹å‡»ç»´åº¦æŒ‰é’®èƒ½åˆ‡æ¢çŠ¶æ€
- æ—¶é—´èŒƒå›´åˆ‡æ¢è§¦å‘æ•°æ®é‡è½½
- è‡ªå®šä¹‰æ—¥æœŸé€‰æ‹©å™¨æ­£å¸¸å·¥ä½œ

---

### Phase 3: é¥¼å›¾ + åˆ—è¡¨è§†å›¾ (Week 3)

**ä»»åŠ¡**ï¼š
- [ ] è¿ç§» `renderPieChart()` ä¸º React ç»„ä»¶
- [ ] å®ç° `ChartSection` (é¥¼å›¾ + æ€»è§ˆ)
- [ ] å®ç° `ListSection` (æ’ååˆ—è¡¨)
- [ ] é›†æˆçœŸå®æ•°æ®ï¼ˆEventServiceã€TagServiceï¼‰
- [ ] æ‚¬åœã€ç‚¹å‡»äº¤äº’

**éªŒæ”¶æ ‡å‡†**ï¼š
- é¥¼å›¾æ­£ç¡®æ¸²æŸ“ï¼ˆåœ†è§’ã€é—´éš™ã€æ¸å˜ï¼‰
- åˆ—è¡¨æ˜¾ç¤º Top 10 ç»Ÿè®¡
- Tooltip æ‚¬åœæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
- ç‚¹å‡»åˆ—è¡¨é¡¹èƒ½èšç„¦åˆ†ç±»

---

### Phase 4: è¶‹åŠ¿è§†å›¾ (Week 4)

**ä»»åŠ¡**ï¼š
- [ ] è¿ç§» `renderLineChart()` ä¸º React ç»„ä»¶
- [ ] è¿ç§» `renderPixelView()` ä¸º React ç»„ä»¶
- [ ] å®ç°è§†å›¾åˆ‡æ¢å™¨ï¼ˆæŠ˜çº¿å›¾/æŸ±çŠ¶å›¾/åƒç´ å—ï¼‰
- [ ] æ™ºèƒ½è§†å›¾åˆ‡æ¢é€»è¾‘
- [ ] è¶‹åŠ¿ç»Ÿè®¡æ‘˜è¦

**éªŒæ”¶æ ‡å‡†**ï¼š
- æŠ˜çº¿å›¾å±•ç¤ºæ—¶é—´è¶‹åŠ¿
- åƒç´ å—æ˜¾ç¤º15åˆ†é’Ÿç²’åº¦
- è‡ªåŠ¨åœ¨é¥¼å›¾å’Œè¶‹åŠ¿å›¾é—´åˆ‡æ¢

---

### Phase 5: æ€§èƒ½ä¼˜åŒ–ä¸æ‰“ç£¨ (Week 5)

**ä»»åŠ¡**ï¼š
- [ ] æ•°æ®ç¼“å­˜æœºåˆ¶ï¼ˆé¿å…é‡å¤åŠ è½½ï¼‰
- [ ] å›¾è¡¨æ¸²æŸ“ä¼˜åŒ–ï¼ˆè™šæ‹ŸåŒ–ã€æ‡’åŠ è½½ï¼‰
- [ ] åŠ¨ç”»æ€§èƒ½ä¼˜åŒ–
- [ ] é”™è¯¯å¤„ç†ä¸ç©ºçŠ¶æ€
- [ ] å•å…ƒæµ‹è¯•

**éªŒæ”¶æ ‡å‡†**ï¼š
- å¤§æ•°æ®é‡ï¼ˆ1000+äº‹ä»¶ï¼‰æµç•…æ¸²æŸ“
- åˆ‡æ¢ç»´åº¦/æ—¶é—´èŒƒå›´å“åº”æ—¶é—´ < 500ms
- æ— å†…å­˜æ³„æ¼

---

### Phase 6: å¯è‡ªå®šä¹‰å¸ƒå±€ ğŸ¨ (Week 6-7)

**è®¾è®¡ç›®æ ‡**ï¼šè®©ç”¨æˆ·è‡ªç”±æ‹–æ‹½ã€è°ƒæ•´ã€æ·»åŠ /åˆ é™¤æ¨¡å—ï¼Œæ‰“é€ ä¸ªæ€§åŒ–çš„Dashboard

#### 6.1 æŠ€æœ¯æ–¹æ¡ˆï¼šReact Grid Layout

**æ¨èåº“**ï¼š`react-grid-layout` + `react-resizable`

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… æ‹–æ‹½æ’åº
- âœ… è°ƒæ•´å¤§å°
- âœ… å“åº”å¼å¸ƒå±€
- âœ… ä¿å­˜å¸ƒå±€é…ç½®
- âœ… é‡ç½®ä¸ºé»˜è®¤å¸ƒå±€

**å®‰è£…**ï¼š
```bash
npm install react-grid-layout react-resizable
```

#### 6.2 å¯ç”¨æ¨¡å—åˆ—è¡¨

ç”¨æˆ·å¯ä»¥ä»æ¨¡å—åº“ä¸­æ·»åŠ /åˆ é™¤ä»¥ä¸‹æ¨¡å—ï¼š

| æ¨¡å—åç§° | é»˜è®¤å°ºå¯¸ | åŠŸèƒ½æè¿° |
|---------|---------|---------|
| ğŸ¯ å¿«é€Ÿè®¡æ—¶ | 280x400px | TimerCardï¼ˆå¿…é€‰ï¼Œä¸å¯åˆ é™¤ï¼‰ |
| ğŸ“… å³å°†åˆ°æ¥ | 1fr x 400px | UpcomingEventsPanel |
| ğŸ“Š ç»Ÿè®¡é¢æ¿ | Full Width x 500px | StatsPanel |
| ğŸ“ˆ è¶‹åŠ¿å›¾è¡¨ | 600x300px | ç‹¬ç«‹çš„è¶‹åŠ¿å›¾ï¼ˆæŠ˜çº¿/æŸ±çŠ¶ï¼‰ |
| ğŸ¥§ åˆ†ç±»é¥¼å›¾ | 400x400px | ç‹¬ç«‹çš„é¥¼å›¾è§†å›¾ |
| ğŸ“ å¿«é€Ÿç¬”è®° | 400x300px | å¿«é€Ÿåˆ›å»ºç¬”è®°çš„è¾“å…¥æ¡† |
| ğŸ”– å¸¸ç”¨æ ‡ç­¾ | 300x200px | å¿«é€Ÿè®¿é—®å¸¸ç”¨æ ‡ç­¾ |
| ğŸ¯ ä»Šæ—¥ç›®æ ‡ | 400x300px | ä»Šæ—¥å¾…åŠäº‹é¡¹ |
| ğŸ“† æœˆå†è§†å›¾ | 500x400px | è¿·ä½ æ—¥å† |
| â±ï¸ ä¸“æ³¨ç»Ÿè®¡ | 300x250px | Pomodoroç»Ÿè®¡ |
| ğŸ å›å¿†å½©è›‹ | 450x350px | å†å²ä¸Šçš„ä»Šå¤©ï¼ˆ30/60/90å¤©å‰ï¼‰ |

#### 6.3 å¸ƒå±€é…ç½®æ•°æ®ç»“æ„

```typescript
interface LayoutConfig {
  id: string;
  layouts: {
    lg: Layout[];  // å¤§å±å¸ƒå±€
    md: Layout[];  // ä¸­å±å¸ƒå±€
    sm: Layout[];  // å°å±å¸ƒå±€
  };
  modules: {
    [key: string]: {
      enabled: boolean;
      config?: any; // æ¨¡å—ç‰¹å®šé…ç½®
    };
  };
}

interface Layout {
  i: string;           // æ¨¡å—ID
  x: number;           // Xåæ ‡ï¼ˆç½‘æ ¼å•ä½ï¼‰
  y: number;           // Yåæ ‡ï¼ˆç½‘æ ¼å•ä½ï¼‰
  w: number;           // å®½åº¦ï¼ˆç½‘æ ¼å•ä½ï¼‰
  h: number;           // é«˜åº¦ï¼ˆç½‘æ ¼å•ä½ï¼‰
  minW?: number;       // æœ€å°å®½åº¦
  minH?: number;       // æœ€å°é«˜åº¦
  static?: boolean;    // æ˜¯å¦å›ºå®šï¼ˆä¸å¯æ‹–æ‹½ï¼‰
}

// é»˜è®¤å¸ƒå±€é…ç½®
const defaultLayoutConfig: LayoutConfig = {
  id: 'default',
  layouts: {
    lg: [
      { i: 'timer', x: 0, y: 0, w: 3, h: 4, minW: 3, minH: 4, static: true },
      { i: 'upcoming', x: 3, y: 0, w: 9, h: 4, minW: 6, minH: 4 },
      { i: 'stats', x: 0, y: 4, w: 12, h: 5, minW: 12, minH: 5 }
    ],
    md: [
      { i: 'timer', x: 0, y: 0, w: 3, h: 4, static: true },
      { i: 'upcoming', x: 3, y: 0, w: 6, h: 4 },
      { i: 'stats', x: 0, y: 4, w: 9, h: 5 }
    ],
    sm: [
      { i: 'timer', x: 0, y: 0, w: 6, h: 4 },
      { i: 'upcoming', x: 0, y: 4, w: 6, h: 4 },
      { i: 'stats', x: 0, y: 8, w: 6, h: 5 }
    ]
  },
  modules: {
    timer: { enabled: true },
    upcoming: { enabled: true },
    stats: { enabled: true }
  }
};
```

#### 6.4 å¸ƒå±€ç¼–è¾‘æ¨¡å¼

**UIè®¾è®¡**ï¼š

```tsx
<div className="homepage-container">
  {/* é¡¶éƒ¨å·¥å…·æ ï¼ˆä»…åœ¨ç¼–è¾‘æ¨¡å¼æ˜¾ç¤ºï¼‰ */}
  {isEditMode && (
    <div className="layout-toolbar">
      <button onClick={toggleEditMode} className="btn-exit-edit">
        âœ… å®Œæˆç¼–è¾‘
      </button>
      <button onClick={openModuleLibrary} className="btn-add-module">
        â• æ·»åŠ æ¨¡å—
      </button>
      <button onClick={resetLayout} className="btn-reset">
        ğŸ”„ é‡ç½®å¸ƒå±€
      </button>
      <button onClick={saveLayout} className="btn-save">
        ğŸ’¾ ä¿å­˜å¸ƒå±€
      </button>
    </div>
  )}
  
  {/* React Grid Layout */}
  <GridLayout
    className="layout"
    layout={currentLayout}
    cols={{ lg: 12, md: 9, sm: 6 }}
    rowHeight={100}
    width={1200}
    isDraggable={isEditMode}
    isResizable={isEditMode}
    onLayoutChange={handleLayoutChange}
  >
    {enabledModules.map(module => (
      <div key={module.id} className="grid-item">
        {isEditMode && (
          <div className="module-controls">
            <button 
              className="btn-remove-module"
              onClick={() => removeModule(module.id)}
            >
              âŒ
            </button>
            <div className="drag-handle">â‹®â‹®</div>
          </div>
        )}
        <ModuleRenderer moduleId={module.id} config={module.config} />
      </div>
    ))}
  </GridLayout>
  
  {/* å³ä¸‹è§’ç¼–è¾‘æŒ‰é’®ï¼ˆéç¼–è¾‘æ¨¡å¼ï¼‰ */}
  {!isEditMode && (
    <button 
      className="btn-edit-layout floating"
      onClick={toggleEditMode}
    >
      âš™ï¸ è‡ªå®šä¹‰å¸ƒå±€
    </button>
  )}
</div>
```

**æ ·å¼**ï¼š
```css
.layout-toolbar {
  display: flex;
  justify-content: space-between;
  padding: 12px 16px;
  background: white;
  border-radius: 12px;
  margin-bottom: 16px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.grid-item {
  position: relative;
  background: white;
  border-radius: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  overflow: hidden;
  transition: box-shadow 0.2s;
}

.grid-item:hover {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
}

/* ç¼–è¾‘æ¨¡å¼ä¸‹çš„è™šçº¿è¾¹æ¡† */
.layout.edit-mode .grid-item {
  border: 2px dashed #667eea;
}

.module-controls {
  position: absolute;
  top: 8px;
  right: 8px;
  z-index: 10;
  display: flex;
  gap: 8px;
}

.drag-handle {
  cursor: move;
  padding: 4px 8px;
  background: rgba(102, 126, 234, 0.1);
  border-radius: 6px;
  color: #667eea;
  font-size: 16px;
}

.btn-edit-layout.floating {
  position: fixed;
  bottom: 24px;
  right: 24px;
  padding: 12px 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 50px;
  box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
  cursor: pointer;
  transition: all 0.3s;
  z-index: 1000;
}

.btn-edit-layout.floating:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 24px rgba(102, 126, 234, 0.5);
}
```

#### 6.5 æ¨¡å—åº“ï¼ˆModule Libraryï¼‰

**å¼¹å‡ºå¼é€‰æ‹©ç•Œé¢**ï¼š

```tsx
<Modal isOpen={showModuleLibrary} onClose={closeModuleLibrary}>
  <div className="module-library">
    <h2>ğŸ“¦ æ¨¡å—åº“</h2>
    <p className="subtitle">é€‰æ‹©è¦æ·»åŠ åˆ°é¦–é¡µçš„æ¨¡å—</p>
    
    <div className="module-grid">
      {availableModules.map(module => (
        <div 
          key={module.id} 
          className={`module-card ${isModuleEnabled(module.id) ? 'enabled' : ''}`}
        >
          <div className="module-icon">{module.icon}</div>
          <h3>{module.name}</h3>
          <p>{module.description}</p>
          <div className="module-meta">
            <span>å°ºå¯¸: {module.defaultSize}</span>
          </div>
          
          {isModuleEnabled(module.id) ? (
            <button 
              className="btn-remove"
              onClick={() => removeModule(module.id)}
            >
              âœ“ å·²æ·»åŠ 
            </button>
          ) : (
            <button 
              className="btn-add"
              onClick={() => addModule(module.id)}
            >
              â• æ·»åŠ 
            </button>
          )}
        </div>
      ))}
    </div>
  </div>
</Modal>
```

#### 6.6 å¸ƒå±€æŒä¹…åŒ–

**ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨**ï¼š
```typescript
// ä¿å­˜å¸ƒå±€
const saveLayout = async (config: LayoutConfig) => {
  await PersistentStorage.setItem(
    'homepage_layout_config',
    JSON.stringify(config),
    PERSISTENT_OPTIONS
  );
  
  console.log('âœ… å¸ƒå±€å·²ä¿å­˜');
};

// åŠ è½½å¸ƒå±€
const loadLayout = async (): Promise<LayoutConfig> => {
  const saved = await PersistentStorage.getItem('homepage_layout_config');
  
  if (saved) {
    return JSON.parse(saved);
  }
  
  return defaultLayoutConfig;
};

// é‡ç½®ä¸ºé»˜è®¤å¸ƒå±€
const resetLayout = async () => {
  const confirm = window.confirm('ç¡®å®šè¦é‡ç½®ä¸ºé»˜è®¤å¸ƒå±€å—ï¼Ÿ');
  if (!confirm) return;
  
  await PersistentStorage.removeItem('homepage_layout_config');
  setCurrentLayout(defaultLayoutConfig);
  
  console.log('ğŸ”„ å¸ƒå±€å·²é‡ç½®');
};
```

#### 6.7 æ¨¡å—é…ç½®é¢æ¿

æ¯ä¸ªæ¨¡å—å¯ä»¥æœ‰è‡ªå·±çš„é…ç½®é€‰é¡¹ï¼š

```tsx
// ä¾‹å¦‚ï¼šç»Ÿè®¡é¢æ¿çš„é…ç½®
interface StatsPanelConfig {
  defaultDimension: 'tags' | 'calendars';
  defaultTimeRange: 'today' | 'week' | 'month';
  showSummary: boolean;
  chartType: 'pie' | 'donut' | 'bar';
}

// é…ç½®ç•Œé¢
<div className="module-config-panel">
  <h4>âš™ï¸ ç»Ÿè®¡é¢æ¿è®¾ç½®</h4>
  
  <div className="config-item">
    <label>é»˜è®¤ç»´åº¦</label>
    <select value={config.defaultDimension} onChange={handleDimensionChange}>
      <option value="tags">æ ‡ç­¾</option>
      <option value="calendars">æ—¥å†</option>
    </select>
  </div>
  
  <div className="config-item">
    <label>é»˜è®¤æ—¶é—´èŒƒå›´</label>
    <select value={config.defaultTimeRange} onChange={handleTimeRangeChange}>
      <option value="today">ä»Šå¤©</option>
      <option value="week">æœ¬å‘¨</option>
      <option value="month">æœ¬æœˆ</option>
    </select>
  </div>
  
  <div className="config-item">
    <label>
      <input 
        type="checkbox" 
        checked={config.showSummary}
        onChange={handleSummaryToggle}
      />
      æ˜¾ç¤ºç»Ÿè®¡æ‘˜è¦
    </label>
  </div>
</div>
```

#### 6.8 é¢„è®¾å¸ƒå±€æ¨¡æ¿

æä¾›å‡ ç§é¢„è®¾å¸ƒå±€ä¾›ç”¨æˆ·å¿«é€Ÿåˆ‡æ¢ï¼š

```typescript
const layoutPresets = {
  default: {
    name: 'é»˜è®¤å¸ƒå±€',
    description: 'å¹³è¡¡çš„ä¸‰æ¨¡å—å¸ƒå±€',
    thumbnail: '/assets/layout-default.png',
    config: defaultLayoutConfig
  },
  minimal: {
    name: 'æç®€æ¨¡å¼',
    description: 'åªæ˜¾ç¤ºè®¡æ—¶å™¨å’Œç»Ÿè®¡',
    thumbnail: '/assets/layout-minimal.png',
    config: {
      modules: {
        timer: { enabled: true },
        stats: { enabled: true }
      }
    }
  },
  focus: {
    name: 'ä¸“æ³¨æ¨¡å¼',
    description: 'å¤§å·è®¡æ—¶å™¨ + ä»Šæ—¥ç›®æ ‡',
    thumbnail: '/assets/layout-focus.png',
    config: {
      modules: {
        timer: { enabled: true },
        todayGoals: { enabled: true },
        focusStats: { enabled: true }
      }
    }
  },
  dashboard: {
    name: 'æ•°æ®é©¾é©¶èˆ±',
    description: 'å¤šå›¾è¡¨åˆ†æè§†å›¾',
    thumbnail: '/assets/layout-dashboard.png',
    config: {
      modules: {
        stats: { enabled: true },
        trendChart: { enabled: true },
        pieChart: { enabled: true },
        calendar: { enabled: true }
      }
    }
  }
};

// é¢„è®¾é€‰æ‹©å™¨
<div className="layout-presets">
  <h3>ğŸ“ å¸ƒå±€æ¨¡æ¿</h3>
  <div className="preset-grid">
    {Object.entries(layoutPresets).map(([key, preset]) => (
      <div 
        key={key}
        className="preset-card"
        onClick={() => applyPreset(preset.config)}
      >
        <img src={preset.thumbnail} alt={preset.name} />
        <h4>{preset.name}</h4>
        <p>{preset.description}</p>
      </div>
    ))}
  </div>
</div>
```

#### 6.9 å®ç°ä»»åŠ¡æ¸…å•

**Phase 6A: åŸºç¡€æ‹–æ‹½åŠŸèƒ½ (Week 6)**
- [ ] é›†æˆ `react-grid-layout`
- [ ] å®ç°ç¼–è¾‘æ¨¡å¼åˆ‡æ¢
- [ ] å®ç°æ‹–æ‹½æ’åº
- [ ] å®ç°è°ƒæ•´å¤§å°
- [ ] å¸ƒå±€æŒä¹…åŒ–ï¼ˆä¿å­˜/åŠ è½½ï¼‰

**Phase 6B: æ¨¡å—ç®¡ç† (Week 7)**
- [ ] åˆ›å»ºæ¨¡å—åº“ç•Œé¢
- [ ] å®ç°æ·»åŠ /åˆ é™¤æ¨¡å—
- [ ] å¼€å‘è‡³å°‘8ä¸ªå¯é€‰æ¨¡å—ï¼ˆåŒ…æ‹¬å›å¿†å½©è›‹ï¼‰
- [ ] æ¨¡å—é…ç½®é¢æ¿
- [ ] é¢„è®¾å¸ƒå±€æ¨¡æ¿

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… ç”¨æˆ·å¯ä»¥æ‹–æ‹½ä»»æ„æ¨¡å—è°ƒæ•´ä½ç½®
- âœ… ç”¨æˆ·å¯ä»¥è°ƒæ•´æ¨¡å—å¤§å°ï¼ˆåœ¨é™åˆ¶èŒƒå›´å†…ï¼‰
- âœ… å¸ƒå±€é…ç½®èƒ½æ­£ç¡®ä¿å­˜å’Œæ¢å¤
- âœ… æ¨¡å—åº“å¯ä»¥æ·»åŠ /åˆ é™¤æ¨¡å—
- âœ… é¢„è®¾æ¨¡æ¿å¯ä»¥ä¸€é”®åº”ç”¨
- âœ… å›å¿†å½©è›‹æ­£ç¡®æ˜¾ç¤ºå†å²äº‹ä»¶

---

### Phase 7: é«˜çº§åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

**ä»»åŠ¡**ï¼š
- [ ] å¤šç»´åº¦åŒæ—¶å±•ç¤ºï¼ˆå¹¶æ’å¯¹æ¯”ï¼‰
- [ ] å¯¼å‡ºç»Ÿè®¡æŠ¥å‘Šï¼ˆPDF/CSVï¼‰
- [ ] åˆ†äº«å¸ƒå±€é…ç½®ï¼ˆç”Ÿæˆé“¾æ¥ï¼‰
- [ ] AI æ´å¯Ÿå»ºè®®ï¼ˆåŸºäºç»Ÿè®¡æ•°æ®ï¼‰
- [ ] å¸ƒå±€äº‘åŒæ­¥ï¼ˆè·¨è®¾å¤‡åŒæ­¥é…ç½®ï¼‰

---

## é™„å½•

### A. æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ HomePage/
â”‚       â”œâ”€â”€ HomePage.tsx          # ä¸»ç»„ä»¶ï¼ˆå¯è‡ªå®šä¹‰å¸ƒå±€ï¼‰
â”‚       â”œâ”€â”€ HomePage.css          # æ ·å¼
â”‚       â”œâ”€â”€ HomePageGrid.tsx      # Grid Layout å®¹å™¨ ğŸ†•
â”‚       â”œâ”€â”€ ModuleLibrary.tsx     # æ¨¡å—åº“ç»„ä»¶ ğŸ†•
â”‚       â”œâ”€â”€ LayoutPresets.tsx     # é¢„è®¾å¸ƒå±€é€‰æ‹©å™¨ ğŸ†•
â”‚       â”œâ”€â”€ modules/              # å¯é€‰æ¨¡å— ğŸ†•
â”‚       â”‚   â”œâ”€â”€ TimerModule.tsx
â”‚       â”‚   â”œâ”€â”€ UpcomingModule.tsx
â”‚       â”‚   â”œâ”€â”€ StatsModule.tsx
â”‚       â”‚   â”œâ”€â”€ TrendChartModule.tsx
â”‚       â”‚   â”œâ”€â”€ PieChartModule.tsx
â”‚       â”‚   â”œâ”€â”€ QuickNoteModule.tsx
â”‚       â”‚   â”œâ”€â”€ CommonTagsModule.tsx
â”‚       â”‚   â”œâ”€â”€ TodayGoalsModule.tsx
â”‚       â”‚   â”œâ”€â”€ CalendarModule.tsx
â”‚       â”‚   â”œâ”€â”€ FocusStatsModule.tsx
â”‚       â”‚   â””â”€â”€ MemoryEasterEggModule.tsx  ğŸ†•
â”‚       â”œâ”€â”€ StatsPanel/
â”‚       â”‚   â”œâ”€â”€ StatsPanel.tsx
â”‚       â”‚   â”œâ”€â”€ StatsControlBar.tsx
â”‚       â”‚   â”œâ”€â”€ StatsMainView.tsx
â”‚       â”‚   â”œâ”€â”€ ChartSection.tsx
â”‚       â”‚   â””â”€â”€ ListSection.tsx
â”‚       â””â”€â”€ UpcomingEventsPanel/
â”‚           â””â”€â”€ CompactEventCard.tsx
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ TimerCard.tsx             # å·²å®ç°
â”‚   â”œâ”€â”€ DailyStatsCard.tsx        # å·²å®ç°
â”‚   â””â”€â”€ ModuleRenderer.tsx        # æ¨¡å—æ¸²æŸ“å™¨ ğŸ†•
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ chartUtils.ts             # å›¾è¡¨å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ statsCalculator.ts        # ç»Ÿè®¡è®¡ç®—é€»è¾‘
â”‚   â””â”€â”€ layoutConfig.ts           # å¸ƒå±€é…ç½®ç®¡ç† ğŸ†•
â””â”€â”€ constants/
    â””â”€â”€ moduleDefinitions.ts      # æ¨¡å—å®šä¹‰å¸¸é‡ ğŸ†•
```

### B. API æ¥å£

```typescript
// è·å–ç»Ÿè®¡æ•°æ®
interface StatsAPI {
  // æ ‡ç­¾ç»Ÿè®¡
  getTagStats(timeRange: TimeRange): Promise<TagStats[]>;
  
  æ‹–æ‹½æµç•…åº¦ | 60 FPS | Chrome DevTools |
| å¸ƒå±€ä¿å­˜æ—¶é—´ | < 100ms | Performance API |
| å†…å­˜å ç”¨ | < 80MB | Chrome DevToolsï¼ˆåŒ…å«Grid Layoutï¼‰ |

### D. ä¾èµ–åŒ…æ¸…å•

```json
{
  "dependencies": {
    "react-grid-layout": "^1.4.4",
    "react-resizable": "^3.0.5"
  },
  "devDependencies": {
    "@types/react-grid-layout": "^1.3.5",
    "@types/react-resizable": "^3.0.7"
  }
}
```

**CSS å¯¼å…¥**ï¼ˆåœ¨ HomePage.tsx ä¸­ï¼‰ï¼š
```tsx
import 'react-grid-layout/css/styles.css';
import 'react-resizable/css/styles.css';
```

### E. å›å¿†å½©è›‹æ¨¡å—è¯¦ç»†è®¾è®¡ ğŸ

è¿™æ˜¯ä¸€ä¸ªæ¸©é¦¨çš„åŠŸèƒ½ï¼Œè®©ç”¨æˆ·é‡æ¸©è¿‡å»çš„ç¾å¥½æ—¶å…‰ã€‚

#### E.1 æ ¸å¿ƒåŠŸèƒ½

**æ—¶é—´å›æº¯ç‚¹**ï¼š
- ğŸ“… **30å¤©å‰**ï¼ˆ1ä¸ªæœˆå‰çš„ä»Šå¤©ï¼‰
- ğŸ“… **60å¤©å‰**ï¼ˆ2ä¸ªæœˆå‰çš„ä»Šå¤©ï¼‰
- ğŸ“… **90å¤©å‰**ï¼ˆ3ä¸ªå­£åº¦å‰çš„ä»Šå¤©ï¼‰
- ğŸ“… **180å¤©å‰**ï¼ˆåŠå¹´å‰çš„ä»Šå¤©ï¼‰
- ğŸ“… **365å¤©å‰**ï¼ˆå»å¹´çš„ä»Šå¤©ï¼‰
- ğŸ‚ **ç”Ÿæ—¥/çºªå¿µæ—¥**ï¼ˆç”¨æˆ·è®¾ç½®çš„ç‰¹æ®Šæ—¥æœŸï¼‰

**å±•ç¤ºå†…å®¹**ï¼š
1. **äº‹ä»¶**ï¼šå½“å¤©åˆ›å»ºæˆ–å‘ç”Ÿçš„é‡è¦äº‹ä»¶
2. **æ—¥å¿—**ï¼šå½“å¤©å†™ä¸‹çš„ç¬”è®°å’Œæƒ³æ³•
3. **è®¡æ—¶è®°å½•**ï¼šå½“å¤©ä¸“æ³¨çš„æ—¶é•¿å’Œé¡¹ç›®
4. **ç‰¹æ®Šæ—¶åˆ»**ï¼š
   - æœ€é•¿ä¸“æ³¨æ—¶é•¿çš„äº‹ä»¶
   - ç¬¬ä¸€æ¬¡ä½¿ç”¨æŸä¸ªæ ‡ç­¾
   - å®Œæˆçš„é‡è¦ä»»åŠ¡

#### E.2 UI è®¾è®¡

```tsx
<div className="memory-easter-egg-module">
  {/* æ ‡é¢˜æ  */}
  <div className="module-header">
    <h3>ğŸ å›å¿†å½©è›‹</h3>
    <div className="time-selector">
      <button 
        className={selectedPeriod === 30 ? 'active' : ''}
        onClick={() => setSelectedPeriod(30)}
      >
        30å¤©å‰
      </button>
      <button 
        className={selectedPeriod === 60 ? 'active' : ''}
        onClick={() => setSelectedPeriod(60)}
      >
        60å¤©å‰
      </button>
      <button 
        className={selectedPeriod === 90 ? 'active' : ''}
        onClick={() => setSelectedPeriod(90)}
      >
        90å¤©å‰
      </button>
    </div>
  </div>
  
  {/* å†…å®¹åŒº */}
  {hasMemories ? (
    <div className="memory-content">
      {/* æ—¥æœŸæ ‡é¢˜ */}
      <div className="memory-date">
        <span className="date-text">{formatMemoryDate(targetDate)}</span>
        <span className="days-ago">{selectedPeriod}å¤©å‰</span>
      </div>
      
      {/* å›å¿†å¡ç‰‡åˆ—è¡¨ */}
      <div className="memory-cards">
        {/* ç‰¹åˆ«æ—¶åˆ»å¡ç‰‡ */}
        {specialMoment && (
          <div className="memory-card special">
            <div className="card-icon">â­</div>
            <div className="card-content">
              <div className="card-label">ç‰¹åˆ«æ—¶åˆ»</div>
              <div className="card-title">{specialMoment.title}</div>
              <div className="card-meta">
                {specialMoment.type === 'longest-focus' && (
                  <>
                    <span>ä¸“æ³¨æ—¶é•¿: {formatDuration(specialMoment.duration)}</span>
                    <span className="tag">{specialMoment.tagName}</span>
                  </>
                )}
              </div>
            </div>
          </div>
        )}
        
        {/* äº‹ä»¶å¡ç‰‡ */}
        {events.map(event => (
          <div key={event.id} className="memory-card event">
            <div className="card-icon">
              {event.isTimer ? 'â±ï¸' : event.eventlog ? 'ğŸ“' : 'ğŸ“…'}
            </div>
            <div className="card-content">
              <div className="card-label">
                {event.isTimer ? 'è®¡æ—¶è®°å½•' : event.eventlog ? 'æ—¥å¿—' : 'äº‹ä»¶'}
              </div>
              <div className="card-title">{event.title?.simpleTitle}</div>
              <div className="card-meta">
                {event.startTime && (
                  <span>{formatTime(event.startTime)}</span>
                )}
                {event.tags && event.tags.length > 0 && (
                  <span className="tag">{getTagName(event.tags[0])}</span>
                )}
                {event.isTimer && event.duration && (
                  <span className="duration">
                    {formatDuration(event.duration)}
                  </span>
                )}
              </div>
              {event.eventlog && (
                <div className="card-preview">
                  {truncateText(stripHtml(event.eventlog), 80)}
                </div>
              )}
            </div>
          </div>
        ))}
        
        {/* ç»Ÿè®¡æ‘˜è¦ */}
        <div className="memory-summary">
          <div className="summary-item">
            <span className="summary-label">äº‹ä»¶æ•°</span>
            <span className="summary-value">{totalEvents}</span>
          </div>
          <div className="summary-item">
            <span className="summary-label">æ€»æ—¶é•¿</span>
            <span className="summary-value">{formatDuration(totalDuration)}</span>
          </div>
          <div className="summary-item">
            <span className="summary-label">æœ€æ´»è·ƒæ ‡ç­¾</span>
            <span className="summary-value">{topTag}</span>
          </div>
        </div>
      </div>
    </div>
  ) : (
    <div className="empty-state">
      <div className="empty-icon">ğŸŒŸ</div>
      <p>é‚£æ—¶å€™è¿˜æ²¡æœ‰å¼€å§‹ä½¿ç”¨ 4DNote</p>
      <p className="hint">ç»§ç»­è®°å½•ï¼Œåˆ›é€ æ›´å¤šç¾å¥½å›å¿†å§ï¼</p>
    </div>
  )}
  
  {/* åº•éƒ¨æ“ä½œ */}
  {hasMemories && (
    <div className="memory-actions">
      <button 
        className="btn-view-details"
        onClick={() => navigateToDate(targetDate)}
      >
        æŸ¥çœ‹å®Œæ•´æ—¶é—´è½´ â†’
      </button>
    </div>
  )}
</div>
```

#### E.3 æ ·å¼è®¾è®¡

```css
.memory-easter-egg-module {
  display: flex;
  flex-direction: column;
  background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
  border-radius: 20px;
  padding: 20px;
  height: 100%;
  overflow: hidden;
}

.module-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.module-header h3 {
  font-size: 18px;
  font-weight: 600;
  color: #1f2937;
  margin: 0;
}

.time-selector {
  display: flex;
  gap: 6px;
  background: white;
  padding: 4px;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
}

.time-selector button {
  padding: 6px 12px;
  border: none;
  border-radius: 6px;
  background: transparent;
  color: #6b7280;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
}

.time-selector button:hover {
  background: #f3f4f6;
  color: #374151;
}

.time-selector button.active {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
}

.memory-content {
  flex: 1;
  overflow-y: auto;
  padding-right: 8px;
}

.memory-date {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding: 12px 16px;
  background: white;
  border-radius: 12px;
  border-left: 4px solid #667eea;
}

.date-text {
  font-size: 16px;
  font-weight: 600;
  color: #1f2937;
}

.days-ago {
  font-size: 12px;
  color: #9ca3af;
  background: #f3f4f6;
  padding: 4px 8px;
  border-radius: 6px;
}

.memory-cards {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.memory-card {
  display: flex;
  gap: 12px;
  padding: 14px;
  background: white;
  border-radius: 12px;
  transition: all 0.2s;
  cursor: pointer;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.memory-card:hover {
  transform: translateX(4px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.memory-card.special {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border: 2px solid #fbbf24;
}

.card-icon {
  font-size: 24px;
  flex-shrink: 0;
}

.card-content {
  flex: 1;
  min-width: 0;
}

.card-label {
  font-size: 11px;
  font-weight: 600;
  color: #9ca3af;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.card-title {
  font-size: 14px;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 6px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.card-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  font-size: 12px;
  color: #6b7280;
}

.card-meta .tag {
  padding: 2px 8px;
  background: #e5e7eb;
  border-radius: 6px;
  color: #374151;
}

.card-meta .duration {
  font-weight: 600;
  color: #667eea;
}

.card-preview {
  margin-top: 8px;
  font-size: 13px;
  color: #6b7280;
  line-height: 1.5;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.memory-summary {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-top: 16px;
  padding: 14px;
  background: white;
  border-radius: 12px;
  border: 2px dashed #e5e7eb;
}

.summary-item {
  text-align: center;
}

.summary-label {
  display: block;
  font-size: 11px;
  color: #9ca3af;
  margin-bottom: 4px;
}

.summary-value {
  display: block;
  font-size: 16px;
  font-weight: 700;
  color: #667eea;
}

.empty-state {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 40px 20px;
}

.empty-icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}

.empty-state p {
  color: #6b7280;
  margin: 4px 0;
}

.empty-state .hint {
  font-size: 13px;
  color: #9ca3af;
}

.memory-actions {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid #e5e7eb;
}

.btn-view-details {
  width: 100%;
  padding: 10px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-view-details:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}
```

#### E.4 æ•°æ®æŸ¥è¯¢é€»è¾‘

```typescript
interface MemoryData {
  targetDate: Date;
  daysAgo: number;
  events: Event[];
  specialMoment?: {
    type: 'longest-focus' | 'first-tag' | 'milestone';
    title: string;
    duration?: number;
    tagName?: string;
  };
  stats: {
    totalEvents: number;
    totalDuration: number;
    topTag: string;
  };
}

/**
 * è·å–å›å¿†æ•°æ®
 */
const getMemoryData = async (daysAgo: number): Promise<MemoryData | null> => {
  // è®¡ç®—ç›®æ ‡æ—¥æœŸï¼ˆdaysAgoå¤©å‰ï¼‰
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  const targetDate = new Date(today);
  targetDate.setDate(targetDate.getDate() - daysAgo);
  
  // æ„é€ æ—¥æœŸèŒƒå›´ï¼ˆç›®æ ‡æ—¥æœŸçš„æ•´å¤©ï¼‰
  const startOfDay = new Date(targetDate);
  startOfDay.setHours(0, 0, 0, 0);
  
  const endOfDay = new Date(targetDate);
  endOfDay.setHours(23, 59, 59, 999);
  
  // æŸ¥è¯¢è¯¥æ—¥æœŸçš„æ‰€æœ‰äº‹ä»¶
  const allEvents = await EventService.getTimelineEvents({
    startDate: startOfDay,
    endDate: endOfDay
  });
  
  if (allEvents.length === 0) {
    return null; // æ²¡æœ‰å›å¿†
  }
  
  // è¿‡æ»¤æœ‰æ„ä¹‰çš„äº‹ä»¶ï¼ˆæ’é™¤ç³»ç»Ÿäº‹ä»¶ï¼‰
  const meaningfulEvents = allEvents.filter(event => 
    !event.isOutsideApp && 
    (event.title?.simpleTitle || event.eventlog)
  );
  
  // è®¡ç®—ç»Ÿè®¡æ•°æ®
  const stats = calculateMemoryStats(meaningfulEvents);
  
  // è¯†åˆ«ç‰¹æ®Šæ—¶åˆ»
  const specialMoment = findSpecialMoment(meaningfulEvents, targetDate);
  
  return {
    targetDate,
    daysAgo,
    events: meaningfulEvents.slice(0, 5), // åªæ˜¾ç¤ºå‰5ä¸ª
    specialMoment,
    stats
  };
};

/**
 * è®¡ç®—ç»Ÿè®¡æ•°æ®
 */
const calculateMemoryStats = (events: Event[]) => {
  let totalDuration = 0;
  const tagCount = new Map<string, number>();
  
  events.forEach(event => {
    // è®¡ç®—æ—¶é•¿
    if (event.startTime && event.endTime) {
      const duration = new Date(event.endTime).getTime() - new Date(event.startTime).getTime();
      totalDuration += duration;
    }
    
    // ç»Ÿè®¡æ ‡ç­¾
    if (event.tags && event.tags.length > 0) {
      event.tags.forEach(tagId => {
        tagCount.set(tagId, (tagCount.get(tagId) || 0) + 1);
      });
    }
  });
  
  // æ‰¾å‡ºæœ€æ´»è·ƒæ ‡ç­¾
  let topTag = '';
  let maxCount = 0;
  tagCount.forEach((count, tagId) => {
    if (count > maxCount) {
      maxCount = count;
      const tag = TagService.getTagById(tagId);
      topTag = tag?.name || tagId;
    }
  });
  
  return {
    totalEvents: events.length,
    totalDuration,
    topTag
  };
};

/**
 * è¯†åˆ«ç‰¹æ®Šæ—¶åˆ»
 */
const findSpecialMoment = (events: Event[], targetDate: Date) => {
  // 1. æ‰¾å‡ºæœ€é•¿ä¸“æ³¨æ—¶é•¿çš„äº‹ä»¶
  let longestEvent: Event | null = null;
  let maxDuration = 0;
  
  events.filter(e => e.isTimer).forEach(event => {
    if (event.startTime && event.endTime) {
      const duration = new Date(event.endTime).getTime() - new Date(event.startTime).getTime();
      if (duration > maxDuration) {
        maxDuration = duration;
        longestEvent = event;
      }
    }
  });
  
  if (longestEvent && maxDuration > 3600000) { // è¶…è¿‡1å°æ—¶
    const tag = longestEvent.tags?.[0] ? TagService.getTagById(longestEvent.tags[0]) : null;
    return {
      type: 'longest-focus' as const,
      title: longestEvent.title?.simpleTitle || 'ä¸“æ³¨æ—¶åˆ»',
      duration: maxDuration,
      tagName: tag?.name
    };
  }
  
  // 2. æ£€æŸ¥æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨æŸä¸ªæ ‡ç­¾
  // TODO: å®ç°æ ‡ç­¾é¦–æ¬¡ä½¿ç”¨æ£€æµ‹
  
  // 3. æ£€æŸ¥æ˜¯å¦æœ‰é‡Œç¨‹ç¢‘äº‹ä»¶
  // TODO: å®ç°é‡Œç¨‹ç¢‘æ£€æµ‹
  
  return undefined;
};

/**
 * æ ¼å¼åŒ–å›å¿†æ—¥æœŸ
 */
const formatMemoryDate = (date: Date): string => {
  const year = date.getFullYear();
  const month = date.getMonth() + 1;
  const day = date.getDate();
  const weekdays = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
  const weekday = weekdays[date.getDay()];
  
  return `${year}å¹´${month}æœˆ${day}æ—¥ ${weekday}`;
};
```

#### E.5 æ¨¡å—é…ç½®é€‰é¡¹

```typescript
interface MemoryModuleConfig {
  defaultPeriod: 30 | 60 | 90 | 180 | 365; // é»˜è®¤æ˜¾ç¤ºçš„æ—¶é—´æ®µ
  showSpecialMoments: boolean;              // æ˜¯å¦æ˜¾ç¤ºç‰¹æ®Šæ—¶åˆ»
  maxEventsToShow: number;                  // æœ€å¤šæ˜¾ç¤ºäº‹ä»¶æ•°
  autoRefresh: boolean;                     // æ˜¯å¦æ¯æ—¥è‡ªåŠ¨åˆ·æ–°
  enabledPeriods: number[];                 // å¯ç”¨çš„æ—¶é—´æ®µé€‰é¡¹
}

// é»˜è®¤é…ç½®
const defaultConfig: MemoryModuleConfig = {
  defaultPeriod: 30,
  showSpecialMoments: true,
  maxEventsToShow: 5,
  autoRefresh: true,
  enabledPeriods: [30, 60, 90]
};
```

#### E.6 é«˜çº§åŠŸèƒ½ï¼ˆæœªæ¥æ‰©å±•ï¼‰

1. **AI ç”Ÿæˆå›å¿†æ‘˜è¦**
   ```
   "30å¤©å‰çš„ä»Šå¤©ï¼Œä½ ä¸“æ³¨äºå·¥ä½œæ ‡ç­¾è¾¾åˆ°4å°æ—¶ï¼Œ
   å®Œæˆäº†é¡¹ç›®æŠ¥å‘Šï¼Œå¹¶è®°å½•äº†ä¸€æ¡å…³äºå›¢é˜Ÿåä½œçš„æ€è€ƒã€‚"
   ```

2. **å›å¿†åˆ†äº«**
   - ç”Ÿæˆç²¾ç¾çš„å›å¿†å¡ç‰‡å›¾ç‰‡
   - ä¸€é”®åˆ†äº«åˆ°ç¤¾äº¤åª’ä½“

3. **å›å¿†å¯¹æ¯”**
   - å¯¹æ¯”ä»Šå¤©ä¸30å¤©å‰çš„æ—¶é—´ä½¿ç”¨
   - æ˜¾ç¤ºè¿›æ­¥å’Œå˜åŒ–

4. **å›å¿†æ—¥å†**
   - æ ‡æ³¨æœ‰ç‰¹æ®Šå›å¿†çš„æ—¥æœŸ
   - ç‚¹å‡»æŸ¥çœ‹è¯¥æ—¥çš„å®Œæ•´å›å¿†

5. **å¹´åº¦å›å¿†**
   - è‡ªåŠ¨ç”Ÿæˆå¹´åº¦æ€»ç»“
   - æœ€éš¾å¿˜çš„æ—¶åˆ»ã€æœ€å¸¸ç”¨çš„æ ‡ç­¾ç­‰

---

### F. ç”¨æˆ·å¼•å¯¼æµç¨‹

**é¦–æ¬¡ä½¿ç”¨æ—¶çš„å¼•å¯¼æç¤º**ï¼š

1. **æ¬¢è¿å¼¹çª—**
   ```
   ğŸ‰ æ¬¢è¿ä½¿ç”¨è‡ªå®šä¹‰å¸ƒå±€åŠŸèƒ½ï¼
   
   ä½ å¯ä»¥ï¼š
   â€¢ æ‹–æ‹½æ¨¡å—è°ƒæ•´ä½ç½®
   â€¢ è°ƒæ•´æ¨¡å—å¤§å°
   â€¢ æ·»åŠ /åˆ é™¤æ¨¡å—
   â€¢ ä½¿ç”¨é¢„è®¾æ¨¡æ¿
   
   ç‚¹å‡»å³ä¸‹è§’çš„"âš™ï¸ è‡ªå®šä¹‰å¸ƒå±€"å¼€å§‹å§ï¼
   ```

2. **ç¼–è¾‘æ¨¡å¼æç¤º**ï¼ˆé¦–æ¬¡è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼‰
   ```
   ğŸ’¡ å°æç¤º
   
   â€¢ æ‹–æ‹½æ¨¡å—æ ‡é¢˜æ å¯ä»¥ç§»åŠ¨
   â€¢ æ‹–æ‹½å³ä¸‹è§’å¯ä»¥è°ƒæ•´å¤§å°
   â€¢ ç‚¹å‡» âŒ å¯ä»¥åˆ é™¤æ¨¡å—
   â€¢ ç‚¹å‡» â• å¯ä»¥æ·»åŠ æ–°æ¨¡å—
   ```

3. **ä¿å­˜æé†’**ï¼ˆé€€å‡ºç¼–è¾‘æ¨¡å¼æ—¶ï¼‰
   ```
   æ˜¯å¦ä¿å­˜ä½ çš„å¸ƒå±€æ›´æ”¹ï¼Ÿ
   
   [ä¿å­˜] [æ”¾å¼ƒæ›´æ”¹] [å–æ¶ˆ]
   ```
  getCalendarStats(timeRange: TimeRange): Promise<CalendarStats[]>;
  
  // è¶‹åŠ¿æ•°æ®
  getTrendData(timeRange: TimeRange, dimension: string): Promise<DailyStats[]>;
  
  // å³å°†åˆ°æ¥çš„äº‹ä»¶
  getUpcomingEvents(limit: number): Promise<Event[]>;
}
```

### C. æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹å¼ |
|------|--------|---------|
| é¦–å±åŠ è½½æ—¶é—´ | < 1s | Performance API |
| ç»´åº¦åˆ‡æ¢å“åº” | < 500ms | ç”¨æˆ·æ„ŸçŸ¥æµ‹è¯• |
| å›¾è¡¨æ¸²æŸ“æ—¶é—´ | < 300ms | React Profiler |
| å†…å­˜å ç”¨ | < 50MB | Chrome DevTools |

---

**æ–‡æ¡£ç»´æŠ¤**ï¼šéšå¼€å‘è¿›åº¦æ›´æ–°ï¼Œç¡®ä¿è®¾è®¡ä¸å®ç°ä¸€è‡´ã€‚
