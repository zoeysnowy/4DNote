# AI Event Extraction V2 - 使用指南

## 🎉 新功能概览

AI 事件提取工具 V2 版本带来了全面的批量处理和智能优化功能：

### ✨ 核心功能

1. **📦 批量上传**
   - 支持文件批量上传（PDF、TXT、DOCX）
   - 支持文本批量粘贴（每段用空行分隔）
   - 支持网页链接批量输入

2. **⚙️ 批量处理**
   - 自动化批量处理流程
   - 实时进度跟踪
   - 错误自动捕获和重试

3. **⭐ 智能评分系统**
   - 1-5 星评分机制
   - 低分任务反馈收集
   - 自动质量监控

4. **🤖 Prompt 自动优化**
   - 基于评分自动触发优化
   - 智能分析常见问题
   - 自动调整 Prompt 策略
   - 版本历史管理

5. **📊 数据统计与对比**
   - 实时统计仪表板
   - 版本对比功能
   - 优化历史记录

---

## 🚀 快速开始

### 1. 配置 AI 服务

点击页面顶部的 **⚙️ 配置** 按钮，选择你的 AI 提供商：

#### 选项 A: 腾讯混元（推荐）
- 输入 Secret ID 和 Secret Key
- 确保代理服务器已启动（Electron 环境可一键启动）
- 每月 100k 免费 tokens

#### 选项 B: 阿里云 DashScope
- 输入 API Key
- 无需代理服务器
- 适合云端部署

#### 选项 C: Ollama 本地模型
- 需要本地安装 Ollama
- 下载 Qwen 2.5 模型
- 完全离线运行

### 2. 添加处理任务

切换到 **📤 上传任务** 标签：

#### 方法 1: 上传文件
```
点击 [选择文件] → 选择一个或多个文件 → 自动添加到队列
```

#### 方法 2: 粘贴文本
```
点击 [批量输入] → 粘贴多段文本（空行分隔）→ [添加]
```

示例文本格式：
```
会议通知：明天下午2点在会议室A举行项目评审会议，请准时参加。

活动邀请：本周五晚上7点在市中心举办团建活动，地点在火锅店。

培训安排：下周一上午9点开始为期3天的新员工培训，地点在培训中心。
```

#### 方法 3: 添加链接
```
输入框粘贴 URL → 按回车或点击 [添加]
```

### 3. 开始批量处理

1. 添加完所有任务后，点击 **🚀 开始批量处理**
2. 系统自动逐个处理，显示实时进度
3. 处理完成后，每个任务显示提取结果

### 4. 评分与反馈

处理完成后，为每个结果打分：

- **5⭐**: 完美，信息提取准确完整
- **4⭐**: 良好，大部分信息正确
- **3⭐**: 一般，部分信息缺失或有误
- **2⭐**: 较差，多处错误
- **1⭐**: 失败，完全不可用

**低分反馈**：
- 评分 < 4 星时，会出现反馈框
- 描述具体问题（如"时间提取错误"、"地点识别失败"）
- 这些反馈用于自动优化 Prompt

---

## 🧠 自动优化机制

### 触发条件
当满足以下条件时，系统会建议优化 Prompt：
- 至少有 5 个任务完成评分
- 最近 10 个任务的平均评分 < 3.5 星

### 优化过程

1. **问题分析**
   - 自动分析低分任务的反馈
   - 识别常见问题类型：
     - 时间提取不准确
     - 地点信息缺失
     - 参与者识别有误
     - 议程提取不完整

2. **Prompt 调整**
   - 根据问题类型自动调整 Prompt
   - 添加针对性的指导说明
   - 创建新的 Prompt 版本

3. **版本管理**
   - 保存所有历史版本
   - 记录每次改进项
   - 支持回退到任意版本

### 手动优化

点击 **📝 Prompt** 按钮：
- 查看当前使用的 Prompt 模板
- 手动编辑 Prompt 内容
- 重置为默认版本

---

## 📊 查看优化历史

点击 **📊 历史** 按钮，查看：

- **版本列表**：所有 Prompt 版本的时间线
- **平均评分**：每个版本的质量指标
- **改进项**：每次优化的具体内容
- **一键切换**：快速回退到任意版本

---

## 💡 使用技巧

### 提高识别准确率

1. **文本格式**
   - 尽量使用结构化的文本
   - 包含明确的时间、地点、人物信息
   - 避免过于口语化的表述

2. **批量处理**
   - 将相似类型的任务分组处理
   - 先处理少量样本，调整 Prompt 后再批量
   - 定期检查评分趋势

3. **评分标准**
   - 保持一致的评分标准
   - 详细描述问题反馈
   - 及时评分，避免遗忘

### 优化策略

1. **迭代优化**
   - 处理 5-10 个任务后检查评分
   - 根据反馈手动微调 Prompt
   - 再处理下一批任务

2. **版本对比**
   - 定期对比不同版本的效果
   - 保留效果最好的版本
   - 记录优化经验

3. **问题定位**
   - 如果某类信息总是提取失败
   - 在 Prompt 中添加具体示例
   - 强调该信息的重要性

---

## 🎯 实际应用场景

### 场景 1: 邮件会议邀请批量处理
```
1. 从邮箱导出所有会议邀请为 TXT 文件
2. 批量上传到系统
3. 自动提取所有会议信息
4. 对低质量结果打分反馈
5. 系统自动优化 Prompt
6. 重新处理失败的任务
```

### 场景 2: 公司公告信息提取
```
1. 复制多条公司公告文本
2. 粘贴到批量输入框
3. 一键提取所有活动信息
4. 评分并标记重要事项
```

### 场景 3: 网页活动信息采集
```
1. 收集活动页面 URL 列表
2. 批量添加链接
3. 自动抓取并提取信息
4. 生成统一格式的事件列表
```

---

## 📈 效果监控

### 关键指标

- **处理成功率**：完成 / 总任务数
- **平均评分**：反映整体质量
- **优化次数**：Prompt 迭代次数
- **平均处理时间**：每个任务耗时

### 质量改进目标

- 初始平均评分：约 3.0-3.5 ⭐
- 优化 1 次后：约 3.5-4.0 ⭐
- 优化 2-3 次后：约 4.0-4.5 ⭐
- 最佳状态：约 4.5-5.0 ⭐

---

## ⚠️ 常见问题

### Q1: 为什么评分低？
**A**: 可能原因：
- 输入文本格式不清晰
- Prompt 不适合当前场景
- AI 模型理解能力限制

**解决方法**：
- 提供更详细的反馈
- 等待自动优化触发
- 或手动调整 Prompt

### Q2: 如何提高处理速度？
**A**: 
- 使用云端 API（DashScope/Hunyuan）
- 避免处理过大的文件
- 合理控制批量任务数量

### Q3: Prompt 优化没有效果？
**A**:
- 检查反馈是否具体
- 尝试手动编辑 Prompt
- 增加示例说明

### Q4: 批量处理失败了怎么办？
**A**:
- 查看错误任务的详细信息
- 检查 AI 服务配置
- 减少单次处理数量

---

## 🔧 高级功能

### 自定义 Prompt 模板

在 Prompt 编辑器中，你可以：

1. **添加特定字段**
```
请额外提取以下信息：
- 会议类型（内部/外部/培训等）
- 重要级别（高/中/低）
- 是否需要准备材料
```

2. **指定输出格式**
```json
{
  "title": "会议名称",
  "type": "会议类型",
  "priority": "重要级别",
  ...
}
```

3. **添加示例**
```
示例输入：
"明天下午2点在会议室A举行项目评审会"

示例输出：
{
  "title": "项目评审会",
  "startTime": "2024-01-15 14:00",
  ...
}
```

---

## 📝 最佳实践总结

1. ✅ **先小批量测试**，验证效果后再大规模处理
2. ✅ **及时评分反馈**，让系统快速学习优化
3. ✅ **保持文本规范**，提高识别准确率
4. ✅ **定期查看历史**，了解优化趋势
5. ✅ **手动辅助调整**，结合自动优化效果更好

---

## 🎊 开始使用

现在你已经了解了 AI Event Extraction V2 的所有功能！

前往侧边栏 → 点击 **AI V2** → 开始你的智能提取之旅！

如有问题，欢迎反馈。祝使用愉快！ 🚀
