
# Eventlog Enhanced PRDï¼ˆå¢è¡¥ï¼šDaily Narrative Ã— Granola Signals Ã— å…¨äº¤äº’ Takeaways èšåˆï¼‰

> æœ¬èŠ‚ä¸ºå¯¹æ—¢æœ‰ PRD çš„å¢è¡¥ï¼šå°† Granola é£æ ¼çš„â€œé‡ç‚¹çª—å£ï¼ˆSignalsâ†’Focus Windowsï¼‰â€ä¸ Daily/Weekly/Monthly/Yearly å™äº‹å›é¡¾èåˆï¼›æŠŠç”¨æˆ·ä¸ 4DNote çš„å…¨éƒ¨äº¤äº’äº§ç‰©ï¼ˆå¡ç‰‡ã€å¯¹è¯ã€æ€»ç»“ã€web clipï¼‰ç»“ç®—ä¸ºå¯è¿½æº¯çš„ Takeawaysï¼Œå¹¶æŒ‰å¤©/å‘¨/æœˆèšåˆå‘ˆç°ã€‚

---

## 21. èåˆç›®æ ‡ï¼šä»â€œæˆ‘åšäº†ä»€ä¹ˆâ€åˆ°â€œæˆ‘ç†è§£äº†ä»€ä¹ˆâ€

### 21.1 ç›®æ ‡ç”¨æˆ·ä¸æ ¸å¿ƒä»·å€¼
- å·¥ä½œç¹å¿™çš„ç”¨æˆ·ï¼šä¸€å¤©è¿‡å¾—å¾ˆå¿«ï¼Œæƒ³çŸ¥é“â€œä»Šå¤©åˆ°åº•åšäº†ä»€ä¹ˆâ€ï¼Œå¹¶è·å¾—å®‰å¿ƒæ„Ÿï¼ˆæ—¶é—´éª¨æ¶ï¼‰
- çŸ¥è¯†å·¥ä½œè€…/ç ”ç©¶è€…ï¼šæƒ³çŸ¥é“â€œä»Šå¤©ç†è§£äº†ä»€ä¹ˆã€æœ‰å“ªäº›ç»“è®ºå¯å¤ç”¨â€ï¼ˆè®¤çŸ¥èµ„äº§ï¼‰
- å¯¹ AI æ·±åº¦äº¤äº’ç”¨æˆ·ï¼šæƒ³æŠŠé•¿æ—¶é—´ AI cowork çš„è®¨è®ºæ²‰æ·€ä¸ºè‹¥å¹²æ¡æ¸…æ™° takeawaysï¼ˆç»“ç®—æœºåˆ¶ï¼‰

**æ ¸å¿ƒä»·å€¼ä¸»å¼ **
- Daily Narrative æä¾›æ—¶é—´è½´å™äº‹ï¼ˆTimelineï¼‰
- Signals/è¡Œä¸ºæƒé‡è®©æ€»ç»“â€œé‡ç‚¹åˆ†æ˜ã€æ‡‚æˆ‘â€ï¼ˆFocusï¼‰
- æ‰€æœ‰äº¤äº’äº§ç‰©è¢«ç»“ç®—ä¸º takeawaysï¼ˆAssetizationï¼‰
- å‘¨/æœˆæ€»ç»“åœ¨â€œæ¯æ—¥ç»“ç®—â€çš„åŸºç¡€ä¸Šå¤åˆ©å¢é•¿ï¼ˆCompoundingï¼‰

---

## 22. ç»Ÿä¸€è¯æ®æ¨¡å‹ï¼ˆEvidenceï¼‰ï¼šDaily Narrative çš„è¾“å…¥

Daily/Weekly ç­‰å›é¡¾ä¸å†ç›´æ¥è¯»â€œæ•´ç¯‡ç¬”è®°â€ï¼Œè€Œæ˜¯è¯»ä¸‰ç±»è¯æ®ï¼Œæå‡å¯è§£é‡Šæ€§ä¸å‹ç¼©æ•ˆç‡ã€‚

### 22.1 Evidence Types
1) **Timeline Evidenceï¼ˆæ—¶é—´éª¨æ¶ï¼‰**
- æ—¥ç¨‹å—ï¼ˆå¯é€‰é›†æˆ Calendarï¼‰
- Session æ—¶é—´è½´ï¼ˆå½•éŸ³/ä¼šè®®/å­¦ä¹ æ®µï¼‰
- å…³é”®æ—¶é—´ç‚¹ï¼ˆSignal timestampsï¼‰

2) **Interaction Evidenceï¼ˆäº¤äº’è¯æ®ï¼‰**
- Ask AIï¼ˆæé—®/è¿½é—®ï¼‰
- Card togglesï¼ˆå±•å¼€/æŠ˜å ï¼‰
- Multi-select summarizeï¼ˆå¤šå¡æ€»ç»“ï¼‰
- Web clip / å¼•ç”¨æ’å…¥
- Tag change / Open loop mark / Action item mark

3) **Outcome Evidenceï¼ˆäº§ç‰©è¯æ®ï¼‰**
- AI Answer cardsï¼ˆå«ç»“æ„åŒ–æ‘˜è¦ï¼‰
- Summary cardsï¼ˆé›†æˆå¼æ€»ç»“å¡ï¼‰
- Resonance cards
- Web clipsï¼ˆå«æ¥æºï¼‰
- ç”¨æˆ·æ‰‹å†™ç»“è®ºæ®µè½ï¼ˆBody/Thoughtï¼‰

### 22.2 è¯æ®ä¸å¯è¿½æº¯æ€§è¦æ±‚
- æ¯æ¡ Evidence å¿…é¡»å¯å›é“¾åˆ°ï¼š
  - `note_id`, `node_id` æˆ– `card_id`
  - `event_id`ï¼ˆEventLogï¼‰
  - `session_id`ï¼ˆå¦‚é€‚ç”¨ï¼‰
- å›é¡¾è¾“å‡ºéœ€ä¿ç•™å†…éƒ¨ `evidence_refs`ï¼ˆMVP å¯ä¸å±•ç¤ºç»™ç”¨æˆ·ï¼Œä½†å¿…é¡»å­˜å‚¨ï¼‰

---

## 23. æ–°å¢ï¼šTakeaway Captureï¼ˆäº¤äº’ç»“ç®—å±‚ï¼‰

### 23.1 ä¸ºä»€ä¹ˆéœ€è¦ Takeaway Capture
è‹¥ä»…åœ¨æ¯å¤©ç»“æŸæ—¶å¯¹å…¨æ–‡æ€»ç»“ï¼š
- token æˆæœ¬é«˜
- ç»“æ„ä¸ç¨³å®š
- é‡ç‚¹ä¸æ˜ï¼ˆå°¤å…¶æ˜¯é•¿å¯¹è¯ï¼‰

å› æ­¤æ–°å¢â€œç»“ç®—å±‚â€ï¼šå°†æ¯æ¬¡é‡è¦äº¤äº’äº§å‡º**micro-takeaways**ï¼Œæ—¥ç»ˆå†èšåˆä¸º**daily takeaways**ã€‚

### 23.2 æ–°å¯¹è±¡ï¼šTakeawayCandidateï¼ˆå€™é€‰æ”¶è·ï¼‰
> å¯å•ç‹¬è¡¨ï¼Œä¹Ÿå¯ä½œä¸º `cards.meta.takeaway` å­˜å‚¨ï¼ˆå»ºè®®å•ç‹¬è¡¨ä¾¿äºèšåˆï¼‰ã€‚

**TakeawayCandidate schemaï¼ˆå»ºè®®ï¼‰**
- `takeaway_id` (uuid)
- `user_id`
- `date` (YYYY-MM-DD, user timezone)
- `source_type`ï¼š`card` | `session` | `web_clip` | `manual`
- `source_id`ï¼šcard_id/session_id/â€¦
- `created_at`
- `text`ï¼šä¸€å¥è¯ç»“è®ºï¼ˆ<= 200 charsï¼‰
- `topic`ï¼šå¯é€‰ï¼ˆä¸»é¢˜å­—ç¬¦ä¸²æˆ– topic_idï¼‰
- `embedding`ï¼šå¯é€‰ï¼ˆç”¨äºèšç±»ï¼‰
- `weight`ï¼šæ•°å€¼æƒé‡ï¼ˆè§ 24ï¼‰
- `evidence_refs`ï¼š`[{type, id}]`ï¼ˆnode/card/eventï¼‰
- `status`ï¼š`active` | `archived` | `rejected`ï¼ˆç”¨æˆ·å¯åˆ ï¼‰

### 23.3 è§¦å‘æ—¶æœºï¼ˆä½æ‘©æ“¦ã€è‡ªåŠ¨åŒ–ä¼˜å…ˆï¼‰
ç³»ç»Ÿåœ¨ä»¥ä¸‹äº‹ä»¶ç»“æŸæ—¶è‡ªåŠ¨ç”Ÿæˆ TakeawayCandidateï¼š

1) `AI_ANSWERED` â†’ ç”Ÿæˆ 1 æ¡
- ç”±æ¨¡å‹è¿”å› `answer + takeaway_sentence + key_points[]`
- takeaway ä½œä¸ºçŸ­å¥å†™å…¥ candidates

2) `SUMMARY_GENERATED`ï¼ˆå¤šå¡é›†æˆæ€»ç»“å¡ï¼‰â†’ ç”Ÿæˆ 3â€“5 æ¡
- ä» summary çš„ key points æ‹†åˆ†ä¸ºå¤šæ¡ candidates
- `evidence_refs` = è¾“å…¥ card_ids

3) `SESSION_ENDED`ï¼ˆGranola é£æ ¼ï¼‰â†’ ç”Ÿæˆè‹¥å¹²æ¡
- focus windows â†’ Key Moments â†’ æ¯ä¸ª moment 1 æ¡ candidateï¼ˆé«˜æƒé‡ï¼‰
- non-focus â†’ Supporting Notes â†’ å¯ç”Ÿæˆ 0â€“2 æ¡ä½æƒé‡å€™é€‰ï¼ˆå¯é€‰ï¼‰

4) ç”¨æˆ·æ‰‹åŠ¨æ ‡è®°ï¼ˆå¯é€‰ï¼‰
- åœ¨æ®µè½/å¡ç‰‡ä¸Šç‚¹ â­ â€œAdd to daily takeawaysâ€
- ç”Ÿæˆ `source_type=manual` candidateï¼ˆæƒé‡æœ€é«˜ï¼‰

---

## 24. é‡ç‚¹åˆ†æ˜çš„å®ç°ï¼šWeight Modelï¼ˆSignals + è¡Œä¸ºï¼‰

### 24.1 æƒé‡æ¥æºï¼ˆä¸ä¾èµ–è¯­ä¹‰ä¹Ÿèƒ½æœ‰æ•ˆï¼‰
`weight = manual_signal + system_signal + behavior_signal + recency_signal`

- **manual_signalï¼ˆå¼ºï¼‰**
  - `HIGHLIGHT`ï¼š+W1
  - `ACTION_ITEM`ï¼š+W2
  - `QUESTION`ï¼š+W3
- **system_signalï¼ˆä¸­ï¼‰**
  - æ¥è‡ª focus window çš„ Key Momentï¼š+W4
  - æ¥è‡ª multi-card summaryï¼š+W5
- **behavior_signalï¼ˆä¸­ï¼‰**
  - card å±•å¼€æ¬¡æ•°ã€åœç•™æ—¶é•¿ã€äºŒæ¬¡è¿½é—®æ¬¡æ•°ã€è¢«å¼•ç”¨æ¬¡æ•°ï¼š+W6â€¦
- **recency_signalï¼ˆå¼±ï¼‰**
  - ä¸´è¿‘æ—¥ç»ˆ/è¿ç»­å‡ºç°ä¸»é¢˜ï¼š+W7ï¼ˆå¯é€‰ï¼‰

> MVP å»ºè®®ä»…å¯ç”¨ manual_signal + system_signal + minimal behavior_signalï¼ˆå±•å¼€æ¬¡æ•°ï¼‰ï¼Œé¿å…éšç§äº‰è®®ä¸å®ç°æˆæœ¬ã€‚

### 24.2 Granola Signals èå…¥
- Signals äº§ç”Ÿ focus windows
- focus windows å†…çš„ transcript segments / key moments è‡ªåŠ¨è·å¾—é«˜æƒé‡
- ç”¨æˆ·æœªè®°å½•/æœªæ ‡è®°æ—¶æ®µ â†’ é»˜è®¤ä½æƒé‡ï¼Œä»…ç®€è¦æ¦‚æ‹¬

---

## 25. Daily Narrativeï¼ˆèåˆç‰ˆï¼‰è¾“å‡ºè§„èŒƒ

### 25.1 Daily Review æ¨¡æ¿ï¼ˆæ›´æ–°ï¼‰
1) **Narrative Summaryï¼ˆæ—¶é—´éª¨æ¶ï¼‰**
- ä»¥ Timeline Evidence åˆ†é•œï¼ˆå¦‚ï¼šä¸Šåˆ/ä¸‹åˆ/æ™šé—´ æˆ–ä¼šè®®å—ï¼‰
- æ¯æ®µ 1â€“3 å¥ï¼Œé¿å…æµæ°´è´¦

2) **Top Takeawaysï¼ˆç»“ç®—åæ”¶è·ï¼Œ3â€“7 æ¡ï¼‰**
- æ¥è‡ª TakeawayCandidates èšç±»ä¸æ’åº
- æ¯æ¡å¯ç‚¹å¼€æŸ¥çœ‹æ¥æºï¼ˆcard/session/clipï¼‰

3) **Open Loopsï¼ˆâ“ï¼‰**
- æ¥è‡ª QUESTION signals + AI æŠ½å–
- æ¯æ¡å¿…é¡»å¯è¿½æº¯åˆ° evidence_refs

4) **Action Itemsï¼ˆâœ…ï¼‰**
- æ¥è‡ª ACTION_ITEM signals + summary æŠ½å–
- å¯ä¸€é”®è½¬ä¸ºä»»åŠ¡ï¼ˆåç»­ï¼‰

5) **Resonanceï¼ˆå¯é€‰ï¼‰**
- Resonance query ä¼˜å…ˆä½¿ç”¨ï¼š
  - Top Takeaways ä¸­æƒé‡æœ€é«˜çš„ä¸»é¢˜
  - æˆ–æœ€å¼º open loop çš„å›°å¢ƒæè¿°
- è¾“å‡ºçŸ­ã€å…·ä½“ã€æœ‰æ¥æº

### 25.2 å…³é”®çº¦æŸ
- **Top Takeaways å¿…é¡»æœ‰ä¸Šé™**ï¼ˆé»˜è®¤ 7ï¼‰
- æ¯æ¡ takeaway å¿…é¡»å¸¦ `source_id`ï¼ˆè‡³å°‘ä¸€ä¸ªï¼‰
- focus windows çš„å†…å®¹é»˜è®¤æ›´ç»†ï¼›éé‡ç‚¹åªåšèƒŒæ™¯è¡¥å……

---

## 26. Weekly/Monthly/Yearlyï¼šåŸºäºâ€œæ¯æ—¥ç»“ç®—â€çš„å¤åˆ©èšåˆ

### 26.1 èšåˆè¾“å…¥
- æ¯æ—¥çš„ `Top Takeaways`ï¼ˆæˆ–å…¨é‡ candidatesï¼‰
- æ¯æ—¥ `Open Loops / Action Items`
- æ¯æ—¥ `Resonance themes`ï¼ˆå¯é€‰ï¼‰

### 26.2 è¾“å‡ºç»“æ„ï¼ˆå»ºè®®ï¼‰
- **Themesï¼ˆä¸»é¢˜ï¼‰**ï¼štop topicsï¼ˆæŒ‰èšç±»é¢‘æ¬¡+æƒé‡ï¼‰
- **Progressï¼ˆè¿›å±•ï¼‰**ï¼šä¸»é¢˜ä» questionâ†’conclusionâ†’action çš„æ¼”åŒ–
- **Repeated Blockersï¼ˆé‡å¤é˜»å¡ï¼‰**ï¼šé«˜é¢‘ open loops
- **Decisionsï¼ˆå†³ç­–ï¼‰**ï¼šä» CONFIRM/å†³ç­–å‹æ—¶åˆ»æŠ½å–
- **Next Week Focusï¼ˆå»ºè®®ï¼‰**ï¼š1â€“3 æ¡

---

## 27. ç›®å½•ä¸å‘ˆç°ï¼šæŠŠ Takeaways â€œå¯å¯¼èˆªåŒ–â€

### 27.1 å…¨æ¯åœ°å›¾æ–°å¢æ ‡è®°ï¼ˆå¯é€‰ï¼‰
- â­ é‡ç‚¹æ—¶åˆ»ï¼ˆHIGHLIGHT/Key Momentï¼‰
- ğŸ§  Takeaway äº§å‡ºç‚¹ï¼ˆç”Ÿæˆ candidate çš„ anchorï¼‰
- ğŸ§Š Summary ç”Ÿæˆç‚¹
- â“ Open Loop

### 27.2 â€œTakeaways by Dayâ€ è§†å›¾ï¼ˆå»ºè®®æ–°å…¥å£ï¼‰
- ç±»ä¼¼æ—¥å†/åˆ—è¡¨ï¼šæ¯ä¸€å¤©æ˜¾ç¤º 3 æ¡ takeaway é¢„è§ˆ
- ç‚¹å‡»è¿›å…¥è¯¥æ—¥ Daily Reviewï¼ˆå¯å±•å¼€æ¥æºå¡ç‰‡ï¼‰
- è¿™æ˜¯ç”¨æˆ·â€œå…´å¥‹æ„Ÿâ€çš„ä¸»è¦è§¦å‘å™¨ï¼ˆæˆ‘æ¯å¤©éƒ½åœ¨å˜å¼ºï¼‰

---

## 28. æŠ€æœ¯å®ç°ï¼ˆCopilot æ‰§è¡Œè¦ç‚¹ï¼‰

### 28.1 æ–°å¢/æ›´æ–°äº‹ä»¶ï¼ˆEventLogï¼‰
- `TAKEAWAY_CANDIDATE_CREATED`
- `TAKEAWAY_CANDIDATE_UPDATED`ï¼ˆé‡ç®—æƒé‡/èšç±»ï¼‰
- `DAILY_REVIEW_GENERATED`ï¼ˆé™„ evidence_refsï¼‰
- `TAKEAWAY_PINNED`ï¼ˆç”¨æˆ·æ‰‹åŠ¨â­ï¼‰

### 28.2 ç”Ÿæˆç®¡çº¿ï¼ˆpipelineï¼‰æ›´æ–°

**Pipeline Aï¼šäº¤äº’åå³æ—¶ç»“ç®—ï¼ˆè½»é‡ï¼‰**
- On `AI_ANSWERED`ï¼š
  - LLM è¾“å‡ºç»“æ„åŒ–ï¼š
    - `answer_markdown`
    - `takeaway_sentence`
    - `key_points[]`
    - `open_loops[]`ï¼ˆå¯é€‰ï¼‰
  - å†™å…¥ card + ç”Ÿæˆ TakeawayCandidateï¼ˆ1 æ¡ï¼‰

- On `SUMMARY_GENERATED`ï¼š
  - ä» summary äº§ç”Ÿå¤šæ¡ candidatesï¼ˆ3â€“5ï¼‰
  - `evidence_refs = input_card_ids`

**Pipeline Bï¼šæ—¥ç»ˆèšåˆï¼ˆé‡ï¼‰**
1) Loadï¼šå½“å¤© candidates + timeline + signals + open loops
2) Clusterï¼šæŒ‰ embedding æˆ–ä¸»é¢˜è§„åˆ™èšç±»
3) Rankï¼šæŒ‰ weight æ’åºï¼Œæ¯ç°‡å– top-1 æˆ– top-2
4) Composeï¼šç”Ÿæˆ Narrative + Top Takeaways + Open Loops + Actions + Resonance
5) Persistï¼šå†™å…¥ daily_review è®°å½• + summary cardï¼ˆæŒ‚è½½ï¼‰

### 28.3 èšç±»ç­–ç•¥ï¼ˆMVP ä¸å¢å¼ºï¼‰
- MVPï¼šè§„åˆ™èšç±»ï¼ˆtopic å­—æ®µ + å…³é”®è¯ï¼‰æˆ–ä»…æŒ‰æ¥æºåˆ†ç»„ï¼ˆsession vs cardsï¼‰
- å¢å¼ºï¼šembedding èšç±»ï¼ˆHDBSCAN/k-meansï¼‰+ rerank

### 28.4 æˆæœ¬ä¸éšç§
- ä¸å¿…é‡‡é›†â€œåœç•™æ—¶é•¿â€å³å¯åšå‡ºé‡ç‚¹åˆ†æ˜ä½“éªŒï¼š  
  å…ˆä¾èµ– signals + ç”Ÿæˆäº‹ä»¶ï¼ˆsummary/askï¼‰å³å¯ã€‚
- è‹¥å¯ç”¨è¡Œä¸ºä¿¡å·ï¼ˆå±•å¼€æ¬¡æ•°/åœç•™æ—¶é•¿ï¼‰ï¼š
  - åœ¨è®¾ç½®ä¸­æ˜ç¡®è¯´æ˜
  - æ”¯æŒå…³é—­
  - æœ¬åœ°èšåˆåä»…ä¸Šä¼ ç»Ÿè®¡å€¼ï¼ˆå¯é€‰ï¼‰

---

## 29. éªŒæ”¶æ ‡å‡†ï¼ˆè¡¥å……ï¼‰

- ç”¨æˆ·å½“å¤©ä¸ AI è¿ç»­å¯¹è¯ â‰¥ 20 åˆ†é’Ÿå¹¶ç”Ÿæˆå¤šå¼ å¡ç‰‡ï¼š
  - Daily Review çš„ Top Takeaways ä¸­èƒ½å‡ºç°â€œå¸‚åœºä¿¡æ¯ç»“è®ºâ€ç±»æ¡ç›®
  - ä¸”æ¯æ¡å¯è¿½æº¯åˆ°å…·ä½“ card_idsï¼ˆç‚¹å‡»å¯å±•å¼€åŸå¡ç‰‡ï¼‰
- è‹¥ç”¨æˆ·åœ¨ Session ä¸­å¤šæ¬¡ â­HIGHLIGHTï¼š
  - Daily Narrative ä¸­å¯¹åº”æ—¶é—´æ®µæ›´ç»†ã€éé‡ç‚¹æ›´ç®€
- å…³é—­ Resonanceï¼š
  - Daily Review ä»å®Œæ•´å¯ç”¨
- Top Takeaways æ•°é‡å—æ§ï¼ˆ<=7ï¼‰ï¼Œä¿¡æ¯å¯†åº¦é«˜äºæ­£æ–‡æµæ°´å›é¡¾

